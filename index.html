<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clack</title>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4653147807800151" crossorigin="anonymous"></script>
  <!-- Fuentes e 铆conos -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <style>
    /* ================================
       Estilos Generales de Clack (Facebook)
       ================================ */
    :root {
      --primary-color: #1877f2;
      --bg-color: #f0f2f5;
      --text-color: #050505;
      --editor-bg: #ffffff;
    }
    .dark-mode {
      --primary-color: #2374e1;
      --bg-color: #18191a;
      --text-color: #e4e6eb;
      --editor-bg: #242526;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--primary-color);
      color: var(--text-color);
      min-height: 100vh;
      overflow-x: hidden;
      max-width: 100%;
    }
    /* Responsividad */
    @media (max-width: 768px) {
      .editor-container {
        grid-template-columns: 1fr;
        padding: 0 10px;
        height: auto;
        min-height: calc(100vh - 120px);
        gap: 15px;
      }
      
      #inicio .editor-container {
        grid-template-columns: 1fr;
        height: auto;
        min-height: calc(100vh - 80px);
        padding: 10px;
        gap: 15px;
      }
      
      /* Header responsivo */
      header {
        padding: 5px 10px;
        flex-wrap: wrap;
      }
      
      header h1 {
        font-size: 1.2rem;
      }
      
      .controls {
        gap: 5px;
      }
      
      .controls button {
        padding: 6px 12px;
        font-size: 12px;
      }
      
      /* Navegaci贸n responsiva */
      nav {
        padding: 8px 10px;
        gap: 10px;
        flex-wrap: wrap;
      }
      
      nav a {
        padding: 6px 12px;
        font-size: 14px;
      }
      
      /* Proyectos responsivos */
      .projects-container {
        flex-direction: column;
        gap: 15px;
      }
      
      .project-list {
        width: 100%;
        order: 2;
      }
      
      .project-editor {
        order: 1;
      }
      
      .project-header {
        flex-direction: column;
        gap: 10px;
        align-items: stretch;
      }
      
      .project-header input#projectName {
        margin-right: 0;
        margin-bottom: 10px;
      }
      
      .project-header .project-actions {
        flex-wrap: wrap;
        gap: 5px;
      }
      
      .project-header .project-actions button {
        flex: 1;
        min-width: 0;
        font-size: 12px;
        padding: 8px 10px;
      }
      
      /* Editor tools responsivo */
      .editor-tools {
        flex-direction: column;
        gap: 10px;
        margin: 10px 10px;
      }
      
      .tool-group {
        justify-content: center;
      }
      
      .editor-tools button {
        padding: 10px 15px;
        font-size: 14px;
      }
      
      /* Preview tools responsivo */
      .preview-tools {
        flex-direction: column;
        gap: 8px;
        margin: 10px 10px;
      }
      
      .preview-tools button {
        width: 100%;
        justify-content: center;
      }
      
      /* Editor areas en m贸vil */
      .editor-area {
        min-height: 250px;
      }
      
      textarea {
        font-size: 16px; /* Previene zoom en iOS */
      }
      
      /* L铆neas de n煤meros en m贸vil */
      .line-numbers {
        width: 35px;
        font-size: 12px;
      }
      
      textarea {
        padding-left: 43px;
      }
      
      .syntax-highlight {
        left: 43px;
        font-size: 12px;
      }
    }
    
    @media (max-width: 480px) {
      .editor-container {
        padding: 0 5px;
        gap: 10px;
      }
      
      .project-header .project-actions button {
        font-size: 10px;
        padding: 6px 8px;
      }
      
      .controls button span {
        display: none;
      }
      
      .controls button {
        width: 40px;
        height: 40px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      /* Inicio en m贸viles muy peque帽os */
      #inicio .editor-container {
        padding: 5px !important;
        gap: 10px !important;
      }
      
      #inicio .editor-area {
        min-height: 200px !important;
      }
      
      /* Modal de reporte en pantallas peque帽as */
      #reportArticleModal {
        padding: 5px !important;
      }
      
      #reportArticleModal .modal-content {
        padding: 12px !important;
        border-radius: 8px !important;
      }
      
      /* Header responsive */
      header {
        padding: 5px 10px !important;
      }
      
      header h1 {
        font-size: 1.2rem !important;
      }
      
      /* Navegaci贸n responsive */
      nav {
        padding: 8px 10px !important;
        gap: 10px !important;
      }
      
      nav a {
        padding: 6px 10px !important;
        font-size: 13px !important;
      }
      
      /* Proyectos en m贸viles peque帽os */
      .project-list {
        max-height: 250px !important;
      }
      
      .project-editor {
        min-height: 350px !important;
      }
      
      .project-header {
        flex-direction: column !important;
        gap: 10px !important;
        padding: 10px 15px !important;
      }
      
      .project-header input {
        margin-right: 0 !important;
        margin-bottom: 10px !important;
        font-size: 14px !important;
      }
      
      .project-header .project-actions {
        flex-wrap: wrap !important;
        gap: 5px !important;
        justify-content: center !important;
      }
      
      .project-header .project-actions button {
        flex: 1 1 calc(50% - 5px) !important;
        min-width: 0 !important;
        font-size: 11px !important;
        padding: 8px 5px !important;
      }
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(24, 119, 242, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(24, 119, 242, 0); }
      100% { box-shadow: 0 0 0 0 rgba(24, 119, 242, 0); }
    }

    /* Intro y animaciones */
    .intro {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: var(--primary-color);
      display: flex; justify-content: center; align-items: center;
      z-index: 9999; perspective: 1000px;
    }
    .logo {
      font-size: 5rem; color: #fff; text-transform: uppercase; font-weight: bold;
      opacity: 0; animation: logoReveal 2.5s forwards; transform-style: preserve-3d;
    }
    .code-effect {
      position: absolute; width: 100%; height: 100%;
      font-family: monospace; font-size: 1.2rem; color: rgba(255,255,255,0.2);
      overflow: hidden;
    }
    @keyframes logoReveal {
      0% { transform: rotateX(90deg) translateZ(100px); opacity: 0; }
      30% { transform: rotateX(0deg) translateZ(100px); opacity: 0.6; }
      60% { transform: translateZ(100px) scale(1.2); opacity: 0.8; }
      100% { transform: translateZ(0) scale(1); opacity: 1; }
    }
    @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }
    /* Header y controles */
    header {
      background: var(--primary-color);
      padding: 5px 20px;
      display: flex; justify-content: space-between; align-items: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1); position: sticky; top: 0;
      z-index: 100;
    }
    header h1 {
      margin: 0;
      line-height: 1;
      font-size: 1.5rem;
      display: flex; align-items: center;
      gap: 5px;
    }
    .controls { display: flex; gap: 10px; align-items: center; }
    .controls button {
      display: flex; align-items: center; gap: 6px;
      background: var(--primary-color); color: #fff;
      border: none; padding: 8px 20px;
      border-radius: 6px; cursor: pointer; font-weight: 600;
      transition: all 0.2s;
    }
    .controls button:hover { background: #166fe5; }
    #settingsBtn, #notificationBtn, #searchBtn {
      background: transparent; border: none; color: #fff;
      font-size: 1.5rem; cursor: pointer; padding: 0;
    }
    /* Modal de Login */
    .modal {
      display: none; position: fixed; z-index: 10000; top: 0; left: 0;
      width: 100%; height: 100%; background: var(--primary-color); color: #fff;
    }
    .modal-content {
      width: 100%; height: 100%; display: flex; flex-direction: column;
      justify-content: center; align-items: center; text-align: center; padding: 20px;
    }
    .modal-content h2 { margin-bottom: 10px; font-size: 2rem; }
    .modal-content p { margin-bottom: 20px; font-size: 1.2rem; }
    #githubLoginBtn, #changeLangBtn {
      padding: 15px 25px; font-size: 16px; border: none; border-radius: 8px;
      background: #24292e; color: #fff; cursor: pointer;
      margin-top: 15px; font-weight: 600;
      display: flex; align-items: center; gap: 10px;
      transition: all 0.3s ease; min-width: 280px;
      justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    #githubLoginBtn:hover { 
      background: #1a1e22; transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }
    #githubLoginBtn i {
      font-size: 18px; transition: transform 0.3s ease;
    }
    #githubLoginBtn:hover i {
      transform: scale(1.1);
    }
    #changeLangBtn {
      background: #fff; color: var(--primary-color);
      margin-top: 10px; min-width: auto;
    }
    #changeLangBtn:hover { background: #f0f0f0; }
    /* Spinner */
    .spinner {
      border: 8px solid #f3f3f3; border-top: 8px solid #fff;
      border-radius: 50%; width: 60px; height: 60px;
      animation: spin 1s linear infinite; margin-bottom: 20px;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    /* Overlay transici贸n idioma */
    #langTransitionOverlay {
      display: none; position: fixed; z-index: 10500; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.6); overflow: hidden;
    }
    .lang-ball {
      position: absolute; background: #fff; width: 40px; height: 40px;
      border-radius: 50%; opacity: 0.9;
    }
    .ball-left { top: 50%; left: -50px; }
    .ball-right { top: 50%; right: -50px; }
    @keyframes ballLeftAnim {
      0% { transform: rotate(0deg); left: -50px; }
      50% { transform: rotate(360deg); left: 50%; }
      100% { transform: rotate(720deg); left: 120%; }
    }
    @keyframes ballRightAnim {
      0% { transform: rotate(0deg); right: -50px; }
      50% { transform: rotate(360deg); right: 50%; }
      100% { transform: rotate(720deg); right: 120%; }
    }
    .animate-left { animation: ballLeftAnim 2s ease-in-out forwards; }
    .animate-right { animation: ballRightAnim 2s ease-in-out forwards; }
    /* Overlay Scan (Vista Previa) */
    #scanOverlay {
      display: none; position: fixed; z-index: 10500; top: 0; left: 0;
      width: 100%; height: 100%;
      background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(0,0,0,0.8) 80%);
      opacity: 0; animation: scanEffect 5s forwards;
    }
    @keyframes scanEffect {
      0% { opacity: 0; } 20% { opacity: 1; } 80% { opacity: 1; } 100% { opacity: 0; }
    }
    /* Overlay Ajustes estilo Twitter */
    #settingsOverlay {
      display: none; position: fixed; z-index: 11000; top: 0; left: 0;
      width: 100%; height: 100%; background: #000000; color: #ffffff;
      animation: slideUp 0.3s ease;
    }
    
    #settingsOverlay.show {
      display: block;
    }
    
    .settings-header {
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      padding: 15px 20px;
      border-bottom: 1px solid #2f3336;
      display: flex;
      align-items: center;
      gap: 15px;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .settings-header .back-btn {
      background: none;
      border: none;
      font-size: 20px;
      color: #ffffff;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: all 0.2s ease;
    }
    
    .settings-header .back-btn:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .settings-header h2 {
      font-size: 20px;
      font-weight: 700;
      margin: 0;
      flex: 1;
      color: #ffffff;
    }
    
    .settings-search {
      padding: 15px 20px;
      background: #000000;
      border-bottom: 1px solid #2f3336;
    }
    
    .settings-search input {
      width: 100%;
      padding: 12px 20px;
      background: #16181c;
      border: 2px solid #2f3336;
      border-radius: 25px;
      font-size: 15px;
      color: #ffffff;
      transition: all 0.3s ease;
    }
    
    .settings-search input:focus {
      outline: none;
      border-color: #1d9bf0;
      background: #000000;
    }
    
    .settings-search input::placeholder {
      color: #71767b;
    }
    
    .settings-content {
      flex: 1;
      overflow-y: auto;
      background: #000000;
    }
    
    .settings-item {
      display: flex;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid #2f3336;
      cursor: pointer;
      transition: background 0.2s ease;
      text-decoration: none;
      color: #ffffff;
      background: #000000;
    }
    
    .settings-item:hover {
      background: #1e2328;
    }
    
    .settings-item-icon {
      width: 24px;
      height: 24px;
      margin-right: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: #71767b;
    }
    
    .settings-item-content {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .settings-item-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 2px;
      color: #ffffff;
    }
    
    .settings-item-subtitle {
      font-size: 14px;
      color: #71767b;
    }
    
    .settings-item-arrow {
      font-size: 14px;
      color: #71767b;
    }
    
    .settings-section-title {
      padding: 20px 20px 10px 20px;
      font-size: 13px;
      font-weight: 700;
      color: #71767b;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    /* Submenu de idiomas */
    .language-submenu {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000000;
      z-index: 11001;
      animation: slideUp 0.3s ease;
    }
    
    .language-submenu.show {
      display: block;
    }
    
    .language-option {
      display: flex;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid #2f3336;
      cursor: pointer;
      transition: background 0.2s ease;
      background: #000000;
    }
    
    .language-option:hover {
      background: #1e2328;
    }
    
    .language-option.selected {
      background: rgba(29, 155, 240, 0.1);
    }
    
    .language-option .flag {
      font-size: 20px;
      margin-right: 15px;
      width: 24px;
      text-align: center;
    }
    
    .language-option .name {
      flex: 1;
      font-size: 16px;
      color: #ffffff;
      font-weight: 600;
    }
    
    .language-option .check {
      color: #1d9bf0;
      font-size: 16px;
    }
    
    /* Bot de Ayuda */
    #helpBotOverlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--editor-bg);
      z-index: 11002;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease;
    }
    
    #helpBotOverlay.show {
      display: flex;
      transform: translateX(0);
    }
    
    .chat-header {
      background: var(--primary-color);
      color: white;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .chat-header .back-btn {
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      padding: 5px;
    }
    
    .chat-header .bot-info {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .chat-header .bot-avatar {
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-color);
      font-size: 20px;
      animation: pulse 2s infinite;
    }
    
    .chat-header .bot-details h3 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
    }
    
    .chat-header .bot-details p {
      margin: 0;
      font-size: 12px;
      opacity: 0.9;
    }
    
    .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .chat-messages {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: #f8f9fa;
    }
    
    .message {
      margin-bottom: 15px;
      display: flex;
      animation: messageSlideIn 0.3s ease;
    }
    
    .message.user {
      justify-content: flex-end;
    }
    
    .message.bot {
      justify-content: flex-start;
    }
    
    .message-content {
      max-width: 70%;
      padding: 12px 16px;
      border-radius: 18px;
      position: relative;
      word-wrap: break-word;
    }
    
    .message.user .message-content {
      background: var(--primary-color);
      color: white;
      border-bottom-right-radius: 5px;
    }
    
    .message.bot .message-content {
      background: white;
      color: var(--text-color);
      border: 1px solid #e0e0e0;
      border-bottom-left-radius: 5px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .message-time {
      font-size: 11px;
      opacity: 0.7;
      margin-top: 5px;
      text-align: right;
    }
    
    .message.bot .message-time {
      text-align: left;
    }
    
    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      background: white;
      border-radius: 18px;
      border-bottom-left-radius: 5px;
      border: 1px solid #e0e0e0;
      max-width: 70%;
      margin-bottom: 15px;
    }
    
    .typing-dots {
      display: flex;
      gap: 3px;
    }
    
    .typing-dot {
      width: 8px;
      height: 8px;
      background: #999;
      border-radius: 50%;
      animation: typingDot 1.4s infinite;
    }
    
    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    .chat-input-container {
      padding: 15px 20px;
      background: white;
      border-top: 1px solid #e0e0e0;
      display: flex;
      gap: 10px;
      align-items: flex-end;
    }
    
    .chat-input {
      flex: 1;
      border: 1px solid #e0e0e0;
      border-radius: 20px;
      padding: 12px 16px;
      font-size: 14px;
      resize: none;
      min-height: 20px;
      max-height: 100px;
      background: #f8f9fa;
    }
    
    .chat-input:focus {
      outline: none;
      border-color: var(--primary-color);
      background: white;
    }
    
    .send-button {
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .send-button:hover {
      background: #166fe5;
      transform: scale(1.05);
    }
    
    .send-button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }
    
    .quick-questions {
      padding: 10px 20px;
      background: white;
      border-top: 1px solid #e0e0e0;
    }
    
    .quick-questions-title {
      font-size: 12px;
      color: #666;
      margin-bottom: 8px;
      font-weight: 600;
    }
    
    .quick-questions-list {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .quick-question {
      background: #f0f2f5;
      border: 1px solid #e0e0e0;
      border-radius: 15px;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-color);
    }
    
    .quick-question:hover {
      background: var(--primary-color);
      color: white;
      transform: translateY(-1px);
    }
    
    @keyframes messageSlideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes typingDot {
      0%, 60%, 100% {
        transform: translateY(0);
        opacity: 0.5;
      }
      30% {
        transform: translateY(-10px);
        opacity: 1;
      }
    }
    
    /* Selector de idiomas del chat */
    .chat-language-selector {
      position: relative;
    }
    
    .language-selector-btn {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 12px;
      transition: all 0.3s ease;
    }
    
    .language-selector-btn:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .chat-language-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
      display: none;
      min-width: 150px;
      z-index: 1000;
      overflow: hidden;
      animation: slideDownChat 0.3s ease;
    }
    
    .chat-language-dropdown.show {
      display: block;
    }
    
    .chat-lang-option {
      padding: 12px 15px;
      cursor: pointer;
      transition: background 0.2s ease;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
    }
    
    .chat-lang-option:hover {
      background: #f0f2f5;
    }
    
    .chat-lang-option.selected {
      background: var(--primary-color);
      color: white;
    }
    
    .chat-lang-option::before {
      content: attr(data-flag);
      font-size: 16px;
    }
    
    @keyframes slideDownChat {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Animaci贸n skeleton para traducci贸n */
    .message-skeleton {
      background: #f0f0f0;
      border-radius: 18px;
      padding: 12px 16px;
      margin-bottom: 15px;
      max-width: 70%;
      position: relative;
      overflow: hidden;
    }
    
    .message-skeleton::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      animation: skeletonShimmer 1.5s infinite;
    }
    
    .skeleton-line {
      height: 12px;
      background: #e0e0e0;
      border-radius: 6px;
      margin-bottom: 8px;
    }
    
    .skeleton-line:last-child {
      margin-bottom: 0;
      width: 60%;
    }
    
    .translating-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #666;
      font-size: 12px;
      margin-top: 5px;
    }
    
    .translating-dots {
      display: flex;
      gap: 2px;
    }
    
    .translating-dot {
      width: 4px;
      height: 4px;
      background: var(--primary-color);
      border-radius: 50%;
      animation: translatingPulse 1.4s infinite;
    }
    
    .translating-dot:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .translating-dot:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    /* Skeleton para p谩gina completa */
    #pageSkeletonOverlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-color);
      z-index: 11500;
      overflow: hidden;
    }
    
    .page-skeleton-container {
      padding: 20px;
      height: 100vh;
      overflow-y: auto;
    }
    
    .page-skeleton-header {
      height: 60px;
      background: #e0e0e0;
      border-radius: 8px;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-nav {
      height: 40px;
      background: #e8e8e8;
      border-radius: 6px;
      margin-bottom: 30px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .page-skeleton-editor {
      height: 400px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-editor::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 30px;
      background: #d0d0d0;
      border-radius: 12px 12px 0 0;
    }
    
    .page-skeleton-tools {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .page-skeleton-tool {
      width: 80px;
      height: 35px;
      background: #e0e0e0;
      border-radius: 6px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-projects {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .page-skeleton-project-list {
      width: 250px;
      height: 300px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-project-editor {
      flex: 1;
      height: 500px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    /* Efecto shimmer para todos los skeletons */
    .page-skeleton-header::before,
    .page-skeleton-nav::before,
    .page-skeleton-editor::after,
    .page-skeleton-tool::before,
    .page-skeleton-project-list::before,
    .page-skeleton-project-editor::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
      animation: skeletonShimmer 1.8s infinite;
    }
    
    /* Skeleton para ajustes */
    .settings-skeleton {
      display: none;
      padding: 20px;
    }
    
    .settings-skeleton-item {
      height: 60px;
      background: #e0e0e0;
      border-radius: 8px;
      margin-bottom: 15px;
      position: relative;
      overflow: hidden;
    }
    
    .settings-skeleton-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
      animation: skeletonShimmer 1.8s infinite;
    }
    
    /* Modal Generador APK */
    #apkGeneratorModal {
      animation: fadeIn 0.3s ease;
    }
    
    #apkGeneratorModal .generation-tool:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(29, 155, 240, 0.2);
    }
    
    #generateAllAPK:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(29, 155, 240, 0.4);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    
    /* Skeleton para proyectos */
    .projects-skeleton {
      display: none;
      padding: 20px;
    }
    
    .projects-skeleton-title {
      height: 40px;
      background: #e0e0e0;
      border-radius: 8px;
      margin-bottom: 30px;
      width: 300px;
      margin-left: auto;
      margin-right: auto;
      position: relative;
      overflow: hidden;
    }
    
    .projects-skeleton-container {
      display: flex;
      gap: 20px;
    }
    
    .projects-skeleton-list {
      width: 250px;
      height: 400px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .projects-skeleton-editor {
      flex: 1;
      height: 600px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .projects-skeleton-title::before,
    .projects-skeleton-list::before,
    .projects-skeleton-editor::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
      animation: skeletonShimmer 1.8s infinite;
    }
    
    /* Indicador de traducci贸n global */
    .global-translation-indicator {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.9);
      color: white;
      padding: 20px 30px;
      border-radius: 15px;
      z-index: 12000;
      text-align: center;
      font-family: 'Poppins', sans-serif;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
    }
    
    .global-translation-indicator h3 {
      margin-bottom: 15px;
      font-size: 18px;
      color: #fff;
    }
    
    .global-translation-indicator .translation-progress {
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
    }
    
    .global-translation-indicator .flag-display {
      font-size: 24px;
      animation: pulse 2s infinite;
    }
    
    @keyframes skeletonShimmer {
      0% {
        left: -100%;
      }
      100% {
        left: 100%;
      }
    }
    
    @keyframes translatingPulse {
      0%, 60%, 100% {
        transform: scale(1);
        opacity: 0.5;
      }
      30% {
        transform: scale(1.2);
        opacity: 1;
      }
    }

    /* Animaciones para reporte de problemas */
    @keyframes reportSuccessPulse {
      0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.4);
      }
      50% {
        transform: scale(1.05);
        box-shadow: 0 0 0 20px rgba(40, 167, 69, 0);
      }
      100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(40, 167, 69, 0);
      }
    }

    @keyframes reportSuccessCheck {
      0% {
        transform: scale(0);
        opacity: 0;
      }
      50% {
        transform: scale(1.2);
        opacity: 1;
      }
      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    @keyframes reportSuccessRing {
      0% {
        transform: scale(0.8);
        opacity: 0.8;
      }
      100% {
        transform: scale(1.2);
        opacity: 0;
      }
    }

    @keyframes reportSlideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Efectos hover para elementos del reporte */
    #imageUploadArea:hover {
      border-color: #1d9bf0 !important;
      background: rgba(29, 155, 240, 0.05) !important;
    }

    #problemDescription:focus {
      border-color: #1d9bf0 !important;
      box-shadow: 0 0 0 1px #1d9bf0 !important;
    }

    #problemType:focus {
      border-color: #1d9bf0 !important;
      box-shadow: 0 0 0 1px #1d9bf0 !important;
    }

    .report-step {
      animation: reportSlideIn 0.5s ease;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes slideOutRight {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }
    
    @media (max-width: 768px) {
      .settings-header {
        padding: 12px 15px;
      }
      
      .settings-item {
        padding: 12px 15px;
      }
      
      .settings-search {
        padding: 12px 15px;
      }
      
      .settings-section-title {
        padding: 15px 15px 8px 15px;
      }
      
      .chat-messages {
        padding: 15px;
      }
      
      .message-content {
        max-width: 85%;
      }
      
      .chat-input-container {
        padding: 12px 15px;
      }
      
      .quick-questions {
        padding: 8px 15px;
      }
      
      /* Modal de reporte responsive */
      #reportArticleModal {
        padding: 10px !important;
      }
      
      #reportArticleModal .modal-content {
        padding: 15px !important;
        margin: 0 !important;
        max-height: 85vh !important;
        border-radius: 12px !important;
      }
      
      #reportArticleModal h3 {
        font-size: 16px !important;
      }
      
      #reportArticleModal label {
        font-size: 13px !important;
      }
      
      #reportArticleModal select,
      #reportArticleModal textarea {
        font-size: 13px !important;
        padding: 10px !important;
      }
      
      #reportArticleModal button {
        padding: 10px 16px !important;
        font-size: 13px !important;
      }
      
      /* Inicio responsive mejorado */
      #inicio .editor-container {
        grid-template-columns: 1fr !important;
        padding: 10px !important;
        gap: 15px !important;
        height: auto !important;
        min-height: calc(100vh - 140px) !important;
      }
      
      #inicio .editor-area {
        min-height: 250px !important;
      }
      
      /* Proyectos responsive mejorado */
      .projects-container {
        flex-direction: column !important;
        height: auto !important;
        max-height: none !important;
      }
      
      .project-list {
        width: 100% !important;
        max-height: 300px !important;
        order: 2;
      }
      
      .project-editor {
        order: 1;
        min-height: 400px !important;
      }
    }
    /* Bot贸n de Soporte dentro de Ajustes */
    #supportOption {
      margin-top: 20px;
      background: #fff;
      color: var(--primary-color);
    }
    
    /* Editor */
    .editor-container {
      max-width: 100%; 
      margin: 0 auto; 
      padding: 20px;
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
      height: calc(100vh - 60px);
    }
    .editor-area {
      background: var(--editor-bg); 
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .editor-area::before {
      content: attr(data-language);
      padding: 8px 16px;
      background: rgba(0,0,0,0.1);
      color: var(--text-color);
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
    }
    .editor-wrapper {
      position: relative;
      height: 100%;
      background: var(--editor-bg);
    }

    .line-numbers {
      width: 45px;
      padding: 16px 8px;
      background: var(--editor-bg);
      color: #666;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
      text-align: right;
      user-select: none;
      border-right: 1px solid rgba(0,0,0,0.1);
      white-space: pre;
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      overflow: hidden;
    }

    textarea {
      width: 100%;
      height: 100%;
      padding: 16px 16px 16px 53px;
      border: none;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
      tab-size: 2;
      resize: none;
      background: var(--editor-bg);
      color: var(--text-color);
      white-space: pre;
      overflow-wrap: normal;
      overflow-x: auto;
    }

    textarea:focus {
      outline: none;
      background: var(--editor-bg);
    }

    /* Colores de sintaxis */
    .syntax-highlight {
      position: absolute;
      left: 53px;
      top: 16px;
      right: 0;
      bottom: 0;
      padding: 0 16px;
      pointer-events: none;
      color: transparent;
      white-space: pre;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
      z-index: -1;
      background: transparent;
    }

    .syntax-highlight .keyword { color: #C678DD; }
    .syntax-highlight .string { color: #98C379; }
    .syntax-highlight .number { color: #D19A66; }
    .syntax-highlight .function { color: #61AFEF; }
    .syntax-highlight .comment { color: #5C6370; font-style: italic; }
    .dark-mode .editor-area {
      background: #1e1e1e;
    }
    .dark-mode textarea {
      background: #1e1e1e;
      color: #d4d4d4;
    }
    /* Vista Previa y Herramientas */
    .preview-tools {
      display: flex;
      gap: 10px;
      margin: 15px 20px;
      justify-content: center;
    }

    .preview-tools button {
      background: var(--primary-color);
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .preview-tools button:hover {
      background: #166fe5;
      transform: scale(1.05);
    }

    /* Herramientas del Editor */
    .editor-tools {
      display: flex;
      gap: 15px;
      margin: 10px 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .tool-group {
      display: flex;
      gap: 5px;
      padding: 5px;
      background: rgba(0,0,0,0.05);
      border-radius: 8px;
    }

    .editor-tools button {
      background: var(--editor-bg);
      border: 1px solid #ddd;
      color: var(--text-color);
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 12px;
      font-weight: 500;
    }

    .editor-tools button:hover {
      background: var(--primary-color);
      color: white;
      transform: translateY(-2px);
    }

    .project-actions .duplicate-btn {
      background: #28a745;
    }

    .project-actions .duplicate-btn:hover {
      background: #218838;
    }

    .project-actions .export-btn {
      background: #17a2b8;
    }

    .project-actions .export-btn:hover {
      background: #138496;
    }

    .project-actions .fullscreen-btn {
      background: #6f42c1;
    }

    .project-actions .fullscreen-btn:hover {
      background: #5a2d91;
    }

    /* Modo pantalla completa */
    .project-editor.fullscreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 9999;
      background: var(--bg-color);
    }

    .project-editor.fullscreen .editor-container {
      height: calc(100vh - 160px);
    }

    .dark-mode .preview-tools button {
      background: var(--primary-color);
      color: white;
    }

    .dark-mode .preview-tools button:hover {
      background: #166fe5;
    }

    .scan-animation {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 10;
      display: none;
      background: rgba(0,0,0,0.2);
      overflow: hidden;
    }

    .scan-line {
      position: absolute;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, #00ff00, transparent);
      box-shadow: 0 0 10px #00ff00;
      animation: scanMove 3s linear infinite;
    }

    .particles {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .particle {
      position: absolute;
      background: #00ff00;
      border-radius: 50%;
      pointer-events: none;
      animation: particleFloat 2s linear infinite;
    }

    @keyframes particleFloat {
      0% {
        transform: translateY(0) scale(1);
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) scale(0);
        opacity: 0;
      }
    }

    .code-highlight {
      position: absolute;
      background: rgba(0, 255, 0, 0.2);
      animation: highlight 0.5s ease;
    }

    @keyframes highlight {
      0% { opacity: 0; }
      50% { opacity: 1; }
      100% { opacity: 0; }
    }

    .scan-results {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.8);
      padding: 20px;
      border-radius: 10px;
      color: #00ff00;
      font-family: monospace;
      display: none;
    }

    @keyframes scanMove {
      0% { top: 0; }
      100% { top: 100%; }
    }

    .preview-overlay {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%; background: var(--editor-bg);
      z-index: 1000; animation: slideUp 0.3s ease;
    }
    @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    .preview-header {
      background: var(--primary-color); padding: 15px 20px;
      display: flex; justify-content: space-between; align-items: center;
      color: #fff;
    }
    .preview-header button {
      background: transparent; border: none; color: #fff;
      font-size: 1.5rem; cursor: pointer;
    }
    #previewFrame {
      width: 100%; height: calc(100% - 60px); border: none;
      background: var(--editor-bg);
    }
    /* Validaci贸n HTML */
    .html-error { border: 2px solid yellow; }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }
    .shake { animation: shake 0.5s; }
    /* Busqueda (Estilo Twitter/X Moderno) */
    #searchOverlay {
      display: none; position: fixed; z-index: 14000; top: 0; left: 0;
      width: 100%; height: 100%; 
      background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
      color: #ffffff; overflow-y: auto; padding: 0;
      animation: searchFadeIn 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    
    @keyframes searchFadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    
    @keyframes searchSlideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .search-top-bar {
      position: sticky; top: 0; z-index: 100;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid #2f3336;
      padding: 15px 20px;
      display: flex; align-items: center; gap: 15px;
    }
    
    .search-top-bar i { 
      font-size: 1.3rem; cursor: pointer; color: #ffffff;
      transition: all 0.2s ease;
      padding: 8px;
      border-radius: 50%;
    }
    
    .search-top-bar i:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: scale(1.1);
    }
    
    .search-input-container {
      flex: 1;
      position: relative;
      display: flex;
      align-items: center;
      background: #16181c;
      border: 2px solid #2f3336;
      border-radius: 25px;
      padding: 0 20px;
      transition: all 0.3s ease;
      overflow: hidden;
    }
    
    .search-input-container:focus-within {
      border-color: #1d9bf0;
      box-shadow: 0 0 0 1px #1d9bf0;
      background: #000000;
    }
    
    .search-icon {
      color: #71767b;
      margin-right: 12px;
      font-size: 1.1rem;
      transition: color 0.3s ease;
    }
    
    .search-input-container:focus-within .search-icon {
      color: #1d9bf0;
    }
    
    .search-top-bar input {
      flex: 1;
      padding: 15px 0;
      font-size: 1.1rem;
      border: none;
      background: transparent;
      color: #ffffff;
      font-weight: 400;
    }
    
    .search-top-bar input::placeholder {
      color: #71767b;
      font-weight: 400;
    }
    
    .search-top-bar input:focus {
      outline: none;
    }
    
    .search-top-bar button {
      background: linear-gradient(45deg, #1d9bf0, #1a8cd8);
      color: #fff; border: none;
      padding: 12px 24px; border-radius: 25px; cursor: pointer; 
      font-weight: 700; font-size: 15px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(29, 155, 240, 0.3);
    }
    
    .search-top-bar button:hover {
      background: linear-gradient(45deg, #1a8cd8, #1d9bf0);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(29, 155, 240, 0.4);
    }
    
    /* Contenedor principal de b煤squeda */
    .search-main-content {
      padding: 0 20px 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    /* Recientes y Tendencias */
    .recent-searches { 
      margin-bottom: 30px;
      animation: searchSlideUp 0.5s ease 0.1s both;
    }
    
    .recent-searches h3 { 
      font-size: 1.4rem; 
      margin-bottom: 15px; 
      color: #ffffff;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .recent-searches h3::before {
      content: "";
      font-size: 1.2rem;
    }
    
    .recent-searches ul { 
      list-style: none; 
      padding: 0; 
      background: #16181c;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid #2f3336;
    }
    
    .recent-searches li {
      cursor: pointer;
      padding: 16px 20px;
      position: relative;
      touch-action: pan-y;
      transition: all 0.3s ease;
      background: #16181c;
      border-bottom: 1px solid #2f3336;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .recent-searches li:last-child {
      border-bottom: none;
    }
    
    .recent-searches li::before {
      content: "";
      font-size: 1rem;
      opacity: 0.7;
    }
    
    .recent-searches li:hover {
      background: #1e2328;
      transform: translateX(4px);
    }
    
    .recent-searches li.swiping {
      transition: none;
    }
    
    .recent-searches li .delete-action {
      position: absolute;
      right: -100px;
      top: 0;
      height: 100%;
      width: 100px;
      background: linear-gradient(45deg, #f91880, #ff4444);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      opacity: 0;
      border-radius: 0 16px 16px 0;
    }
    
    .recent-searches li.show-delete .delete-action {
      opacity: 1;
    }
    
    .trending { 
      margin-bottom: 30px;
      animation: searchSlideUp 0.5s ease 0.2s both;
    }
    
    .trending h3 { 
      font-size: 1.4rem; 
      margin-bottom: 15px;
      color: #ffffff;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .trending h3::before {
      content: "";
      font-size: 1.2rem;
    }
    
    .trending ul { 
      list-style: none; 
      padding: 0;
      background: #16181c;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid #2f3336;
    }
    
    .trending li {
      cursor: pointer; 
      padding: 18px 20px; 
      border-bottom: 1px solid #2f3336;
      transition: all 0.3s ease;
      position: relative;
      background: #16181c;
    }
    
    .trending li:last-child {
      border-bottom: none;
    }
    
    .trending li:hover {
      background: #1e2328;
      transform: translateX(4px);
    }
    
    .trending li::before {
      content: "";
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1rem;
      opacity: 0.8;
    }
    
    .trending li {
      padding-left: 50px;
    }
    
    /* Resultados de B煤squeda */
    .search-results {
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
      animation: searchSlideUp 0.5s ease 0.3s both;
    }
    
    .video-card {
      background: #16181c; 
      border-radius: 16px; 
      overflow: hidden;
      border: 1px solid #2f3336; 
      display: flex; 
      flex-direction: column;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
    }
    
    .video-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.3);
      border-color: #1d9bf0;
    }
    
    .video-card img { 
      width: 100%; 
      height: 200px; 
      object-fit: cover;
      transition: transform 0.3s ease;
    }
    
    .video-card:hover img {
      transform: scale(1.05);
    }
    
    .video-info { 
      padding: 16px 20px; 
      flex: 1;
    }
    
    .video-info h3 { 
      font-size: 1.1rem; 
      margin: 0 0 8px 0; 
      color: #ffffff;
      font-weight: 600;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .video-actions {
      display: flex; 
      justify-content: space-between; 
      align-items: center;
      padding: 16px 20px; 
      border-top: 1px solid #2f3336;
      background: rgba(0, 0, 0, 0.3);
    }
    
    .video-actions button {
      background: linear-gradient(45deg, #1d9bf0, #1a8cd8);
      color: #fff; 
      border: none;
      padding: 8px 16px; 
      border-radius: 20px; 
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .video-actions button:hover {
      background: linear-gradient(45deg, #1a8cd8, #1d9bf0);
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(29, 155, 240, 0.3);
    }
    
    /* Alternador Videos / Art铆culos */
    .search-toggle { 
      display: flex; 
      gap: 0; 
      margin-bottom: 25px;
      background: #16181c;
      border-radius: 25px;
      padding: 4px;
      border: 1px solid #2f3336;
      animation: searchSlideUp 0.5s ease both;
    }
    
    .search-toggle button {
      flex: 1; 
      padding: 12px 24px; 
      border: none;
      border-radius: 21px; 
      background: transparent; 
      color: #71767b;
      cursor: pointer; 
      font-weight: 600;
      font-size: 15px;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
    }
    
    .search-toggle button.active {
      background: linear-gradient(45deg, #1d9bf0, #1a8cd8);
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(29, 155, 240, 0.3);
      transform: scale(1.02);
    }
    
    .search-toggle button:not(.active):hover {
      color: #ffffff;
      background: rgba(255, 255, 255, 0.1);
    }
    
    /* Responsive para m贸viles */
    @media (max-width: 768px) {
      .search-top-bar {
        padding: 12px 15px;
      }
      
      .search-input-container {
        padding: 0 15px;
      }
      
      .search-top-bar input {
        padding: 12px 0;
        font-size: 1rem;
      }
      
      .search-top-bar button {
        padding: 10px 20px;
        font-size: 14px;
      }
      
      .search-main-content {
        padding: 0 15px 15px;
      }
      
      .search-results {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .recent-searches h3,
      .trending h3 {
        font-size: 1.2rem;
      }
      
      .recent-searches li,
      .trending li {
        padding: 14px 15px;
      }
    }
    /* Reproductor de Video a Pantalla Completa */
    #videoPlayerOverlay {
      display: none; position: fixed; z-index: 15000; top: 0; left: 0;
      width: 100%; height: 100%; background: #fff; flex-direction: column;
      padding: 20px;
    }
    #videoPlayerOverlay iframe {
      width: 100%; 
      height: 100vh;
      margin: 0;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 15001;
    }
    .video-player-actions {
      margin-top: 20px; display: flex; gap: 10px;
      justify-content: center; align-items: center;
    }
    .video-player-actions button {
      background: var(--primary-color); border: none;
      padding: 10px 20px; border-radius: 5px; cursor: pointer;
      font-size: 1rem; color: #fff;
    }
    /* Animaci贸n Like */
    .like-animation {
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%); font-size: 5rem; color: red;
      opacity: 0; animation: likePop 0.8s forwards; pointer-events: none;
    }
    @keyframes likePop {
      0% { transform: translate(-50%, -50%) scale(0.1); opacity: 0; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }
    /* Modal Reportar Video */
    #reportModal {
      display: none; position: fixed; z-index: 16000; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.8);
      justify-content: center; align-items: center; color: #fff; padding: 20px;
    }
    #reportModal .modal-content {
      background: #fff; color: #333; width: 100%; max-width: 500px; padding: 20px;
      border-radius: 8px;
    }
    #reportModal h3 { margin-bottom: 10px; }
    #reportModal label { display: block; margin: 10px 0 5px; }
    #reportModal textarea {
      width: 100%; min-height: 80px; padding: 10px; resize: vertical;
    }
    #reportModal button {
      background: var(--primary-color); color: #fff; border: none;
      padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;
    }
    /* Search Spinner Animation */
    #searchSpinner {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100px;
      height: 100px;
      z-index: 1000;
    }

    #searchSpinner::before,
    #searchSpinner::after {
      content: '';
      position: absolute;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: #1877f2;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      animation: circle-dance 1.5s infinite ease-in-out;
    }

    #searchSpinner::after {
      animation-delay: -0.5s;
      background: #00f2ea;
    }

    @keyframes circle-dance {
      0%, 100% {
        transform: translate(-50%, -50%) rotate(0deg) translateX(30px);
      }
      50% {
        transform: translate(-50%, -50%) rotate(180deg) translateX(30px);
      }
    }

    /* Estilos para botones de art铆culo */
    .action-btn:hover {
      background: rgba(29, 155, 240, 0.1) !important;
      color: #1d9bf0 !important;
      transform: scale(1.05);
    }

    #likeArticle:hover, #likeArticle.liked {
      background: rgba(249, 24, 128, 0.1) !important;
      color: #f91880 !important;
    }

    #likeArticle.liked i {
      color: #f91880 !important;
    }

    

    #bookmarkArticle:hover, #bookmarkArticle.bookmarked {
      background: rgba(29, 155, 240, 0.1) !important;
      color: #1d9bf0 !important;
    }

    #reportArticle:hover {
      background: rgba(249, 24, 128, 0.1) !important;
      color: #f91880 !important;
    }

    #readerArticle:hover, #readerArticle.reading {
      background: rgba(52, 199, 89, 0.1) !important;
      color: #34c759 !important;
    }

    #readerArticle.reading {
      animation: pulse 2s infinite;
    }

    #closeArticle:hover {
      background: rgba(29, 155, 240, 0.1) !important;
    }

    

    #followAuthor:hover {
      background: #1a8cd8 !important;
      transform: scale(1.05);
    }

    #followAuthor.following {
      background: transparent !important;
      color: #1d9bf0 !important;
      border: 1px solid #1d9bf0 !important;
    }

    /* Efectos para art铆culos relacionados */
    .related-article-item {
      padding: 15px;
      border: 1px solid #2f3336;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      background: #16181c;
    }

    .related-article-item:hover {
      background: #1e2328;
      border-color: #1d9bf0;
      transform: translateY(-2px);
    }

    .article-stats {
      display: flex;
      align-items: center;
      margin-top: 5px;
      font-size: 0.9em;
      color: #666;
    }
    .article-stats i {
      margin-right: 5px;
    }

  /* Selector de idioma flotante */
    #langSelector:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    
    #langSelector:active {
      transform: scale(0.95);
    }
    
    @media (max-width: 768px) {
      #langSelector {
        top: 15px;
        right: 15px;
        width: 45px;
        height: 45px;
      }
      
      #langSelector i {
        font-size: 16px;
      }
    }

    /* Estilos para navegaci贸n */
    nav {
      background: rgba(24, 119, 242, 0.9);
      padding: 10px 20px;
      display: flex;
      gap: 20px;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    nav a {
      color: white;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 5px;
      transition: background 0.3s ease;
      font-weight: 500;
    }

    nav a:hover, nav a.active {
      background: rgba(255,255,255,0.2);
    }

    /* Secciones ocultas por defecto */
    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    /* Editor principal (inicio) */
    #inicio .editor-container {
      max-width: 100%; 
      margin: 0 auto; 
      padding: 20px;
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
      height: calc(100vh - 120px);
    }

    /* Estilos para la secci贸n de inicio - Editor principal */
    #inicio {
      padding: 0;
      background: var(--bg-color);
      color: var(--text-color);
      min-height: 100vh;
    }

    #inicio h2 {
      font-size: 20px;
      font-weight: 700;
      margin: 0;
      padding: 16px 20px;
      border-bottom: 1px solid #d2d2d7;
      background: rgba(245, 245, 247, 0.95);
      backdrop-filter: blur(20px);
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .dark-mode #inicio h2 {
      border-bottom-color: #2f3336;
      background: rgba(29, 29, 31, 0.95);
      color: #f5f5f7;
    }

    #inicio .editor-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
      padding: 20px;
      height: calc(100vh - 200px);
    }

    #inicio .editor-area {
      background: var(--editor-bg);
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .dark-mode #inicio .editor-area {
      background: #16181c;
      border: 1px solid #2f3336;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    #inicio .editor-area::before {
      content: attr(data-language);
      padding: 12px 20px;
      background: rgba(0,0,0,0.1);
      color: var(--text-color);
      font-size: 14px;
      font-weight: 700;
      text-transform: uppercase;
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    .dark-mode #inicio .editor-area::before {
      background: #000000;
      color: #ffffff;
      border-bottom-color: #2f3336;
    }

    #inicio .editor-wrapper {
      position: relative;
      height: 100%;
      background: var(--editor-bg);
    }

    .dark-mode #inicio .editor-wrapper {
      background: #16181c;
    }

    #inicio .line-numbers {
      width: 45px;
      padding: 16px 8px;
      background: var(--editor-bg);
      color: #666;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
      text-align: right;
      user-select: none;
      border-right: 1px solid rgba(0,0,0,0.1);
      white-space: pre;
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      overflow: hidden;
    }

    .dark-mode #inicio .line-numbers {
      background: #16181c;
      color: #71767b;
      border-right-color: #2f3336;
    }

    #inicio textarea {
      width: 100%;
      height: 100%;
      padding: 16px 16px 16px 53px;
      border: none;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
      tab-size: 2;
      resize: none;
      background: var(--editor-bg);
      color: var(--text-color);
      white-space: pre;
      overflow-wrap: normal;
      overflow-x: auto;
    }

    .dark-mode #inicio textarea {
      background: #16181c;
      color: #ffffff;
    }

    #inicio textarea:focus {
      outline: none;
    }

    #inicio textarea::placeholder {
      color: #999;
    }

    .dark-mode #inicio textarea::placeholder {
      color: #71767b;
    }

    /* Estilos para la secci贸n de proyectos - Estilo Twitter */
    #proyectos {
      padding: 0;
      background: #000000;
      color: #ffffff;
      min-height: 100vh;
    }

    #proyectos h2 {
      font-size: 20px;
      font-weight: 700;
      margin: 0;
      padding: 16px 20px;
      border-bottom: 1px solid #2f3336;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    #proyectos h2 i {
      font-size: 18px;
      color: #1d9bf0;
    }

    .projects-container {
      display: flex;
      height: calc(100vh - 80px);
      max-height: calc(100vh - 80px);
    }

    .project-list {
      width: 320px;
      background: #000000;
      border-right: 1px solid #2f3336;
      padding: 0;
      overflow-y: auto;
      flex-shrink: 0;
    }

    .project-list-header {
      padding: 16px 20px;
      border-bottom: 1px solid #2f3336;
      background: #000000;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .project-list button.new-project-btn {
      background: #1d9bf0;
      color: #ffffff;
      border: none;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 700;
      font-size: 15px;
      transition: all 0.2s ease;
      width: 100%;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .project-list button.new-project-btn:hover {
      background: #1a8cd8;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(29, 155, 240, 0.3);
    }

    .project-list button.import-project-btn {
      background: transparent;
      color: #1d9bf0;
      border: 1px solid #2f3336;
      padding: 10px 16px;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.2s ease;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .project-list button.import-project-btn:hover {
      background: rgba(29, 155, 240, 0.1);
      border-color: #1d9bf0;
    }

    #projectsList {
      padding: 0;
    }

    .project-item {
      padding: 16px 20px;
      border-bottom: 1px solid #2f3336;
      cursor: pointer;
      transition: all 0.2s ease;
      background: #000000;
      position: relative;
    }

    .project-item:hover {
      background: #1e2328;
    }

    .project-item.active {
      background: rgba(29, 155, 240, 0.1);
      border-left: 3px solid #1d9bf0;
    }

    .project-item-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .project-name {
      font-size: 16px;
      font-weight: 700;
      color: #ffffff;
      margin: 0;
      flex: 1;
    }

    .project-favorite {
      background: none;
      border: none;
      color: #71767b;
      cursor: pointer;
      padding: 4px;
      transition: color 0.2s ease;
    }

    .project-favorite.favorited {
      color: #ffd700;
    }

    .project-meta {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .project-date {
      font-size: 14px;
      color: #71767b;
    }

    .project-tags {
      display: flex;
      gap: 6px;
    }

    .project-tag {
      background: rgba(29, 155, 240, 0.1);
      color: #1d9bf0;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }

    .project-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .project-action-btn {
      background: none;
      border: 1px solid #2f3336;
      color: #71767b;
      padding: 6px 12px;
      border-radius: 16px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      transition: all 0.2s ease;
    }

    .project-action-btn.primary {
      background: #1d9bf0;
      color: #ffffff;
      border-color: #1d9bf0;
    }

    .project-action-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: #ffffff;
    }

    .project-action-btn.primary:hover {
      background: #1a8cd8;
    }

    .project-editor {
      flex: 1;
      background: #000000;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }

    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      background: #000000;
      border-bottom: 1px solid #2f3336;
      flex-shrink: 0;
    }

    .project-header input#projectName {
      padding: 12px 16px;
      border: 1px solid #2f3336;
      border-radius: 20px;
      font-size: 16px;
      font-weight: 600;
      color: #ffffff;
      background: #16181c;
      flex: 1;
      margin-right: 16px;
      transition: all 0.3s ease;
    }

    .project-header input#projectName:focus {
      outline: none;
      border-color: #1d9bf0;
      background: #000000;
    }

    .project-header .project-actions {
      display: flex;
      gap: 8px;
    }

    .project-header .project-actions button {
      background: #16181c;
      color: #ffffff;
      border: 1px solid #2f3336;
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .project-header .project-actions button:hover {
      background: #1e2328;
      border-color: #71767b;
    }

    .project-header .project-actions button.save-btn {
      background: #00ba7c;
      color: #ffffff;
      border-color: #00ba7c;
    }

    .project-header .project-actions button.save-btn:hover {
      background: #00a66d;
    }

    .project-header .project-actions button.close-btn {
      background: #f91880;
      color: #ffffff;
      border-color: #f91880;
    }

    .project-header .project-actions button.close-btn:hover {
      background: #e0166a;
    }
  </style>
</head>
<body>
  <!-- ===== Intro Animation ===== -->
  <div class="intro">
    <div class="code-effect"></div>
    <h1 class="logo">Clack</h1>
  </div>

  <!-- ===== Modal Login ===== -->
  <div id="loginModal" class="modal">
    <div class="modal-content" id="loginContent">
      <h2 id="modalTitle">Registro / Inicia sesi贸n con GitHub</h2>
      <p id="modalDescription">Inicia sesi贸n como invitado.</p>
      <button id="githubLoginBtn">
        <i class="fa-brands fa-github"></i>
        <span id="loginBtnText">Iniciar sesi贸n con GitHub como invitado</span>
      </button>
      <button id="changeLangBtn">Cambiar Idioma</button>
    </div>
  </div>

  <!-- ===== Overlay Transici贸n Idioma ===== -->
  <div id="langTransitionOverlay">
    <div class="lang-ball ball-left"></div>
    <div class="lang-ball ball-right"></div>
  </div>

  <!-- ===== Overlay Scan (Vista Previa) ===== -->
  <div id="scanOverlay"></div>

  <!-- ===== Overlay Skeleton de P谩gina Completa ===== -->
  <div id="pageSkeletonOverlay">
    <div class="page-skeleton-container">
      <div class="page-skeleton-header"></div>
      <div class="page-skeleton-nav"></div>
      <div class="page-skeleton-content">
        <div class="page-skeleton-editor"></div>
        <div class="page-skeleton-editor"></div>
        <div class="page-skeleton-editor"></div>
      </div>
      <div class="page-skeleton-tools">
        <div class="page-skeleton-tool"></div>
        <div class="page-skeleton-tool"></div>
        <div class="page-skeleton-tool"></div>
        <div class="page-skeleton-tool"></div>
        <div class="page-skeleton-tool"></div>
      </div>
      <div class="page-skeleton-projects">
        <div class="page-skeleton-project-list"></div>
        <div class="page-skeleton-project-editor"></div>
      </div>
    </div>
    
    <div class="global-translation-indicator">
      <h3>Traduciendo interfaz</h3>
      <div class="translation-progress">
        <span class="flag-display" id="translationFlag"></span>
        <div class="translating-dots">
          <div class="translating-dot"></div>
          <div class="translating-dot"></div>
          <div class="translating-dot"></div>
        </div>
        <span id="translationStatus">Cambiando idioma...</span>
      </div>
    </div>
  </div>

  <!-- ===== Overlay Ajustes estilo Instagram ===== -->
  <div id="settingsOverlay">
    <div class="settings-header">
      <button class="back-btn" id="closeSettings">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>Configuraci贸n</h2>
    </div>
    
    <div class="settings-search">
      <input type="text" placeholder="Buscar" id="settingsSearch">
    </div>
    
    <!-- Skeleton para ajustes -->
    <div class="settings-skeleton" id="settingsSkeleton">
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
    </div>
    
    <div class="settings-content" id="settingsContent">
      <div class="settings-item" id="languageSettingsItem">
        <div class="settings-item-icon">
          <i class="fas fa-globe"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Idioma</div>
          <div class="settings-item-subtitle" id="currentLanguageText">Espa帽ol</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-item" id="themeSettingsItem">
        <div class="settings-item-icon">
          <i class="fas fa-moon" id="themeIcon"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Tema</div>
          <div class="settings-item-subtitle" id="currentThemeText">Claro</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-item">
        <div class="settings-item-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Privacidad</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-item">
        <div class="settings-item-icon">
          <i class="fas fa-lock"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Seguridad</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-section-title">Asistencia</div>
      
      <div class="settings-item" id="helpBotItem">
        <div class="settings-item-icon">
          <i class="fas fa-robot" style="color: #1d9bf0;"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Asistente Virtual</div>
          <div class="settings-item-subtitle">Listo para ayudarte - Haz clic aqu铆</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-item" id="helpSectionItem">
        <div class="settings-item-icon">
          <i class="fas fa-question-circle" style="color: #28a745;"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Ayuda</div>
          <div class="settings-item-subtitle">Centro de ayuda y soporte</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div></div>
      
      <div class="settings-section-title">Informaci贸n</div>
      
      <div class="settings-item">
        <div class="settings-item-icon">
          <i class="fas fa-info-circle"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Acerca de</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== Submenu de Idiomas ===== -->
  <div id="languageSubmenu" class="language-submenu">
    <div class="settings-header">
      <button class="back-btn" id="backToSettings">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>Idioma</h2>
    </div>
    
    <div class="settings-content">
      <div class="language-option" data-lang="es">
        <div class="flag"></div>
        <div class="name">Espa帽ol</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="en">
        <div class="flag">吼</div>
        <div class="name">English</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="ja">
        <div class="flag"></div>
        <div class="name">ユ瑾</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="ko">
        <div class="flag">梆</div>
        <div class="name">甑</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="vi">
        <div class="flag">火</div>
        <div class="name">Ti岷ng Vi峄t</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="zh">
        <div class="flag"></div>
        <div class="name">涓</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
    </div>
  </div>

  <!-- ===== Secci贸n de Ayuda ===== -->
  <div id="helpSection" class="language-submenu">
    <div class="settings-header">
      <button class="back-btn" id="backToSettingsFromHelp">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>Centro de Ayuda</h2>
    </div>
    
    <div class="settings-content">
      <div class="settings-item" id="reportProblemOption">
        <div class="settings-item-icon">
          <i class="fas fa-exclamation-triangle" style="color: #dc3545;"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Reportar un problema</div>
          <div class="settings-item-subtitle">Informa sobre errores o fallos</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      
      
      <div class="settings-item" id="contactSupportOption">
        <div class="settings-item-icon">
          <i class="fas fa-comment-dots" style="color: #6f42c1;"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Contactar soporte</div>
          <div class="settings-item-subtitle">Comunicaci贸n directa con el equipo</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== Secci贸n de Contacto de Soporte ===== -->
  <div id="contactSupportSection" class="language-submenu">
    <div class="settings-header">
      <button class="back-btn" id="backToSettingsFromSupport">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>Contactar Soporte</h2>
    </div>
    
    <div class="settings-content">
      <!-- Formulario de Contacto -->
      <div id="supportContactForm" class="support-form-container">
        <div style="text-align: center; margin-bottom: 30px;">
          <div style="width: 80px; height: 80px; background: linear-gradient(45deg, #6f42c1, #5a2d91); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 36px; color: white;">
            
          </div>
          <h3 style="color: #ffffff; font-size: 20px; margin-bottom: 8px;">驴Necesitas ayuda?</h3>
          <p style="color: #71767b; font-size: 14px; line-height: 1.4;">Completa el formulario para conectarte con un agente de soporte</p>
        </div>

        <div style="margin-bottom: 25px;">
          <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Correo electr贸nico <span style="color: #dc3545;">*</span></label>
          <input type="email" id="supportEmail" placeholder="tu@email.com" style="width: 100%; padding: 15px; border: 2px solid #2f3336; border-radius: 12px; background: #16181c; color: #ffffff; font-size: 15px; box-sizing: border-box;" required />
        </div>

        <div style="margin-bottom: 25px;">
          <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Categor铆a del problema <span style="color: #dc3545;">*</span></label>
          <select id="supportCategory" style="width: 100%; padding: 15px; border: 2px solid #2f3336; border-radius: 12px; background: #16181c; color: #ffffff; font-size: 15px; box-sizing: border-box;" required>
            <option value="">Selecciona una categor铆a</option>
            <option value="technical"> Problema t茅cnico</option>
            <option value="account"> Problema de cuenta</option>
            <option value="billing"> Facturaci贸n y pagos</option>
            <option value="feature"> Solicitud de funci贸n</option>
            <option value="bug"> Reporte de error</option>
            <option value="other"> Otro</option>
          </select>
        </div>

        <div style="margin-bottom: 25px;">
          <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Describe tu problema <span style="color: #dc3545;">*</span></label>
          <textarea id="supportDescription" placeholder="Describe detalladamente el problema que est谩s experimentando..." style="width: 100%; min-height: 120px; padding: 15px; border: 2px solid #2f3336; border-radius: 12px; background: #16181c; color: #ffffff; font-size: 15px; font-family: inherit; box-sizing: border-box; resize: vertical;" required></textarea>
          <div style="text-align: right; color: #71767b; font-size: 12px; margin-top: 5px;">
            <span id="supportCharCount">0</span>/500 caracteres
          </div>
        </div>

        <div style="margin-bottom: 25px;">
          <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Prioridad</label>
          <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 15px; border: 2px solid #2f3336; border-radius: 20px; background: #16181c; transition: all 0.3s ease; flex: 1; min-width: 120px;" onclick="selectPriority('low')">
              <input type="radio" name="priority" value="low" id="priorityLow" style="margin: 0;" />
              <span style="color: #ffffff; font-size: 14px;"> Baja</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 15px; border: 2px solid #2f3336; border-radius: 20px; background: #16181c; transition: all 0.3s ease; flex: 1; min-width: 120px;" onclick="selectPriority('medium')">
              <input type="radio" name="priority" value="medium" id="priorityMedium" style="margin: 0;" />
              <span style="color: #ffffff; font-size: 14px;"> Media</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 15px; border: 2px solid #2f3336; border-radius: 20px; background: #16181c; transition: all 0.3s ease; flex: 1; min-width: 120px;" onclick="selectPriority('high')">
              <input type="radio" name="priority" value="high" id="priorityHigh" style="margin: 0;" />
              <span style="color: #ffffff; font-size: 14px;"> Alta</span>
            </label>
          </div>
        </div>

        <button id="startChatBtn" style="background: linear-gradient(45deg, #6f42c1, #5a2d91); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: 700; font-size: 16px; width: 100%; transition: all 0.3s ease; margin-bottom: 20px;" disabled>
          <i class="fas fa-comments" style="margin-right: 8px;"></i>
          Iniciar Chat con Soporte
        </button>

        <div style="text-align: center; color: #71767b; font-size: 12px;">
          <i class="fas fa-shield-alt" style="margin-right: 5px;"></i>
          Tus datos est谩n protegidos y solo ser谩n usados para brindarte soporte
        </div>
      </div>

      <!-- Estado de Cola de Espera -->
      <div id="supportQueue" class="support-queue-container" style="display: none;">
        <div style="text-align: center; margin-bottom: 30px;">
          <div class="queue-animation" style="width: 100px; height: 100px; margin: 0 auto 20px; position: relative;">
            <div style="width: 100px; height: 100px; border: 4px solid #6f42c1; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: rgba(111, 66, 193, 0.1); animation: pulse 2s infinite;">
              <i class="fas fa-clock" style="font-size: 36px; color: #6f42c1;"></i>
            </div>
          </div>
          <h3 style="color: #ffffff; font-size: 20px; margin-bottom: 8px;">En cola de espera</h3>
          <p style="color: #71767b; font-size: 14px; line-height: 1.4;">Te conectaremos con el pr贸ximo agente disponible</p>
        </div>

        <div style="background: #16181c; border-radius: 15px; padding: 25px; margin-bottom: 25px; border: 1px solid #2f3336;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <span style="color: #e7e9ea; font-weight: 600;">Posici贸n en cola:</span>
            <span id="queuePosition" style="color: #6f42c1; font-weight: 700; font-size: 18px;">#1</span>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <span style="color: #e7e9ea; font-weight: 600;">Tiempo estimado:</span>
            <span id="estimatedWait" style="color: #6f42c1; font-weight: 700;">~2 min</span>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <span style="color: #e7e9ea; font-weight: 600;">ID de ticket:</span>
            <span id="ticketId" style="color: #71767b; font-family: monospace;">#SUP-0000</span>
          </div>
        </div>

        <div style="background: rgba(111, 66, 193, 0.1); border: 1px solid #6f42c1; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
            <i class="fas fa-info-circle" style="color: #6f42c1; font-size: 18px;"></i>
            <span style="color: #ffffff; font-weight: 600;">Mientras esperas</span>
          </div>
          <ul style="color: #e7e9ea; font-size: 14px; line-height: 1.6; margin: 0; padding-left: 20px;">
            <li>Mant茅n esta ventana abierta</li>
            <li>Prepara cualquier informaci贸n adicional relevante</li>
            <li>Puedes navegar por otras secciones de la app</li>
          </ul>
        </div>

        <button id="cancelQueueBtn" style="background: none; border: 2px solid #dc3545; color: #dc3545; padding: 12px 25px; border-radius: 20px; cursor: pointer; font-weight: 600; width: 100%; transition: all 0.3s ease;">
          <i class="fas fa-times" style="margin-right: 8px;"></i>
          Salir de la cola
        </button>
      </div>
    </div>
  </div>

  <!-- ===== Chat de Soporte en Tiempo Real ===== -->
  <div id="supportChatOverlay" class="support-chat-overlay" style="display: none;">
    <div class="chat-header" style="background: linear-gradient(45deg, #6f42c1, #5a2d91); color: white; padding: 15px 20px; display: flex; align-items: center; gap: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
      <button class="back-btn" id="closeSupportChat" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer; padding: 5px;">
        <i class="fas fa-times"></i>
      </button>
      <div class="agent-info" style="flex: 1; display: flex; align-items: center; gap: 12px;">
        <div class="agent-avatar" style="width: 45px; height: 45px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 18px; position: relative;">
          ㄢ
          <div class="online-indicator" style="position: absolute; bottom: 2px; right: 2px; width: 12px; height: 12px; background: #4CAF50; border: 2px solid white; border-radius: 50%;"></div>
        </div>
        <div class="agent-details">
          <h3 style="margin: 0; font-size: 16px; font-weight: 600;" id="agentName">Agente de Soporte</h3>
          <p style="margin: 0; font-size: 12px; opacity: 0.9;" id="agentStatus">En l铆nea  Tiempo de respuesta: ~30s</p>
        </div>
      </div>
      <div class="chat-actions" style="display: flex; gap: 10px;">
        <button class="action-btn" id="chatOptionsBtn" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 8px; border-radius: 50%; cursor: pointer; transition: all 0.2s ease;">
          <i class="fas fa-ellipsis-v"></i>
        </button>
      </div>
    </div>
    
    <div class="support-chat-container" style="flex: 1; display: flex; flex-direction: column; overflow: hidden; background: #f8f9fa;">
      <!-- Informaci贸n del Ticket -->
      <div class="ticket-info" style="background: #ffffff; border-bottom: 1px solid #e0e0e0; padding: 15px 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <span style="color: #333; font-weight: 600; font-size: 14px;">Ticket ID:</span>
          <span id="chatTicketId" style="color: #6f42c1; font-family: monospace; font-weight: 600;">#SUP-0000</span>
        </div>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <span style="color: #333; font-weight: 600; font-size: 14px;">Categor铆a:</span>
          <span id="chatCategory" style="color: #666; font-size: 14px;">Problema t茅cnico</span>
        </div>
        <div style="color: #666; font-size: 13px; line-height: 1.4;" id="chatDescription">
          Descripci贸n del problema aparecer谩 aqu铆...
        </div>
      </div>
      
      <div class="chat-messages-container" style="flex: 1; overflow-y: auto; background: #f8f9fa;">
        <div class="chat-messages" id="supportChatMessages" style="padding: 20px;">
          <!-- Mensaje de bienvenida autom谩tico -->
          <div class="message bot" style="margin-bottom: 15px; display: flex; justify-content: flex-start;">
            <div class="message-content" style="max-width: 70%; padding: 12px 16px; border-radius: 18px; background: white; color: #333; border: 1px solid #e0e0e0; border-bottom-left-radius: 5px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); word-wrap: break-word;">
               隆Hola! Soy tu agente de soporte. He revisado tu consulta y estoy aqu铆 para ayudarte. 驴Podr铆as darme m谩s detalles sobre el problema que est谩s experimentando?
              <div class="message-time" style="font-size: 11px; opacity: 0.7; margin-top: 5px; text-align: left;" id="welcomeSupportTime"></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Indicador de escritura -->
      <div id="supportTypingIndicator" class="typing-indicator" style="display: none; margin: 15px 20px; align-items: center; gap: 8px; padding: 12px 16px; background: white; border-radius: 18px; border-bottom-left-radius: 5px; border: 1px solid #e0e0e0; max-width: 70%;">
        <div class="agent-avatar" style="width: 24px; height: 24px; background: #6f42c1; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; margin-right: 8px;">ㄢ</div>
        <span style="color: #666; font-size: 14px; margin-right: 10px;">El agente est谩 escribiendo</span>
        <div class="typing-dots" style="display: flex; gap: 3px;">
          <div class="typing-dot" style="width: 8px; height: 8px; background: #999; border-radius: 50%; animation: typingDot 1.4s infinite;"></div>
          <div class="typing-dot" style="width: 8px; height: 8px; background: #999; border-radius: 50%; animation: typingDot 1.4s infinite; animation-delay: 0.2s;"></div>
          <div class="typing-dot" style="width: 8px; height: 8px; background: #999; border-radius: 50%; animation: typingDot 1.4s infinite; animation-delay: 0.4s;"></div>
        </div>
      </div>
      
      <div class="chat-input-container" style="padding: 15px 20px; background: white; border-top: 1px solid #e0e0e0; display: flex; gap: 10px; align-items: flex-end;">
        <textarea class="chat-input" id="supportChatInput" placeholder="Escribe tu mensaje..." style="flex: 1; border: 1px solid #e0e0e0; border-radius: 20px; padding: 12px 16px; font-size: 14px; resize: none; min-height: 20px; max-height: 100px; background: #f8f9fa; font-family: inherit;"></textarea>
        <button class="send-button" id="supportSendButton" style="background: #6f42c1; color: white; border: none; border-radius: 50%; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s ease;">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
      
      <!-- Botones de acci贸n r谩pida -->
      <div class="quick-actions" style="padding: 10px 20px; background: white; border-top: 1px solid #e0e0e0;">
        <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;">
          <button class="quick-action-btn" onclick="sendQuickMessage('Necesito m谩s tiempo para explicar')" style="background: #f0f2f5; border: 1px solid #e0e0e0; color: #333; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 12px; transition: all 0.2s ease;"> M谩s tiempo</button>
          <button class="quick-action-btn" onclick="sendQuickMessage('驴Podr铆as explicarlo paso a paso?')" style="background: #f0f2f5; border: 1px solid #e0e0e0; color: #333; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 12px; transition: all 0.2s ease;"> Paso a paso</button>
          <button class="quick-action-btn" onclick="sendQuickMessage('Gracias por tu ayuda')" style="background: #f0f2f5; border: 1px solid #e0e0e0; color: #333; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 12px; transition: all 0.2s ease;"> Gracias</button>
          <button class="quick-action-btn" onclick="sendQuickMessage('El problema est谩 resuelto')" style="background: #f0f2f5; border: 1px solid #e0e0e0; color: #333; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 12px; transition: all 0.2s ease;"> Resuelto</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== Bot de Ayuda ===== -->
  <div id="helpBotOverlay">
    <div class="chat-header">
      <button class="back-btn" id="closeHelpBot">
        <i class="fas fa-arrow-left"></i>
      </button>
      <div class="bot-info">
        <div class="bot-avatar">
          <i class="fas fa-robot"></i>
        </div>
        <div class="bot-details">
          <h3>Asistente Clack</h3>
          <p>En l铆nea  Siempre disponible</p>
        </div>
      </div>
      <div class="chat-language-selector">
        <button class="language-selector-btn" id="chatLanguageBtn">
          <i class="fas fa-globe"></i>
          <span id="currentChatLang">ES</span>
          <i class="fas fa-chevron-down"></i>
        </button>
        <div class="chat-language-dropdown" id="chatLanguageDropdown">
          <div class="chat-lang-option" data-lang="es" data-flag="">Espa帽ol</div>
          <div class="chat-lang-option" data-lang="pt" data-flag="ю">Portugu锚s</div>
          <div class="chat-lang-option" data-lang="ko" data-flag="梆">甑</div>
          <div class="chat-lang-option" data-lang="vi" data-flag="火">Ti岷ng Vi峄t</div>
          <div class="chat-lang-option" data-lang="en" data-flag="吼">English</div>
        </div>
      </div>
    </div>
    
    <div class="chat-container">
      <div class="chat-messages" id="chatMessages">
        <div class="message bot">
          <div class="message-content">
            隆Hola!  Soy tu asistente virtual de Clack. Puedo ayudarte con:
            <br><br>
              Funciones del editor de c贸digo
              Personalizaci贸n y temas
              Gesti贸n de proyectos
              Vista previa y deployment
             ★ An谩lisis de seguridad
            <br><br>
            驴En qu茅 puedo ayudarte hoy?
            <div class="message-time" id="welcomeTime"></div>
          </div>
        </div>
      </div>
      
      <div class="quick-questions">
        <div class="quick-questions-title">Preguntas frecuentes:</div>
        <div class="quick-questions-list">
          <span class="quick-question" onclick="askQuickQuestion('驴C贸mo crear un nuevo proyecto?')">驴C贸mo crear un proyecto?</span>
          <span class="quick-question" onclick="askQuickQuestion('驴C贸mo cambiar el tema?')">驴Cambiar tema?</span>
          <span class="quick-question" onclick="askQuickQuestion('驴C贸mo usar el esc谩ner?')">驴Usar esc谩ner?</span>
          <span class="quick-question" onclick="askQuickQuestion('驴C贸mo exportar proyecto?')">驴Exportar proyecto?</span>
          <span class="quick-question" onclick="askQuickQuestion('驴Atajos de teclado?')">驴Atajos?</span>
        </div>
      </div>
      
      <div class="chat-input-container">
        <textarea class="chat-input" id="chatInput" placeholder="Escribe tu pregunta..." rows="1"></textarea>
        <button class="send-button" id="sendButton">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- ===== Header ===== -->
  

  <header>
    <h1><i class="fa-solid fa-code"></i> Clack</h1>
    <div class="controls">
      <button id="previewBtn"><i class="fa-solid fa-eye"></i> <span id="previewBtnText">Vista Previa</span></button>
      <button id="searchBtn" title="Buscar"><i class="fa-solid fa-magnifying-glass"></i></button>
      <button id="settingsBtn" title="Ajustes"><i class="fa-solid fa-gear"></i></button>
    </div>
  </header>
    <!-- ===== Navigation ===== -->
    <nav>
        <a href="#" onclick="showSection('inicio')" class="active">Inicio</a>
        <a href="#" onclick="showSection('proyectos')">Proyectos</a>
    </nav>

  <!-- ===== Secci贸n Inicio (Editor Principal) ===== -->
  <section id="inicio" class="section active">
    <h2>
      <i class="fas fa-code" style="margin-right: 12px; color: #1d9bf0;"></i>
      Editor de C贸digo
    </h2>
    
    <div class="editor-container">
      <div class="editor-area" data-language="HTML">
        <div class="editor-wrapper">
          <div class="line-numbers" id="htmlLineNumbersMain">1</div>
          <textarea id="htmlEditorMain" placeholder="Escribe tu c贸digo HTML aqu铆..." spellcheck="false"></textarea>
          <div class="syntax-highlight" id="htmlHighlightMain"></div>
        </div>
      </div>
      <div class="editor-area" data-language="CSS">
        <div class="editor-wrapper">
          <div class="line-numbers" id="cssLineNumbersMain">1</div>
          <textarea id="cssEditorMain" placeholder="Escribe tu c贸digo CSS aqu铆..." spellcheck="false"></textarea>
          <div class="syntax-highlight" id="cssHighlightMain"></div>
        </div>
      </div>
      <div class="editor-area" data-language="JavaScript">
        <div class="editor-wrapper">
          <div class="line-numbers" id="jsLineNumbersMain">1</div>
          <textarea id="jsEditorMain" placeholder="Escribe tu c贸digo JavaScript aqu铆..." spellcheck="false"></textarea>
          <div class="syntax-highlight" id="jsHighlightMain"></div>
        </div>
      </div>
    </div>

    <div class="editor-tools">
      <div class="tool-group">
        <button onclick="formatAllCode()" title="Formatear todo el c贸digo">
          <i class="fas fa-code"></i> Formatear
        </button>
        <button onclick="findAndReplace()" title="Buscar y reemplazar">
          <i class="fas fa-search"></i> B&R
        </button>
        <button onclick="validateCode()" title="Validar c贸digo">
          <i class="fas fa-check-circle"></i> Validar
        </button>
      </div>
      <div class="tool-group">
        <button onclick="undoChanges()" title="Deshacer">
          <i class="fas fa-undo"></i>
        </button>
        <button onclick="redoChanges()" title="Rehacer">
          <i class="fas fa-redo"></i>
        </button>
        <button onclick="clearAllEditors()" title="Limpiar todo">
          <i class="fas fa-trash"></i> Limpiar
        </button>
      </div>
    </div>
    
    <div class="preview-tools">
      <button id="previewBtn">
        <i class="fa-solid fa-eye"></i> <span id="previewBtnText">Vista Previa</span>
      </button>
      <button id="scanBtn" title="Escanear seguridad">
        <i class="fa-solid fa-shield-virus"></i> Escanear
      </button>
      <button onclick="openAPKGenerator()" title="Generar APK">
        <i class="fas fa-mobile-alt"></i> Generar APK
      </button>
    </div>
  </section>

  <!-- ===== Proyectos ===== -->
    <section id="proyectos" class="section">
      <h2>
        <i class="fas fa-folder" style="margin-right: 12px; color: #1d9bf0;"></i>
        Mis Proyectos
      </h2>
      
      <!-- Skeleton para proyectos -->
      <div class="projects-skeleton" id="projectsSkeleton">
        <div class="projects-skeleton-title"></div>
        <div class="projects-skeleton-container">
          <div class="projects-skeleton-list"></div>
          <div class="projects-skeleton-editor"></div>
        </div>
      </div>
      
      <div class="projects-container" id="projectsContent">
        <div class="project-list">
          <div class="project-list-header">
            <button onclick="createNewProject()" class="new-project-btn">
              <i class="fas fa-plus"></i>
              Nuevo Proyecto
            </button>
            <button onclick="importProject()" class="import-project-btn">
              <i class="fas fa-upload"></i>
              Importar
            </button>
          </div>
          <div id="projectsList"></div>
        </div>

        <div class="project-editor" id="projectEditor" style="display: none;">
          <div class="project-header">
            <input type="text" id="projectName" placeholder="Nombre del proyecto" />
            <div class="project-actions">
              <button onclick="saveProject()" class="save-btn">
                <i class="fas fa-save"></i>
                Guardar
              </button>
              <button onclick="duplicateProject()" class="duplicate-btn" title="Duplicar proyecto">
                <i class="fas fa-copy"></i>
              </button>
              <button onclick="exportProject()" class="export-btn" title="Exportar proyecto">
                <i class="fas fa-download"></i>
              </button>
              <button onclick="toggleFullscreen()" class="fullscreen-btn" title="Pantalla completa">
                <i class="fas fa-expand"></i>
              </button>
              <button onclick="closeProject()" class="close-btn">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>

          <div class="project-editor-container" style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">
            <div class="editor-container" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; padding: 20px; height: 100%; overflow: hidden;">
              <div class="editor-area" data-language="HTML" style="background: #16181c; border: 1px solid #2f3336; border-radius: 12px; overflow: hidden; display: flex; flex-direction: column;">
                <div class="editor-wrapper" style="position: relative; height: 100%; background: #16181c;">
                  <div class="line-numbers" id="htmlLineNumbers" style="width: 45px; padding: 16px 8px; background: #16181c; color: #71767b; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 14px; line-height: 1.5; text-align: right; user-select: none; border-right: 1px solid #2f3336; white-space: pre; position: absolute; top: 0; left: 0; bottom: 0; overflow: hidden;">1</div>
                  <textarea id="htmlEditor" placeholder="Escribe tu c贸digo HTML aqu铆..." spellcheck="false" style="width: 100%; height: 100%; padding: 16px 16px 16px 53px; border: none; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 14px; line-height: 1.5; tab-size: 2; resize: none; background: #16181c; color: #ffffff; white-space: pre; overflow-wrap: normal; overflow-x: auto;"></textarea>
                  <div class="syntax-highlight" id="htmlHighlight" style="position: absolute; left: 53px; top: 16px; right: 0; bottom: 0; padding: 0 16px; pointer-events: none; color: transparent; white-space: pre; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 14px; line-height: 1.5; z-index: -1; background: transparent;"></div>
                </div>
              </div>
              <div class="editor-area" data-language="CSS" style="background: #16181c; border: 1px solid #2f3336; border-radius: 12px; overflow: hidden; display: flex; flex-direction: column;">
                <div class="editor-wrapper" style="position: relative; height: 100%; background: #16181c;">
                  <div class="line-numbers" id="cssLineNumbers" style="width: 45px; padding: 16px 8px; background: #16181c; color: #71767b; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 14px; line-height: 1.5; text-align: right; user-select: none; border-right: 1px solid #2f3336; white-space: pre; position: absolute; top: 0; left: 0; bottom: 0; overflow: hidden;">1</div>
                  <textarea id="cssEditor" placeholder="Escribe tu c贸digo CSS aqu铆..." spellcheck="false" style="width: 100%; height: 100%; padding: 16px 16px 16px 53px; border: none; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 14px; line-height: 1.5; tab-size: 2; resize: none; background: #16181c; color: #ffffff; white-space: pre; overflow-wrap: normal; overflow-x: auto;"></textarea>
                  <div class="syntax-highlight" id="cssHighlight" style="position: absolute; left: 53px; top: 16px; right: 0; bottom: 0; padding: 0 16px; pointer-events: none; color: transparent; white-space: pre; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 14px; line-height: 1.5; z-index: -1; background: transparent;"></div>
                </div>
              </div>
              <div class="editor-area" data-language="javascript" style="background: #16181c; border: 1px solid #2f3336; border-radius: 12px; overflow: hidden; display: flex; flex-direction: column;">
                <div class="editor-wrapper" style="position: relative; height: 100%; background: #16181c;">
                  <div class="line-numbers" id="jsLineNumbers" style="width: 45px; padding: 16px 8px; background: #16181c; color: #71767b; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 14px; line-height: 1.5; text-align: right; user-select: none; border-right: 1px solid #2f3336; white-space: pre; position: absolute; top: 0; left: 0; bottom: 0; overflow: hidden;">1</div>
                  <textarea id="jsEditor" placeholder="Escribe tu c贸digo JavaScript aqu铆..." spellcheck="false" style="width: 100%; height: 100%; padding: 16px 16px 16px 53px; border: none; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 14px; line-height: 1.5; tab-size: 2; resize: none; background: #16181c; color: #ffffff; white-space: pre; overflow-wrap: normal; overflow-x: auto;"></textarea>
                  <div class="syntax-highlight" id="jsHighlight" style="position: absolute; left: 53px; top: 16px; right: 0; bottom: 0; padding: 0 16px; pointer-events: none; color: transparent; white-space: pre; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace; font-size: 14px; line-height: 1.5; z-index: -1; background: transparent;"></div>
                </div>
              </div>
            </div>
          </div>

          <div class="project-tools" style="padding: 20px; background: #000000; border-top: 1px solid #2f3336; flex-shrink: 0;">
            <div class="editor-tools" style="display: flex; gap: 10px; margin-bottom: 15px; justify-content: center; flex-wrap: wrap;">
              <div class="tool-group" style="display: flex; gap: 5px; padding: 5px; background: rgba(47, 51, 54, 0.3); border-radius: 8px;">
                <button onclick="formatAllCode()" title="Formatear todo el c贸digo" style="background: #16181c; border: 1px solid #2f3336; color: #ffffff; padding: 8px 12px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-size: 12px; font-weight: 500;">
                  <i class="fas fa-code"></i> Formatear
                </button>
                <button onclick="findAndReplace()" title="Buscar y reemplazar" style="background: #16181c; border: 1px solid #2f3336; color: #ffffff; padding: 8px 12px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-size: 12px; font-weight: 500;">
                  <i class="fas fa-search"></i> B&R
                </button>
                <button onclick="validateCode()" title="Validar c贸digo" style="background: #16181c; border: 1px solid #2f3336; color: #ffffff; padding: 8px 12px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-size: 12px; font-weight: 500;">
                  <i class="fas fa-check-circle"></i> Validar
                </button>
              </div>
              <div class="tool-group" style="display: flex; gap: 5px; padding: 5px; background: rgba(47, 51, 54, 0.3); border-radius: 8px;">
                <button onclick="undoChanges()" title="Deshacer" style="background: #16181c; border: 1px solid #2f3336; color: #ffffff; padding: 8px 12px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-size: 12px; font-weight: 500;">
                  <i class="fas fa-undo"></i>
                </button>
                <button onclick="redoChanges()" title="Rehacer" style="background: #16181c; border: 1px solid #2f3336; color: #ffffff; padding: 8px 12px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-size: 12px; font-weight: 500;">
                  <i class="fas fa-redo"></i>
                </button>
                <button onclick="clearAllEditors()" title="Limpiar todo" style="background: #16181c; border: 1px solid #2f3336; color: #ffffff; padding: 8px 12px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-size: 12px; font-weight: 500;">
                  <i class="fas fa-trash"></i> Limpiar
                </button>
              </div>
            </div>
            
            <div class="preview-tools" style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
              <button id="previewBtnProject" style="background: #1d9bf0; border: none; color: white; padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                <i class="fa-solid fa-eye"></i> <span id="previewBtnTextProject">Vista Previa</span>
              </button>
              <button id="scanBtnProject" title="Escanear seguridad" style="background: #1d9bf0; border: none; color: white; padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                <i class="fa-solid fa-shield-virus"></i> Escanear
              </button>
              <button onclick="shareProject()" title="Compartir proyecto" style="background: #1d9bf0; border: none; color: white; padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-share"></i> Compartir
              </button>
              <button onclick="showProjectSettings()" title="Configuraciones del proyecto" style="background: #1d9bf0; border: none; color: white; padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-cog"></i> Config
              </button>
            </div>
          </div>

          <div id="scanAnimation" class="scan-animation">
            <div class="scan-line"></div>
            <div class="scan-results"></div>
          </div>
        </div>
      </div>
    </section>

  <!-- ===== Vista Previa ===== -->
  <div id="previewOverlay" class="preview-overlay">
    <div class="preview-header">
      <h2 id="previewHeaderText">Vista Previa</h2>
      <div class="preview-tools">
        <button id="zoomInBtn" title="Acercar"><i class="fa-solid fa-magnifying-glass-plus"></i></button>
        <button id="zoomOutBtn" title="Alejar"><i class="fa-solid fa-magnifying-glass-minus"></i></button>
        <button id="scanBtn" title="Escanear seguridad"><i class="fa-solid fa-shield-virus"></i></button>
      </div>
      <button id="closePreview"><i class="fa-solid fa-times"></i></button>
    </div>
    <div id="scanAnimation" class="scan-animation">
      <div class="scan-line"></div>
      <div class="scan-results"></div>
    </div>
    <iframe id="previewFrame"></iframe>
  </div>

  <!-- ===== Overlay de B煤squeda (Estilo Twitter/X Moderno) ===== -->
  <div id="searchOverlay">
    <div class="search-top-bar">
      <i class="fa-solid fa-arrow-left" id="closeSearchOverlay"></i>
      <div class="search-input-container">
        <i class="fa-solid fa-magnifying-glass search-icon"></i>
        <input type="text" id="searchInput" placeholder="Buscar en Clack..." />
        <i class="fa-solid fa-xmark clear-search" id="clearSearch" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: #71767b; cursor: pointer; display: none; font-size: 16px; padding: 4px; border-radius: 50%; transition: all 0.2s ease;"></i>
      </div>
      <button id="searchExecuteBtn">Buscar</button>
    </div>
    
    <div class="search-main-content">
      <div class="search-toggle">
        <button class="active" id="toggleArticles">Art铆culos</button>
      </div>
      
      <div class="recent-searches">
        <h3>B煤squedas recientes</h3>
        <ul id="recentList"></ul>
      </div>
      
      <div id="searchSpinner" class="search-spinner" style="display:none;"></div>
      <div id="searchResults" class="search-results"></div>
    </div>
  </div>

  <!-- ===== Overlay de Art铆culo Completo (Estilo Twitter) ===== -->
  <div id="articleOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000000; z-index: 16000; overflow-y: auto;">
    <div class="article-container" style="max-width: 600px; margin: 0 auto; background: #000000; min-height: 100vh; position: relative;">
      <!-- Header del art铆culo -->
      <div class="article-header" style="position: sticky; top: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); border-bottom: 1px solid #2f3336; padding: 15px 20px; display: flex; align-items: center; gap: 15px; z-index: 100;">
        <button id="closeArticle" style="background: none; border: none; color: #1d9bf0; font-size: 20px; cursor: pointer; padding: 8px; border-radius: 50%; transition: all 0.2s ease;">
          <i class="fas fa-arrow-left"></i>
        </button>
        <h2 style="color: #ffffff; font-size: 18px; font-weight: 700; margin: 0; flex: 1;">Art铆culo</h2>
      </div>
      
      <!-- Contenido del art铆culo -->
      <div class="article-content" style="padding: 20px; color: #ffffff; line-height: 1.6;">
        <div class="article-meta" style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #2f3336;">
          <div class="author-avatar" style="width: 40px; height: 40px; background: linear-gradient(45deg, #1d9bf0, #1a8cd8); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 16px;">
            W
          </div>
          <div class="author-info">
            <div style="color: #ffffff; font-weight: 600; font-size: 15px; display: flex; align-items: center; gap: 8px;">
              Wikipedia
              <i class="fas fa-check-circle" style="color: #1d9bf0; font-size: 16px;" title="Cuenta verificada"></i>
            </div>
            <div style="color: #71767b; font-size: 14px;">Art铆culo verificado  <span id="articleDate"></span></div>
          </div>
          <button id="followAuthor" style="background: #1d9bf0; color: white; border: none; padding: 6px 16px; border-radius: 20px; font-weight: 600; font-size: 14px; cursor: pointer; margin-left: auto; transition: all 0.2s ease;">
            Seguir
          </button>
        </div>
        
        <h1 id="articleTitle" style="color: #ffffff; font-size: 28px; font-weight: 800; margin-bottom: 20px; line-height: 1.3;"></h1>
        
        <div id="articleBody" style="font-size: 16px; line-height: 1.7; color: #e7e9ea;">
          <!-- Contenido del art铆culo se carga aqu铆 -->
        </div>
        
        <!-- Acciones del art铆culo -->
        <div class="article-actions" style="display: flex; align-items: center; justify-content: center; padding: 20px 0; margin-top: 30px; border-top: 1px solid #2f3336;">
          <button class="action-btn" id="reportArticle" style="background: linear-gradient(45deg, #f91880, #e0166a); border: none; color: white; cursor: pointer; display: flex; align-items: center; gap: 8px; padding: 12px 24px; border-radius: 25px; transition: all 0.3s ease; font-size: 15px; font-weight: 600; box-shadow: 0 4px 15px rgba(249, 24, 128, 0.3);">
            <i class="fas fa-flag"></i>
            <span>Reportar Art铆culo</span>
          </button>
        </div>
        
        <!-- Art铆culos relacionados -->
        <div class="related-articles" style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #2f3336;">
          <h3 style="color: #ffffff; font-size: 20px; font-weight: 700; margin-bottom: 20px;">Art铆culos relacionados</h3>
          <div id="relatedArticlesList" style="display: flex; flex-direction: column; gap: 15px;">
            <!-- Se llenan din谩micamente -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== Modal Generador de APK ===== -->
  <div id="apkGeneratorModal" style="display: none; position: fixed; z-index: 12000; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); overflow-y: auto;">
    <div class="apk-generator-container" style="max-width: 800px; margin: 0 auto; background: #000000; min-height: 100vh; position: relative; color: #ffffff;">
      <!-- Header del generador -->
      <div class="apk-header" style="position: sticky; top: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); border-bottom: 1px solid #2f3336; padding: 15px 20px; display: flex; align-items: center; gap: 15px; z-index: 100;">
        <button id="closeAPKGenerator" style="background: none; border: none; color: #1d9bf0; font-size: 20px; cursor: pointer; padding: 8px; border-radius: 50%; transition: all 0.2s ease;">
          <i class="fas fa-arrow-left"></i>
        </button>
        <h2 style="color: #ffffff; font-size: 18px; font-weight: 700; margin: 0; flex: 1;">Generar APK</h2>
      </div>
      
      <!-- Contenido del generador -->
      <div class="apk-content" style="padding: 20px;">
        <!-- Informaci贸n de la app -->
        <div class="app-info-section" style="background: #16181c; border: 1px solid #2f3336; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
          <h3 style="color: #ffffff; font-size: 18px; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-info-circle" style="color: #1d9bf0;"></i>
            Informaci贸n de la Aplicaci贸n
          </h3>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
            <div>
              <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Nombre de la App:</label>
              <input type="text" id="appName" value="ClackKoder" style="width: 100%; padding: 10px; border: 1px solid #2f3336; border-radius: 6px; background: #000000; color: #ffffff; font-size: 14px;">
            </div>
            
            <div>
              <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Package Name:</label>
              <input type="text" id="packageName" value="com.clackkoder.app" readonly style="width: 100%; padding: 10px; border: 1px solid #2f3336; border-radius: 6px; background: #16181c; color: #71767b; font-size: 14px;">
            </div>
            
            <div>
              <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Versi贸n:</label>
              <input type="text" id="appVersion" value="1.0.0" style="width: 100%; padding: 10px; border: 1px solid #2f3336; border-radius: 6px; background: #000000; color: #ffffff; font-size: 14px;">
            </div>
            
            <div>
              <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Descripci贸n:</label>
              <input type="text" id="appDescription" value="Editor de c贸digo profesional" style="width: 100%; padding: 10px; border: 1px solid #2f3336; border-radius: 6px; background: #000000; color: #ffffff; font-size: 14px;">
            </div>
          </div>
        </div>
        
        <!-- Opciones de generaci贸n -->
        <div class="generation-options" style="background: #16181c; border: 1px solid #2f3336; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
          <h3 style="color: #ffffff; font-size: 18px; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-cogs" style="color: #28a745;"></i>
            Herramientas de Generaci贸n Real
          </h3>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <div class="generation-tool" style="border: 2px solid #2f3336; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.3s ease; text-align: center;" onclick="startRealAPKGeneration('pwabuilder')">
              <div style="font-size: 30px; margin-bottom: 10px;"></div>
              <h4 style="color: #ffffff; margin-bottom: 5px;">PWA Builder</h4>
              <p style="color: #71767b; font-size: 12px; margin: 0;">Microsoft PWA Builder Real</p>
              <div style="margin-top: 8px; padding: 4px 8px; background: rgba(40, 167, 69, 0.2); color: #28a745; border-radius: 12px; font-size: 10px; font-weight: 600;"> REAL</div>
            </div>
            
            <div class="generation-tool" style="border: 2px solid #2f3336; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.3s ease; text-align: center;" onclick="startRealAPKGeneration('capacitor')">
              <div style="font-size: 30px; margin-bottom: 10px;"></div>
              <h4 style="color: #ffffff; margin-bottom: 5px;">Capacitor</h4>
              <p style="color: #71767b; font-size: 12px; margin: 0;">Ionic Capacitor Real</p>
              <div style="margin-top: 8px; padding: 4px 8px; background: rgba(40, 167, 69, 0.2); color: #28a745; border-radius: 12px; font-size: 10px; font-weight: 600;"> REAL</div>
            </div>
            
            <div class="generation-tool" style="border: 2px solid #2f3336; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.3s ease; text-align: center;" onclick="startRealAPKGeneration('cordova')">
              <div style="font-size: 30px; margin-bottom: 10px;"></div>
              <h4 style="color: #ffffff; margin-bottom: 5px;">Cordova</h4>
              <p style="color: #71767b; font-size: 12px; margin: 0;">Apache Cordova Real</p>
              <div style="margin-top: 8px; padding: 4px 8px; background: rgba(40, 167, 69, 0.2); color: #28a745; border-radius: 12px; font-size: 10px; font-weight: 600;"> REAL</div>
            </div>
            
            <div class="generation-tool" style="border: 2px solid #2f3336; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.3s ease; text-align: center;" onclick="startRealAPKGeneration('bubblewrap')">
              <div style="font-size: 30px; margin-bottom: 10px;"></div>
              <h4 style="color: #ffffff; margin-bottom: 5px;">Bubblewrap</h4>
              <p style="color: #71767b; font-size: 12px; margin: 0;">Google Bubblewrap Real</p>
              <div style="margin-top: 8px; padding: 4px 8px; background: rgba(40, 167, 69, 0.2); color: #28a745; border-radius: 12px; font-size: 10px; font-weight: 600;"> REAL</div>
            </div>
          </div>
        </div>
        
        <!-- Progreso de generaci贸n -->
        <div id="apkProgress" style="display: none; background: #16181c; border: 1px solid #2f3336; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
          <h3 style="color: #ffffff; font-size: 18px; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-spinner fa-spin" style="color: #1d9bf0;"></i>
            Generando APK
          </h3>
          
          <div style="margin-bottom: 10px;">
            <div style="background: #2f3336; height: 8px; border-radius: 4px; overflow: hidden;">
              <div id="progressBar" style="background: linear-gradient(45deg, #1d9bf0, #28a745); height: 100%; width: 0%; transition: width 0.3s ease; border-radius: 4px;"></div>
            </div>
          </div>
          
          <p id="progressText" style="color: #71767b; font-size: 14px; margin: 0;">Iniciando proceso...</p>
        </div>
        
        <!-- Descargas -->
        <div id="downloadSection" style="display: none; background: #16181c; border: 1px solid #2f3336; border-radius: 12px; padding: 20px;">
          <h3 style="color: #ffffff; font-size: 18px; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-download" style="color: #28a745;"></i>
            Descargas Disponibles
          </h3>
          
          <div id="downloadContainer" style="display: flex; flex-direction: column; gap: 15px;">
            <!-- Los links de descarga se generan din谩micamente -->
          </div>
        </div>
        
        <!-- Bot贸n principal -->
        <div style="text-align: center; margin-top: 30px;">
          <button onclick="startRealAPKGeneration()" style="background: linear-gradient(45deg, #1d9bf0, #28a745); color: white; border: none; padding: 15px 40px; border-radius: 25px; cursor: pointer; font-weight: 700; font-size: 16px; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(29, 155, 240, 0.3); display: flex; align-items: center; gap: 10px; margin: 0 auto;">
            <i class="fas fa-rocket"></i>
            Generar APKs Reales con Todas las Herramientas
          </button>
          
          <div style="margin-top: 15px; padding: 10px 20px; background: rgba(40, 167, 69, 0.1); border: 1px solid #28a745; border-radius: 12px; font-size: 14px; color: #28a745;">
            <i class="fas fa-check-circle"></i>
            <strong>Sistema Real Activado:</strong> Genera APKs funcionales e instalables
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== Modal de Reporte de Problemas Expandido ===== -->
  <div id="reportProblemModal" style="display: none; position: fixed; z-index: 17000; top: 0; left: 0; width: 100%; height: 100%; background: #000000; overflow-y: auto; padding: 0;">
    <div class="report-container" style="max-width: 600px; margin: 0 auto; background: #000000; min-height: 100vh; position: relative; color: #ffffff;">
      <!-- Header del reporte -->
      <div class="report-header" style="position: sticky; top: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); border-bottom: 1px solid #2f3336; padding: 15px 20px; display: flex; align-items: center; gap: 15px; z-index: 100;">
        <button id="closeReportProblemModal" style="background: none; border: none; color: #1d9bf0; font-size: 20px; cursor: pointer; padding: 8px; border-radius: 50%; transition: all 0.2s ease;">
          <i class="fas fa-arrow-left"></i>
        </button>
        <h2 style="color: #ffffff; font-size: 18px; font-weight: 700; margin: 0; flex: 1;">Reportar un problema</h2>
        <div style="color: #71767b; font-size: 14px;" id="reportProgressIndicator">1/3</div>
      </div>
      
      <!-- Contenido del reporte -->
      <div class="report-content" style="padding: 20px;">
        <!-- Paso 1: Descripci贸n del problema -->
        <div class="report-step" id="reportStep1" style="display: block;">
          <div style="text-align: center; margin-bottom: 30px;">
            <div style="width: 80px; height: 80px; background: linear-gradient(45deg, #dc3545, #c82333); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 36px;">
              
            </div>
            <h3 style="color: #ffffff; font-size: 20px; margin-bottom: 8px;">驴Qu茅 problema encontraste?</h3>
            <p style="color: #71767b; font-size: 14px; line-height: 1.4;">Cu茅ntanos en detalle lo que est谩 funcionando mal para que podamos ayudarte mejor.</p>
          </div>
          
          <div style="margin-bottom: 25px;">
            <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Descripci贸n del problema <span style="color: #dc3545;">*</span></label>
            <div style="position: relative;">
              <textarea id="problemDescription" placeholder="Describe el problema que encontraste..." style="width: 100%; min-height: 120px; padding: 15px; border: 2px solid #2f3336; border-radius: 12px; background: #16181c; color: #ffffff; font-size: 15px; font-family: inherit; box-sizing: border-box; resize: vertical; transition: border-color 0.3s ease;" maxlength="200"></textarea>
              <div style="position: absolute; bottom: 10px; right: 15px; color: #71767b; font-size: 12px; font-weight: 500;">
                <span id="characterCount">0</span>/200
              </div>
            </div>
          </div>
          
          <div style="margin-bottom: 25px;">
            <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #e7e9ea; font-size: 14px;">Tipo de problema</label>
            <select id="problemType" style="width: 100%; padding: 15px; border: 2px solid #2f3336; border-radius: 12px; background: #16181c; color: #ffffff; font-size: 15px; box-sizing: border-box; cursor: pointer;">
              <option value="">Selecciona el tipo de problema</option>
              <option value="bug"> Error o fallo en la aplicaci贸n</option>
              <option value="performance"> Problema de rendimiento</option>
              <option value="ui"> Problema de interfaz</option>
              <option value="feature"> Funcionalidad no funciona</option>
              <option value="data"> P茅rdida de datos</option>
              <option value="login"> Problema de inicio de sesi贸n</option>
              <option value="other"> Otro problema</option>
            </select>
          </div>
          
          <button id="nextToImages" style="background: linear-gradient(45deg, #1d9bf0, #1a8cd8); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: 700; font-size: 16px; width: 100%; transition: all 0.3s ease; opacity: 0.5; pointer-events: none;">
            Continuar
          </button>
        </div>
        
        <!-- Paso 2: Subir im谩genes -->
        <div class="report-step" id="reportStep2" style="display: none;">
          <div style="text-align: center; margin-bottom: 30px;">
            <div style="width: 80px; height: 80px; background: linear-gradient(45deg, #1d9bf0, #1a8cd8); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 36px;">
              
            </div>
            <h3 style="color: #ffffff; font-size: 20px; margin-bottom: 8px;">Adjunta evidencia</h3>
            <p style="color: #71767b; font-size: 14px; line-height: 1.4;">Sube hasta 3 im谩genes que muestren el problema (opcional).</p>
          </div>
          
          <div style="margin-bottom: 30px;">
            <div id="imageUploadArea" style="border: 2px dashed #2f3336; border-radius: 12px; padding: 40px 20px; text-align: center; cursor: pointer; transition: all 0.3s ease; background: #16181c;" onclick="document.getElementById('imageInput').click()">
              <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: #71767b; margin-bottom: 15px;"></i>
              <div style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 5px;">Haz clic para subir im谩genes</div>
              <div style="color: #71767b; font-size: 14px;">O arrastra y suelta aqu铆</div>
              <div style="color: #71767b; font-size: 12px; margin-top: 10px;">M谩ximo 3 im谩genes  PNG, JPG  M谩x 5MB cada una</div>
            </div>
            <input type="file" id="imageInput" accept="image/*" multiple style="display: none;" />
            
            <div id="imagePreviewContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
              <!-- Las im谩genes se mostrar谩n aqu铆 -->
            </div>
          </div>
          
          <div style="display: flex; gap: 15px;">
            <button id="backToDescription" style="background: none; border: 2px solid #2f3336; color: #e7e9ea; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; font-size: 16px; flex: 1; transition: all 0.3s ease;">
              Atr谩s
            </button>
            <button id="nextToReview" style="background: linear-gradient(45deg, #1d9bf0, #1a8cd8); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: 700; font-size: 16px; flex: 2; transition: all 0.3s ease;">
              Continuar
            </button>
          </div>
        </div>
        
        <!-- Paso 3: Revisi贸n y env铆o -->
        <div class="report-step" id="reportStep3" style="display: none;">
          <div style="text-align: center; margin-bottom: 30px;">
            <div style="width: 80px; height: 80px; background: linear-gradient(45deg, #28a745, #20c997); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 36px;">
              
            </div>
            <h3 style="color: #ffffff; font-size: 20px; margin-bottom: 8px;">Revisar y enviar</h3>
            <p style="color: #71767b; font-size: 14px; line-height: 1.4;">Revisa la informaci贸n antes de enviar tu reporte.</p>
          </div>
          
          <div style="background: #16181c; border-radius: 12px; padding: 20px; margin-bottom: 30px; border: 1px solid #2f3336;">
            <div style="margin-bottom: 20px;">
              <div style="color: #71767b; font-size: 12px; font-weight: 600; text-transform: uppercase; margin-bottom: 5px;">Descripci贸n</div>
              <div id="reviewDescription" style="color: #ffffff; font-size: 15px; line-height: 1.4;"></div>
            </div>
            
            <div style="margin-bottom: 20px;">
              <div style="color: #71767b; font-size: 12px; font-weight: 600; text-transform: uppercase; margin-bottom: 5px;">Tipo de problema</div>
              <div id="reviewType" style="color: #ffffff; font-size: 15px;"></div>
            </div>
            
            <div id="reviewImagesSection" style="display: none;">
              <div style="color: #71767b; font-size: 12px; font-weight: 600; text-transform: uppercase; margin-bottom: 10px;">Im谩genes adjuntas</div>
              <div id="reviewImages" style="display: flex; gap: 10px; flex-wrap: wrap;"></div>
            </div>
          </div>
          
          <div style="display: flex; gap: 15px;">
            <button id="backToImages" style="background: none; border: 2px solid #2f3336; color: #e7e9ea; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; font-size: 16px; flex: 1; transition: all 0.3s ease;">
              Atr谩s
            </button>
            <button id="submitProblemReport" style="background: linear-gradient(45deg, #28a745, #20c997); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: 700; font-size: 16px; flex: 2; transition: all 0.3s ease;">
              <i class="fas fa-paper-plane" style="margin-right: 8px;"></i>
              Enviar reporte
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ===== Overlay de Reporte Enviado ===== -->
  <div id="reportSentOverlay" style="display: none; position: fixed; z-index: 18000; top: 0; left: 0; width: 100%; height: 100%; background: #000000; justify-content: center; align-items: center;">
    <div style="text-align: center; padding: 40px;">
      <div id="reportSentAnimation" style="width: 120px; height: 120px; margin: 0 auto 30px; position: relative;">
        <div style="width: 120px; height: 120px; border: 4px solid #28a745; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: rgba(40, 167, 69, 0.1); animation: reportSuccessPulse 2s infinite;">
          <i class="fas fa-check" style="font-size: 48px; color: #28a745; animation: reportSuccessCheck 0.8s ease 0.5s both;"></i>
        </div>
        <div style="position: absolute; top: -10px; left: -10px; width: 140px; height: 140px; border: 2px solid rgba(40, 167, 69, 0.3); border-radius: 50%; animation: reportSuccessRing 1.5s ease-out infinite;"></div>
      </div>
      
      <h2 style="color: #ffffff; font-size: 24px; font-weight: 700; margin-bottom: 15px;">隆Reporte enviado!</h2>
      <p style="color: #71767b; font-size: 16px; line-height: 1.5; max-width: 400px; margin: 0 auto 30px;">
        Gracias por ayudarnos a mejorar. Hemos recibido tu reporte y nuestro equipo lo revisar谩 pronto.
      </p>
      
      <div style="background: #16181c; border-radius: 12px; padding: 20px; margin: 30px auto; max-width: 300px; border: 1px solid #2f3336;">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
          <i class="fas fa-ticket-alt" style="color: #1d9bf0; font-size: 20px;"></i>
          <div>
            <div style="color: #71767b; font-size: 12px;">ID de reporte</div>
            <div style="color: #ffffff; font-weight: 600;" id="reportId">#REP-0000</div>
          </div>
        </div>
        <div style="color: #71767b; font-size: 12px;">Tiempo estimado de respuesta: 24-48 horas</div>
      </div>
      
      <button id="closeReportSent" style="background: linear-gradient(45deg, #1d9bf0, #1a8cd8); color: white; border: none; padding: 15px 40px; border-radius: 25px; cursor: pointer; font-weight: 700; font-size: 16px; transition: all 0.3s ease;">
        Continuar
      </button>
    </div>
  </div>

  <!-- ===== Modal de Reporte de Art铆culo Moderno ===== -->
  <div id="reportArticleModal" style="display: none; position: fixed; z-index: 17000; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%); overflow-y: auto;">
    <div class="report-modal-container" style="min-height: 100vh; display: flex; flex-direction: column;">
      
      <!-- Header moderno -->
      <div class="report-header" style="background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); border-bottom: 1px solid #2f3336; padding: 20px; display: flex; align-items: center; gap: 20px; position: sticky; top: 0; z-index: 100;">
        <button id="closeReportModal" style="background: rgba(255,255,255,0.1); border: none; color: #ffffff; font-size: 18px; cursor: pointer; padding: 12px; border-radius: 50%; width: 48px; height: 48px; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;">
          <i class="fas fa-times"></i>
        </button>
        <div style="flex: 1;">
          <h2 style="color: #ffffff; font-size: 24px; font-weight: 800; margin: 0; letter-spacing: -0.5px;">Reportar Contenido</h2>
          <p style="color: #71767b; font-size: 14px; margin: 4px 0 0 0;">Ay煤danos a mantener la comunidad segura</p>
        </div>
        <div style="background: linear-gradient(45deg, #f91880, #e0166a); padding: 8px 16px; border-radius: 20px; font-size: 12px; font-weight: 700; color: white; text-transform: uppercase; letter-spacing: 0.5px;">
          Prioritario
        </div>
      </div>

      <!-- Contenido principal -->
      <div style="flex: 1; padding: 40px 20px; max-width: 800px; margin: 0 auto; width: 100%;">
        
        <!-- Informaci贸n del art铆culo -->
        <div style="background: linear-gradient(145deg, #16181c, #1e2328); border: 1px solid #2f3336; border-radius: 20px; padding: 30px; margin-bottom: 30px; position: relative; overflow: hidden;">
          <div style="position: absolute; top: -50%; right: -50%; width: 200px; height: 200px; background: radial-gradient(circle, rgba(249, 24, 128, 0.1) 0%, transparent 70%); pointer-events: none;"></div>
          <div style="position: relative; z-index: 1;">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
              <div style="width: 60px; height: 60px; background: linear-gradient(45deg, #f91880, #e0166a); border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 24px;">
                
              </div>
              <div>
                <h3 style="color: #ffffff; font-size: 18px; font-weight: 700; margin: 0;">Art铆culo Seleccionado</h3>
                <p style="color: #71767b; font-size: 14px; margin: 4px 0 0 0;" id="reportArticleTitle">T铆tulo del art铆culo aparecer谩 aqu铆</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Formulario de reporte -->
        <div style="background: linear-gradient(145deg, #16181c, #1e2328); border: 1px solid #2f3336; border-radius: 20px; padding: 30px; margin-bottom: 30px;">
          
          <!-- Selecci贸n de motivo -->
          <div style="margin-bottom: 30px;">
            <label style="display: block; margin-bottom: 15px; font-weight: 700; color: #ffffff; font-size: 16px;">驴Cu谩l es el problema con este contenido?</label>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
              
              <div class="report-reason-option" data-value="spam" style="background: #000000; border: 2px solid #2f3336; border-radius: 15px; padding: 20px; cursor: pointer; transition: all 0.3s ease; position: relative;">
                <div style="display: flex; align-items: center; gap: 15px;">
                  <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #ff6b35, #f7931e); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                    
                  </div>
                  <div>
                    <h4 style="color: #ffffff; font-size: 15px; font-weight: 600; margin: 0 0 4px 0;">Spam o repetitivo</h4>
                    <p style="color: #71767b; font-size: 13px; margin: 0; line-height: 1.4;">Contenido duplicado o no deseado</p>
                  </div>
                </div>
              </div>

              <div class="report-reason-option" data-value="misinformation" style="background: #000000; border: 2px solid #2f3336; border-radius: 15px; padding: 20px; cursor: pointer; transition: all 0.3s ease; position: relative;">
                <div style="display: flex; align-items: center; gap: 15px;">
                  <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #e74c3c, #c0392b); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                    锔
                  </div>
                  <div>
                    <h4 style="color: #ffffff; font-size: 15px; font-weight: 600; margin: 0 0 4px 0;">Informaci贸n incorrecta</h4>
                    <p style="color: #71767b; font-size: 13px; margin: 0; line-height: 1.4;">Datos falsos o enga帽osos</p>
                  </div>
                </div>
              </div>

              <div class="report-reason-option" data-value="inappropriate" style="background: #000000; border: 2px solid #2f3336; border-radius: 15px; padding: 20px; cursor: pointer; transition: all 0.3s ease; position: relative;">
                <div style="display: flex; align-items: center; gap: 15px;">
                  <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #9b59b6, #8e44ad); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                    
                  </div>
                  <div>
                    <h4 style="color: #ffffff; font-size: 15px; font-weight: 600; margin: 0 0 4px 0;">Contenido inapropiado</h4>
                    <p style="color: #71767b; font-size: 13px; margin: 0; line-height: 1.4;">Ofensivo o inadecuado</p>
                  </div>
                </div>
              </div>

              <div class="report-reason-option" data-value="copyright" style="background: #000000; border: 2px solid #2f3336; border-radius: 15px; padding: 20px; cursor: pointer; transition: all 0.3s ease; position: relative;">
                <div style="display: flex; align-items: center; gap: 15px;">
                  <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #1abc9c, #16a085); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                    
                  </div>
                  <div>
                    <h4 style="color: #ffffff; font-size: 15px; font-weight: 600; margin: 0 0 4px 0;">Derechos de autor</h4>
                    <p style="color: #71767b; font-size: 13px; margin: 0; line-height: 1.4;">Uso no autorizado de contenido</p>
                  </div>
                </div>
              </div>

              <div class="report-reason-option" data-value="other" style="background: #000000; border: 2px solid #2f3336; border-radius: 15px; padding: 20px; cursor: pointer; transition: all 0.3s ease; position: relative;">
                <div style="display: flex; align-items: center; gap: 15px;">
                  <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #34495e, #2c3e50); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                    
                  </div>
                  <div>
                    <h4 style="color: #ffffff; font-size: 15px; font-weight: 600; margin: 0 0 4px 0;">Otro motivo</h4>
                    <p style="color: #71767b; font-size: 13px; margin: 0; line-height: 1.4;">Especifica en los detalles</p>
                  </div>
                </div>
              </div>

            </div>
          </div>

          <!-- Detalles adicionales -->
          <div style="margin-bottom: 30px;">
            <label style="display: block; margin-bottom: 15px; font-weight: 700; color: #ffffff; font-size: 16px;">Detalles adicionales (opcional)</label>
            <div style="position: relative;">
              <textarea id="reportDetails" placeholder="Proporciona m谩s informaci贸n sobre el problema. Esto nos ayudar谩 a revisar tu reporte m谩s r谩pidamente..." style="width: 100%; min-height: 120px; padding: 20px; resize: vertical; border: 2px solid #2f3336; border-radius: 15px; background: #000000; color: #ffffff; font-size: 15px; font-family: inherit; box-sizing: border-box; line-height: 1.6; transition: border-color 0.3s ease;" maxlength="500"></textarea>
              <div style="position: absolute; bottom: 15px; right: 20px; color: #71767b; font-size: 12px; font-weight: 500;">
                <span id="reportCharCount">0</span>/500
              </div>
            </div>
          </div>

        </div>

        <!-- Informaci贸n adicional -->
        <div style="background: rgba(29, 155, 240, 0.1); border: 1px solid rgba(29, 155, 240, 0.3); border-radius: 15px; padding: 20px; margin-bottom: 30px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
            <i class="fas fa-info-circle" style="color: #1d9bf0; font-size: 18px;"></i>
            <span style="color: #ffffff; font-weight: 600; font-size: 15px;">Informaci贸n importante</span>
          </div>
          <ul style="color: #e7e9ea; font-size: 14px; line-height: 1.6; margin: 0; padding-left: 20px;">
            <li>Tu reporte ser谩 revisado por nuestro equipo de moderaci贸n</li>
            <li>Los reportes falsos pueden resultar en restricciones de cuenta</li>
            <li>Recibir谩s una notificaci贸n sobre el estado de tu reporte</li>
          </ul>
        </div>

      </div>

      <!-- Footer con acciones -->
      <div style="background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); border-top: 1px solid #2f3336; padding: 20px; position: sticky; bottom: 0;">
        <div style="max-width: 800px; margin: 0 auto; display: flex; gap: 15px; justify-content: center;">
          <button id="cancelReport" style="background: rgba(255,255,255,0.1); border: 2px solid #2f3336; color: #e7e9ea; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; font-size: 15px; min-width: 140px;">
            Cancelar
          </button>
          <button id="submitArticleReport" style="background: linear-gradient(45deg, #f91880, #e0166a); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: 700; transition: all 0.3s ease; font-size: 15px; min-width: 180px; box-shadow: 0 4px 15px rgba(249, 24, 128, 0.3); opacity: 0.5; pointer-events: none;">
            <i class="fas fa-paper-plane" style="margin-right: 8px;"></i>
            Enviar Reporte
          </button>
        </div>
      </div>

    </div>
  </div>

  <!-- ===== Script Principal ===== -->
  <!-- Offline Message -->
  <div id="offlineMessage" style="display: none; position: fixed; bottom: 20px; left: 20px; background: #ff4444; color: white; padding: 10px 20px; border-radius: 5px; z-index: 9999;">
    Est谩s trabajando sin conexi贸n
  </div>

  <script src="app-generator.js"></script>

  <script>
    // Service Worker registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('ServiceWorker registered:', registration);
          })
          .catch(error => {
            console.log('ServiceWorker registration failed:', error);
          });
      });
    }

    // Check online/offline status
    window.addEventListener('online', () => {
      document.getElementById('offlineMessage').style.display = 'none';
    });

    window.addEventListener('offline', () => {
      document.getElementById('offlineMessage').style.display = 'block';
    });

    /*************************************************
     *       CONFIGURACIN DE CLAVES API
     *************************************************/
    const YOUTUBE_API_KEY = "AIzaSyDUzRmn9mQ4RL5EwzgExD3CfIzULos76NQ";
    const HUGGINGFACE_API_KEY = "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";
    
    // Configuraci贸n de idiomas del chat
    let currentChatLang = 'es';
    const chatLanguages = {
      'es': { name: 'Espa帽ol', flag: '', code: 'es' },
      'en': { name: 'English', flag: '吼', code: 'en' },
      'pt': { name: 'Portugu锚s', flag: 'ю', code: 'pt' },
      'ko': { name: '甑', flag: '梆', code: 'ko' },
      'vi': { name: 'Ti岷ng Vi峄t', flag: '火', code: 'vi' }
    };

    // Variables para el lector de art铆culos
    let speechSynthesis = window.speechSynthesis;
    let currentUtterance = null;
    let isReading = false;
    let availableVoices = [];
    let isTranslating = false;

    // Si no existe un idioma guardado, se usa "es"
    if (!localStorage.getItem('currentLang')) {
      localStorage.setItem('currentLang', 'es');
    }
    let currentLang = localStorage.getItem('currentLang');

    const defaultTranslations = {
      modalTitle: "Registro / Inicia sesi贸n con GitHub",
      modalDescription: "Inicia sesi贸n como invitado.",
      loginButton: "Iniciar sesi贸n con GitHub como invitado",
      previewButton: "Vista Previa",
      htmlPlaceholder: "HTML...",
      cssPlaceholder: "CSS...",
      jsPlaceholder: "JavaScript...",
      previewHeader: "Vista Previa",
      welcomeMessage: "隆Bienvenido a la aplicaci贸n! Disfruta del software implementando tus conocimientos de Programaci贸n!",
      analyzing: "Analizando...",
      noErrorsFound: "HTML る臧 氚瓴歆 惦!",
      commonErrorsFound: "氚瓴 茧 る:",
      searchButton: "瓴",
      searchNoResults: "No se encontraron videos o art铆culos.",
      like: "Like",
      close: "Cerrar"
    };

    const translations = {
      es: { ...defaultTranslations },
      en: { ...defaultTranslations },
      ja: { ...defaultTranslations },
      ko: { ...defaultTranslations },      vi: { ...defaultTranslations },
      zh: { ...defaultTranslations }
    };

    function getTranslation(key) {
      return translations[currentLang] && translations[currentLang][key] !== undefined 
             ? translations[currentLang][key] 
             : translations["es"][key];
    }

    function updateLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('currentLang', lang);
      
      // Mostrar skeleton de p谩gina completa
      showPageSkeleton(lang);
      
      // Simular proceso de traducci贸n
      setTimeout(() => {
        const t = translations[currentLang] || translations["es"];
        
        // Actualizar todos los textos de la interfaz
        updateAllTexts(t);
        
        // Traducir TODOS los elementos din谩micos
        translateAllDynamicContent(lang);
        
        // Ocultar skeleton despu茅s de "traducir"
        setTimeout(() => {
          hidePageSkeleton();
          document.getElementById('settingsOverlay').style.display = 'none';
        }, 1500);
      }, 800);
    }

    // Nueva funci贸n para traducir TODO el contenido din谩mico
    function translateAllDynamicContent(lang) {
      // Traducir p谩gina de mantenimiento
      translateMaintenancePage(lang);
      
      // Traducir textos de proyectos
      translateProjectsSection(lang);
      
      // Traducir textos de b煤squeda  
      translateSearchSection(lang);
      
      // Traducir textos de ajustes
      translateSettingsSection(lang);
      
      // Traducir textos del asistente (aunque est茅 bloqueado)
      translateAssistantSection(lang);
      
      // Traducir placeholders y labels
      translateInputsAndLabels(lang);
      
      // Traducir tooltips y t铆tulos
      translateTooltipsAndTitles(lang);
    }

    function translateMaintenancePage(lang) {
      const maintenanceTexts = {
        'es': {
          notAvailable: 'Editor no disponible',
          description: 'El editor est谩 temporalmente fuera de servicio para mantenimiento.',
          working: 'Trabajando en mejoras', 
          message: 'Estamos actualizando el editor principal para ofrecerte una mejor experiencia. Mientras tanto, puedes usar la secci贸n de Proyectos.',
          goToProjects: 'Ir a Proyectos',
          status: 'Estado: En mantenimiento'
        },
        'en': {
          notAvailable: 'Editor not available',
          description: 'The editor is temporarily out of service for maintenance.',
          working: 'Working on improvements',
          message: 'We are updating the main editor to offer you a better experience. Meanwhile, you can use the Projects section.',
          goToProjects: 'Go to Projects', 
          status: 'Status: Under maintenance'
        },
        'ja': {
          notAvailable: 'ㄣｃ裤╃ㄣс俱',
          description: 'ㄣｃ裤°炽炽广涓点笺广姝俱',
          working: '瑰浣妤涓',
          message: '浣楱渚°ゃ炽ㄣｃ裤存般俱搞с汇枫с炽╃ㄣ',
          goToProjects: '搞с哥Щ',
          status: '广笺裤: °炽炽逛腑'
        },
        'ko': {
          notAvailable: '胳旮半ゼ ╉  ',
          description: '胳旮瓣 歆氤挫毳  检茧 牍るゼ 欷惦.',
          working: '臧  欷',
          message: '  瓴巾 瓿淀旮  氅 胳旮半ゼ 办错疙瓿 惦. 攴  搿 轨 挫╉  惦.',
          goToProjects: '搿鸽 措',
          status: ': 歆氤挫 欷'
        },
        'vi': {
          notAvailable: 'Tr矛nh ch峄nh s峄a kh么ng kh岷 d峄ng',
          description: 'Tr矛nh ch峄nh s峄a t岷m th峄i ng峄ng ho岷t 峄ng 峄 b岷o tr矛.',
          working: 'ang lm vi峄c 峄 c岷i thi峄n',
          message: 'Ch煤ng t么i ang c岷p nh岷t tr矛nh ch峄nh s峄a ch铆nh 峄 mang 岷n cho b岷n tr岷i nghi峄m t峄t h啤n. Trong th峄i gian ny, b岷n c贸 th峄 s峄 d峄ng ph岷n D峄 谩n.',
          goToProjects: 'i 岷n D峄 谩n',
          status: 'Tr岷ng th谩i: ang b岷o tr矛'
        },
        'zh': {
          notAvailable: '缂杈ㄤ',
          description: '缂杈ㄥ缁存ゆ跺姝㈡°',
          working: '姝ｅㄦ硅涓',
          message: '浠姝ｅㄦ存颁富缂杈ㄤ互涓烘ㄦ渚村ソ浣楠涓姝ゅ讹ㄥ浠ヤ娇ㄩ」ㄥ',
          goToProjects: '杞伴」',
          status: '舵锛缁存や腑'
        }
      };

      const texts = maintenanceTexts[lang] || maintenanceTexts['es'];
      
      // Actualizar texto del t铆tulo principal
      const mainTitle = document.querySelector('#inicio h1');
      if (mainTitle) mainTitle.textContent = texts.notAvailable;
      
      // Actualizar descripci贸n
      const description = document.querySelector('#inicio p');
      if (description) description.textContent = texts.description;
      
      // Actualizar textos dentro del contenedor de mantenimiento
      const workingTitle = document.querySelector('#inicio .maintenance-container div:nth-child(4) div');
      if (workingTitle) workingTitle.textContent = texts.working;
      
      const workingMessage = document.querySelector('#inicio .maintenance-container div:nth-child(4) p');
      if (workingMessage) workingMessage.textContent = texts.message;
      
      // Actualizar bot贸n
      const goButton = document.querySelector('#inicio button');
      if (goButton) {
        const icon = goButton.querySelector('i');
        goButton.innerHTML = '';
        if (icon) goButton.appendChild(icon);
        goButton.append(' ' + texts.goToProjects);
      }
      
      // Actualizar estado
      const statusText = document.querySelector('#inicio .maintenance-container div:last-child span');
      if (statusText) statusText.textContent = texts.status;
    }

    function translateProjectsSection(lang) {
      const projectTexts = {
        'es': {
          myProjects: 'Mis Proyectos',
          newProject: 'Nuevo Proyecto',
          import: 'Importar',
          save: 'Guardar',
          duplicate: 'Duplicar',
          export: 'Exportar',
          close: 'Cerrar',
          noProjects: 'No hay proyectos',
          createFirst: 'Crea tu primer proyecto para comenzar a programar',
          open: 'Abrir',
          preview: 'Vista Previa',
          scan: 'Escanear',
          share: 'Compartir',
          config: 'Config'
        },
        'en': {
          myProjects: 'My Projects',
          newProject: 'New Project', 
          import: 'Import',
          save: 'Save',
          duplicate: 'Duplicate',
          export: 'Export',
          close: 'Close',
          noProjects: 'No projects',
          createFirst: 'Create your first project to start programming',
          open: 'Open',
          preview: 'Preview',
          scan: 'Scan',
          share: 'Share',
          config: 'Config'
        },
        'ja': {
          myProjects: 'ゃ搞с',
          newProject: '般搞с',
          import: 'ゃ炽笺',
          save: '淇瀛',
          duplicate: '瑜瑁',
          export: 'ㄣ广笺',
          close: '',
          noProjects: '搞с俱',
          createFirst: '般┿炽般濮搞с浣',
          open: '',
          preview: 'ャ',
          scan: '广ｃ',
          share: '辨',
          config: '瑷瀹'
        },
        'ko': {
          myProjects: ' 搿',
          newProject: ' 搿',
          import: '臧胳り赴',
          save: '',
          duplicate: '氤奠',
          export: '措炒搓赴',
          close: '旮',
          noProjects: '搿戈 惦',
          createFirst: '搿攴鸽氚 る┐ 觳 氩歆 搿鸽ゼ 毵胳',
          open: '搓赴',
          preview: '氙鸽Μ氤搓赴',
          scan: 'れ',
          share: '瓿奠',
          config: 'れ'
        },
        'vi': {
          myProjects: 'D峄 谩n c峄a t么i',
          newProject: 'D峄 谩n m峄i',
          import: 'Nh岷p kh岷u',
          save: 'L瓢u',
          duplicate: 'Sao ch茅p',
          export: 'Xu岷t',
          close: '贸ng',
          noProjects: 'Kh么ng c贸 d峄 谩n',
          createFirst: 'T岷o d峄 谩n 岷u ti锚n 峄 b岷t 岷u l岷p tr矛nh',
          open: 'M峄',
          preview: 'Xem tr瓢峄c',
          scan: 'Qu茅t',
          share: 'Chia s岷',
          config: 'C岷u h矛nh'
        },
        'zh': {
          myProjects: '椤圭',
          newProject: '伴」',
          import: '瀵煎',
          save: '淇瀛',
          duplicate: '澶',
          export: '瀵煎',
          close: '抽',
          noProjects: '娌℃椤圭',
          createFirst: '寤烘ㄧ绗涓涓椤圭寮濮缂绋',
          open: '寮',
          preview: '棰瑙',
          scan: '',
          share: '浜',
          config: '缃'
        }
      };

      const texts = projectTexts[lang] || projectTexts['es'];
      
      // T铆tulo de proyectos
      const projectsTitle = document.querySelector('#proyectos h2');
      if (projectsTitle) {
        const icon = projectsTitle.querySelector('i');
        projectsTitle.innerHTML = '';
        if (icon) projectsTitle.appendChild(icon);
        projectsTitle.append(' ' + texts.myProjects);
      }
      
      // Botones principales
      const newProjectBtn = document.querySelector('.new-project-btn');
      if (newProjectBtn) {
        const icon = newProjectBtn.querySelector('i');
        newProjectBtn.innerHTML = '';
        if (icon) newProjectBtn.appendChild(icon);
        newProjectBtn.append(' ' + texts.newProject);
      }
      
      const importBtn = document.querySelector('.import-project-btn');
      if (importBtn) {
        const icon = importBtn.querySelector('i');
        importBtn.innerHTML = '';
        if (icon) importBtn.appendChild(icon);
        importBtn.append(' ' + texts.import);
      }
      
      // Mensaje de sin proyectos
      const noProjectsTitle = document.querySelector('#projectsList h3');
      if (noProjectsTitle) noProjectsTitle.textContent = texts.noProjects;
      
      const noProjectsDesc = document.querySelector('#projectsList p');
      if (noProjectsDesc) noProjectsDesc.textContent = texts.createFirst;
      
      // Botones del editor de proyecto
      const saveBtn = document.querySelector('.save-btn');
      if (saveBtn) {
        const icon = saveBtn.querySelector('i');
        saveBtn.innerHTML = '';
        if (icon) saveBtn.appendChild(icon);
        saveBtn.append(' ' + texts.save);
      }
      
      const closeBtn = document.querySelector('.close-btn');
      if (closeBtn) {
        const icon = closeBtn.querySelector('i');
        closeBtn.innerHTML = '';
        if (icon) closeBtn.appendChild(icon);
        closeBtn.append(' ' + texts.close);
      }
      
      // Botones de proyecto individuales
      document.querySelectorAll('.open-project-btn').forEach(btn => {
        const icon = btn.querySelector('i');
        btn.innerHTML = '';
        if (icon) btn.appendChild(icon);
        btn.append(' ' + texts.open);
      });
      
      // Botones de herramientas
      const previewBtnProject = document.getElementById('previewBtnTextProject');
      if (previewBtnProject) previewBtnProject.textContent = texts.preview;
      
      const scanBtnText = document.querySelector('#scanBtnProject span');
      if (scanBtnText) scanBtnText.textContent = texts.scan;
      
      const shareBtnText = document.querySelector('button[onclick="shareProject()"] span');
      if (shareBtnText) shareBtnText.textContent = texts.share;
      
      const configBtnText = document.querySelector('button[onclick="showProjectSettings()"] span');
      if (configBtnText) configBtnText.textContent = texts.config;
    }

    function translateSearchSection(lang) {
      const searchTexts = {
        'es': {
          search: 'Buscar',
          searchInClack: 'Buscar en Clack...',
          recentSearches: 'B煤squedas recientes',
          articles: 'Art铆culos',
          noResults: 'No se encontraron videos o art铆culos.',
          openArticle: 'Abrir Art铆culo'
        },
        'en': {
          search: 'Search',
          searchInClack: 'Search in Clack...',
          recentSearches: 'Recent searches',
          articles: 'Articles',
          noResults: 'No videos or articles found.',
          openArticle: 'Open Article'
        },
        'ja': {
          search: '妞绱',
          searchInClack: 'Clackф绱...',
          recentSearches: '杩妞绱',
          articles: '瑷浜',
          noResults: '瑷浜瑕ゃ俱с',
          openArticle: '瑷浜'
        },
        'ko': {
          search: '瓴',
          searchInClack: 'Clack 瓴...',
          recentSearches: '斓攴 瓴',
          articles: '旮办',
          noResults: '措 旮办毳 彀眷  惦.',
          openArticle: '旮办 搓赴'
        },
        'vi': {
          search: 'T矛m ki岷m',
          searchInClack: 'T矛m ki岷m trong Clack...',
          recentSearches: 'T矛m ki岷m g岷n 芒y',
          articles: 'Bi vi岷t',
          noResults: 'Kh么ng t矛m th岷y video ho岷c bi vi岷t.',
          openArticle: 'M峄 bi vi岷t'
        },
        'zh': {
          search: '绱',
          searchInClack: 'Clack涓绱...',
          recentSearches: '杩绱',
          articles: '绔',
          noResults: '惧拌棰绔',
          openArticle: '寮绔'
        }
      };

      const texts = searchTexts[lang] || searchTexts['es'];
      
      // Bot贸n de b煤squeda
      const searchBtn = document.getElementById('searchExecuteBtn');
      if (searchBtn) searchBtn.textContent = texts.search;
      
      // Placeholder de b煤squeda  
      const searchInput = document.getElementById('searchInput');
      if (searchInput) searchInput.placeholder = texts.searchInClack;
      
      // T铆tulos de secciones
      const recentTitle = document.querySelector('.recent-searches h3');
      if (recentTitle) recentTitle.textContent = texts.recentSearches;
      
      const articlesBtn = document.getElementById('toggleArticles');
      if (articlesBtn) articlesBtn.textContent = texts.articles;
      
      // Botones de abrir art铆culo
      document.querySelectorAll('.openArticleBtn').forEach(btn => {
        const icon = btn.querySelector('i');
        btn.innerHTML = '';
        if (icon) btn.appendChild(icon);
        btn.append(' ' + texts.openArticle);
      });
    }

    function translateSettingsSection(lang) {
      const settingsTexts = {
        'es': {
          settings: 'Configuraci贸n',
          search: 'Buscar',
          language: 'Idioma',
          theme: 'Tema',
          privacy: 'Privacidad',
          security: 'Seguridad',
          assistant: 'Asistente Virtual',
          maintenance: 'En mantenimiento - Pr贸ximamente',
          about: 'Acerca de',
          information: 'Informaci贸n'
        },
        'en': {
          settings: 'Settings',
          search: 'Search',
          language: 'Language',
          theme: 'Theme',
          privacy: 'Privacy',
          security: 'Security',
          assistant: 'Virtual Assistant',
          maintenance: 'Under maintenance - Coming soon',
          about: 'About',
          information: 'Information'
        },
        'ja': {
          settings: '瑷瀹',
          search: '妞绱',
          language: '瑷瑾',
          theme: '笺',
          privacy: '┿ゃ枫',
          security: '汇ャ',
          assistant: '笺ｃ枫广裤炽',
          maintenance: '°炽炽逛腑 - 杩ュ',
          about: 'ゃ',
          information: ''
        },
        'ko': {
          settings: 'れ',
          search: '瓴',
          language: '胳',
          theme: '毵',
          privacy: '臧胳氤',
          security: '氤挫',
          assistant: '臧 挫ろ错',
          maintenance: '歆氤挫 欷 - 瓿 於',
          about: '氤',
          information: '氤'
        },
        'vi': {
          settings: 'Ci 岷t',
          search: 'T矛m ki岷m',
          language: 'Ng么n ng峄',
          theme: 'Ch峄 峄',
          privacy: 'Ri锚ng t瓢',
          security: 'B岷o m岷t',
          assistant: 'Tr峄 l媒 岷o',
          maintenance: 'ang b岷o tr矛 - S岷p ra m岷t',
          about: 'Gi峄i thi峄u',
          information: 'Th么ng tin'
        },
        'zh': {
          settings: '璁剧疆',
          search: '绱',
          language: '璇瑷',
          theme: '涓婚',
          privacy: '绉',
          security: '瀹',
          assistant: '╂',
          maintenance: '缁存や腑 - 冲ㄥ',
          about: '充',
          information: '淇℃'
        }
      };

      const texts = settingsTexts[lang] || settingsTexts['es'];
      
      // T铆tulo principal
      const settingsTitle = document.querySelector('.settings-header h2');
      if (settingsTitle) settingsTitle.textContent = texts.settings;
      
      // Barra de b煤squeda
      const settingsSearch = document.getElementById('settingsSearch');
      if (settingsSearch) settingsSearch.placeholder = texts.search;
      
      // Items de configuraci贸n
      const settingsItems = document.querySelectorAll('.settings-item-title');
      if (settingsItems[0]) settingsItems[0].textContent = texts.language;
      if (settingsItems[1]) settingsItems[1].textContent = texts.theme;
      if (settingsItems[2]) settingsItems[2].textContent = texts.privacy;
      if (settingsItems[3]) settingsItems[3].textContent = texts.security;
      if (settingsItems[4]) settingsItems[4].textContent = texts.assistant;
      if (settingsItems[5]) settingsItems[5].textContent = texts.about;
      
      // Subtitle del asistente
      const assistantSubtitle = document.querySelector('#helpBotItem .settings-item-subtitle');
      if (assistantSubtitle) assistantSubtitle.textContent = texts.maintenance;
      
      // Secci贸n de informaci贸n
      const infoSection = document.querySelector('.settings-section-title');
      if (infoSection) infoSection.textContent = texts.information;
    }

    function translateAssistantSection(lang) {
      const assistantTexts = {
        'es': {
          maintenance: 'Asistente en Mantenimiento',
          description: 'El asistente virtual est谩 temporalmente fuera de servicio. Estamos trabajando en mejoras incre铆bles que estar谩n disponibles para todos los usuarios en la pr贸xima actualizaci贸n.',
          comingSoon: 'Pr贸ximamente con nuevas funciones',
          understood: 'Entendido'
        },
        'en': {
          maintenance: 'Assistant Under Maintenance',
          description: 'The virtual assistant is temporarily out of service. We are working on incredible improvements that will be available to all users in the next update.',
          comingSoon: 'Coming soon with new features',
          understood: 'Understood'
        },
        'ja': {
          maintenance: '枫广裤炽°炽炽逛腑',
          description: '笺ｃ枫广裤炽涓点笺广姝俱娆°笺уㄣ笺躲笺╃ㄣс绱淬瑰绲с俱',
          comingSoon: '版姐ㄥ便杩ュ',
          understood: '浜瑙ｃ俱'
        },
        'ko': {
          maintenance: '挫ろ错 歆氤挫 欷',
          description: '臧 挫ろ错戈 检茧 牍るゼ 欷惦. れ 办错胳 氇 ╈臧 挫╉   检 臧  瓿 惦.',
          comingSoon: '搿 旮半レ茧 瓿 於',
          understood: '错错惦'
        },
        'vi': {
          maintenance: 'Tr峄 l媒 ang b岷o tr矛',
          description: 'Tr峄 l媒 岷o t岷m th峄i ng峄ng ho岷t 峄ng. Ch煤ng t么i ang lm vi峄c tr锚n nh峄ng c岷i ti岷n tuy峄t v峄i s岷 c贸 s岷n cho t岷t c岷 ng瓢峄i d霉ng trong b岷n c岷p nh岷t ti岷p theo.',
          comingSoon: 'S岷p ra m岷t v峄i c谩c t铆nh nng m峄i',
          understood: '茫 hi峄u'
        },
        'zh': {
          maintenance: '╂缁存や腑',
          description: '╂跺姝㈡°浠姝ｅㄥ浠や汉句互缃淇＄硅锛灏ㄤ娆℃存颁腑ㄦ锋渚',
          comingSoon: '冲ㄥ烘板',
          understood: '戒'
        }
      };

      const texts = assistantTexts[lang] || assistantTexts['es'];
      
      // Guardar textos para cuando se abra el modal de mantenimiento
      window.assistantMaintenanceTexts = texts;
    }

    function translateInputsAndLabels(lang) {
      const inputTexts = {
        'es': {
          projectName: 'Nombre del proyecto',
          htmlPlaceholder: 'Escribe tu c贸digo HTML aqu铆...',
          cssPlaceholder: 'Escribe tu c贸digo CSS aqu铆...',
          jsPlaceholder: 'Escribe tu c贸digo JavaScript aqu铆...'
        },
        'en': {
          projectName: 'Project name',
          htmlPlaceholder: 'Write your HTML code here...',
          cssPlaceholder: 'Write your CSS code here...',
          jsPlaceholder: 'Write your JavaScript code here...'
        },
        'ja': {
          projectName: '搞с',
          htmlPlaceholder: 'HTML炽笺搞...',
          cssPlaceholder: 'CSS炽笺搞...',
          jsPlaceholder: 'JavaScript炽笺搞...'
        },
        'ko': {
          projectName: '搿 措',
          htmlPlaceholder: 'HTML 旖毳 旮办 表胳...',
          cssPlaceholder: 'CSS 旖毳 旮办 表胳...',
          jsPlaceholder: 'JavaScript 旖毳 旮办 表胳...'
        },
        'vi': {
          projectName: 'T锚n d峄 谩n',
          htmlPlaceholder: 'Vi岷t m茫 HTML c峄a b岷n t岷i 芒y...',
          cssPlaceholder: 'Vi岷t m茫 CSS c峄a b岷n t岷i 芒y...',
          jsPlaceholder: 'Vi岷t m茫 JavaScript c峄a b岷n t岷i 芒y...'
        },
        'zh': {
          projectName: '椤圭绉',
          htmlPlaceholder: 'ㄦゅ缂ㄧHTML浠ｇ...',
          cssPlaceholder: 'ㄦゅ缂ㄧCSS浠ｇ...',
          jsPlaceholder: 'ㄦゅ缂ㄧJavaScript浠ｇ...'
        }
      };

      const texts = inputTexts[lang] || inputTexts['es'];
      
      // Input de nombre de proyecto
      const projectNameInput = document.getElementById('projectName');
      if (projectNameInput) projectNameInput.placeholder = texts.projectName;
      
      // Placeholders de editores
      const htmlEditor = document.getElementById('htmlEditor');
      if (htmlEditor) htmlEditor.placeholder = texts.htmlPlaceholder;
      
      const cssEditor = document.getElementById('cssEditor');
      if (cssEditor) cssEditor.placeholder = texts.cssPlaceholder;
      
      const jsEditor = document.getElementById('jsEditor');
      if (jsEditor) jsEditor.placeholder = texts.jsPlaceholder;
    }

    function translateTooltipsAndTitles(lang) {
      const tooltipTexts = {
        'es': {
          settings: 'Ajustes',
          search: 'Buscar',
          duplicate: 'Duplicar proyecto',
          export: 'Exportar proyecto',
          fullscreen: 'Pantalla completa',
          security: 'Escanear seguridad',
          format: 'Formatear todo el c贸digo',
          findReplace: 'Buscar y reemplazar',
          validate: 'Validar c贸digo',
          undo: 'Deshacer',
          redo: 'Rehacer',
          clear: 'Limpiar todo',
          share: 'Compartir proyecto',
          config: 'Configuraciones del proyecto'
        },
        'en': {
          settings: 'Settings',
          search: 'Search',
          duplicate: 'Duplicate project',
          export: 'Export project',
          fullscreen: 'Fullscreen',
          security: 'Security scan',
          format: 'Format all code',
          findReplace: 'Find and replace',
          validate: 'Validate code',
          undo: 'Undo',
          redo: 'Redo',
          clear: 'Clear all',
          share: 'Share project',
          config: 'Project settings'
        },
        'ja': {
          settings: '瑷瀹',
          search: '妞绱',
          duplicate: '搞с瑜瑁',
          export: '搞сㄣ广笺',
          fullscreen: '广笺',
          security: '汇ャｃ广ｃ',
          format: '广炽笺┿笺',
          findReplace: '妞绱ㄧ疆',
          validate: '炽笺妞瑷',
          undo: '汇',
          redo: '淬',
          clear: '广',
          share: '搞с辨',
          config: '搞с瑷瀹'
        },
        'ko': {
          settings: 'れ',
          search: '瓴',
          duplicate: '搿 氤奠',
          export: '搿 措炒搓赴',
          fullscreen: '觳错氅',
          security: '氤挫 れ',
          format: '氇 旖 毵',
          findReplace: '彀娟赴 氚 氚昃戈赴',
          validate: '旖 瓴歃',
          undo: 'ろ 旆',
          redo: 'れ ろ',
          clear: '氇 歆瓣赴',
          share: '搿 瓿奠',
          config: '搿 れ'
        },
        'vi': {
          settings: 'Ci 岷t',
          search: 'T矛m ki岷m',
          duplicate: 'Sao ch茅p d峄 谩n',
          export: 'Xu岷t d峄 谩n',
          fullscreen: 'Ton mn h矛nh',
          security: 'Qu茅t b岷o m岷t',
          format: '峄nh d岷ng t岷t c岷 m茫',
          findReplace: 'T矛m v thay th岷',
          validate: 'X谩c th峄c m茫',
          undo: 'Hon t谩c',
          redo: 'Lm l岷i',
          clear: 'X贸a t岷t c岷',
          share: 'Chia s岷 d峄 谩n',
          config: 'Ci 岷t d峄 谩n'
        },
        'zh': {
          settings: '璁剧疆',
          search: '绱',
          duplicate: '澶堕」',
          export: '瀵煎洪」',
          fullscreen: 'ㄥ',
          security: '瀹ㄦ',
          format: '煎浠ｇ',
          findReplace: 'ユ惧挎',
          validate: '楠璇浠ｇ',
          undo: 'ら',
          redo: '',
          clear: '娓ゆ',
          share: '浜椤圭',
          config: '椤圭璁剧疆'
        }
      };

      const texts = tooltipTexts[lang] || tooltipTexts['es'];
      
      // Actualizar todos los t铆tulos/tooltips
      const elements = [
        { selector: '#settingsBtn', title: texts.settings },
        { selector: '#searchBtn', title: texts.search },
        { selector: '.duplicate-btn', title: texts.duplicate },
        { selector: '.export-btn', title: texts.export },
        { selector: '.fullscreen-btn', title: texts.fullscreen },
        { selector: '#scanBtn', title: texts.security },
        { selector: '#scanBtnProject', title: texts.security },
        { selector: 'button[onclick="formatAllCode()"]', title: texts.format },
        { selector: 'button[onclick="findAndReplace()"]', title: texts.findReplace },
        { selector: 'button[onclick="validateCode()"]', title: texts.validate },
        { selector: 'button[onclick="undoChanges()"]', title: texts.undo },
        { selector: 'button[onclick="redoChanges()"]', title: texts.redo },
        { selector: 'button[onclick="clearAllEditors()"]', title: texts.clear },
        { selector: 'button[onclick="shareProject()"]', title: texts.share },
        { selector: 'button[onclick="showProjectSettings()"]', title: texts.config }
      ];
      
      elements.forEach(({ selector, title }) => {
        const element = document.querySelector(selector);
        if (element) element.title = title;
      });
    }
    
    function showPageSkeleton(lang) {
      const overlay = document.getElementById('pageSkeletonOverlay');
      const flag = document.getElementById('translationFlag');
      const status = document.getElementById('translationStatus');
      
      // Configurar bandera seg煤n idioma
      const flags = {
        'es': '',
        'en': '吼', 
        'ja': '',
        'ko': '梆',
        'vi': '火',
        'zh': ''
      };
      
      const statusTexts = {
        'es': 'Optimizando experiencia...',
        'en': 'Optimizing experience...',
        'ja': 'ㄣ广ㄣ炽广╁涓...',
        'ko': '瓴巾 斓 欷...',
        'vi': 'ang t峄i 瓢u h贸a tr岷i nghi峄m...',
        'zh': '姝ｅㄤ浣楠...'
      };
      
      flag.textContent = flags[lang] || '';
      status.textContent = statusTexts[lang] || 'Optimizando...';
      
      overlay.style.display = 'block';
      
      // Tambi茅n mostrar skeleton en ajustes si est谩n abiertos
      if (document.getElementById('settingsOverlay').style.display === 'block') {
        showSettingsSkeleton();
      }
      
      // Mostrar skeleton en proyectos si est谩 activo
      if (document.getElementById('proyectos').classList.contains('active')) {
        showProjectsSkeleton();
      }
      
      // Mostrar skeleton en b煤squeda si est谩 abierta
      if (document.getElementById('searchOverlay').style.display === 'block') {
        showSearchSkeleton();
      }
      
      // Mostrar skeleton en vista previa si est谩 abierta
      if (document.getElementById('previewOverlay').style.display === 'block') {
        showPreviewSkeleton();
      }
    }
    
    function hidePageSkeleton() {
      const overlay = document.getElementById('pageSkeletonOverlay');
      overlay.style.display = 'none';
      hideSettingsSkeleton();
      hideProjectsSkeleton();
      hideSearchSkeleton();
      hidePreviewSkeleton();
    }
    
    function showSettingsSkeleton() {
      const skeleton = document.getElementById('settingsSkeleton');
      const content = document.getElementById('settingsContent');
      skeleton.style.display = 'block';
      content.style.display = 'none';
    }
    
    function hideSettingsSkeleton() {
      const skeleton = document.getElementById('settingsSkeleton');
      const content = document.getElementById('settingsContent');
      skeleton.style.display = 'none';
      content.style.display = 'block';
    }
    
    function showProjectsSkeleton() {
      const skeleton = document.getElementById('projectsSkeleton');
      const content = document.getElementById('projectsContent');
      skeleton.style.display = 'block';
      content.style.display = 'none';
    }
    
    function hideProjectsSkeleton() {
      const skeleton = document.getElementById('projectsSkeleton');
      const content = document.getElementById('projectsContent');
      skeleton.style.display = 'none';
      content.style.display = 'block';
    }
    
    function showSearchSkeleton() {
      // Crear skeleton din谩mico para b煤squeda
      const searchOverlay = document.getElementById('searchOverlay');
      let skeleton = document.getElementById('searchSkeleton');
      
      if (!skeleton) {
        skeleton = document.createElement('div');
        skeleton.id = 'searchSkeleton';
        skeleton.style.cssText = `
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: var(--bg-color);
          z-index: 1;
          padding: 20px;
        `;
        
        skeleton.innerHTML = `
          <div style="height: 60px; background: #e0e0e0; border-radius: 8px; margin-bottom: 20px; position: relative; overflow: hidden;"></div>
          <div style="height: 40px; background: #e8e8e8; border-radius: 6px; margin-bottom: 20px; position: relative; overflow: hidden;"></div>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
            <div style="height: 200px; background: #e0e0e0; border-radius: 12px; position: relative; overflow: hidden;"></div>
            <div style="height: 200px; background: #e0e0e0; border-radius: 12px; position: relative; overflow: hidden;"></div>
            <div style="height: 200px; background: #e0e0e0; border-radius: 12px; position: relative; overflow: hidden;"></div>
          </div>
        `;
        
        // Agregar efecto shimmer a todos los elementos
        const shimmerElements = skeleton.querySelectorAll('div[style*="background: #"]');
        shimmerElements.forEach(el => {
          el.style.position = 'relative';
          el.style.overflow = 'hidden';
          const shimmer = document.createElement('div');
          shimmer.style.cssText = `
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            animation: skeletonShimmer 1.8s infinite;
          `;
          el.appendChild(shimmer);
        });
        
        searchOverlay.appendChild(skeleton);
      }
      
      skeleton.style.display = 'block';
    }
    
    function hideSearchSkeleton() {
      const skeleton = document.getElementById('searchSkeleton');
      if (skeleton) {
        skeleton.style.display = 'none';
      }
    }
    
    function showPreviewSkeleton() {
      // Crear skeleton din谩mico para vista previa
      const previewOverlay = document.getElementById('previewOverlay');
      let skeleton = document.getElementById('previewSkeleton');
      
      if (!skeleton) {
        skeleton = document.createElement('div');
        skeleton.id = 'previewSkeleton';
        skeleton.style.cssText = `
          position: absolute;
          top: 60px;
          left: 0;
          width: 100%;
          height: calc(100% - 60px);
          background: var(--bg-color);
          z-index: 1;
          padding: 20px;
        `;
        
        skeleton.innerHTML = `
          <div style="height: 40px; background: #e0e0e0; border-radius: 8px; margin-bottom: 20px; position: relative; overflow: hidden;"></div>
          <div style="height: calc(100vh - 200px); background: #e0e0e0; border-radius: 12px; position: relative; overflow: hidden;">
            <div style="height: 30px; background: #d0d0d0; border-radius: 12px 12px 0 0;"></div>
          </div>
        `;
        
        // Agregar efecto shimmer
        const shimmerElements = skeleton.querySelectorAll('div[style*="background: #"]');
        shimmerElements.forEach(el => {
          el.style.position = 'relative';
          el.style.overflow = 'hidden';
          const shimmer = document.createElement('div');
          shimmer.style.cssText = `
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            animation: skeletonShimmer 1.8s infinite;
          `;
          el.appendChild(shimmer);
        });
        
        previewOverlay.appendChild(skeleton);
      }
      
      skeleton.style.display = 'block';
    }
    
    function hidePreviewSkeleton() {
      const skeleton = document.getElementById('previewSkeleton');
      if (skeleton) {
        skeleton.style.display = 'none';
      }
    }
    
    function updateAllTexts(t) {
      // Actualizar textos del modal
      const modalTitle = document.getElementById('modalTitle');
      const modalDescription = document.getElementById('modalDescription');
      const loginBtnText = document.getElementById('loginBtnText');
      
      if (modalTitle) modalTitle.innerHTML = t.modalTitle;
      if (modalDescription) modalDescription.innerHTML = t.modalDescription;
      if (loginBtnText) loginBtnText.textContent = t.loginButton;
      
      // Actualizar botones
      const previewBtnText = document.getElementById('previewBtnText');
      const previewBtnTextProject = document.getElementById('previewBtnTextProject');
      const previewHeaderText = document.getElementById('previewHeaderText');
      const searchExecuteBtn = document.getElementById('searchExecuteBtn');
      
      if (previewBtnText) previewBtnText.textContent = t.previewButton;
      if (previewBtnTextProject) previewBtnTextProject.textContent = t.previewButton;
      if (previewHeaderText) previewHeaderText.textContent = t.previewHeader;
      if (searchExecuteBtn) searchExecuteBtn.textContent = t.searchButton;
      
      // Actualizar placeholders de editores
      const htmlEditor = document.getElementById('htmlEditor');
      const cssEditor = document.getElementById('cssEditor');
      const jsEditor = document.getElementById('jsEditor');
      const htmlEditorMain = document.getElementById('htmlEditorMain');
      const cssEditorMain = document.getElementById('cssEditorMain');
      const jsEditorMain = document.getElementById('jsEditorMain');
      
      if (htmlEditor) htmlEditor.placeholder = t.htmlPlaceholder;
      if (cssEditor) cssEditor.placeholder = t.cssPlaceholder;
      if (jsEditor) jsEditor.placeholder = t.jsPlaceholder;
      if (htmlEditorMain) htmlEditorMain.placeholder = t.htmlPlaceholder;
      if (cssEditorMain) cssEditorMain.placeholder = t.cssPlaceholder;
      if (jsEditorMain) jsEditorMain.placeholder = t.jsPlaceholder;
      
      // Actualizar navegaci贸n y secciones
      updateNavigationTexts(t);
      updateSettingsTexts(t);
      updateProjectsTexts(t);
    }
    
    function updateNavigationTexts(t) {
      // Actualizar textos de navegaci贸n seg煤n idioma
      const navTexts = {
        'es': { inicio: 'Inicio', proyectos: 'Proyectos' },
        'en': { inicio: 'Home', proyectos: 'Projects' },
        'ja': { inicio: '笺', proyectos: '搞с' },
        'ko': { inicio: '', proyectos: '搿' },
        'vi': { inicio: 'Trang ch峄', proyectos: 'D峄 谩n' },
        'zh': { inicio: '棣椤', proyectos: '椤圭' }
      };
      
      const texts = navTexts[currentLang] || navTexts['es'];
      const navLinks = document.querySelectorAll('nav a');
      
      if (navLinks[0]) navLinks[0].textContent = texts.inicio;
      if (navLinks[1]) navLinks[1].textContent = texts.proyectos;
    }
    
    function updateSettingsTexts(t) {
      // Actualizar textos de ajustes seg煤n idioma
      const settingsTexts = {
        'es': { 
          title: 'Configuraci贸n',
          language: 'Idioma',
          theme: 'Tema',
          privacy: 'Privacidad',
          security: 'Seguridad',
          assistant: 'Asistente Virtual',
          about: 'Acerca de'
        },
        'en': { 
          title: 'Settings',
          language: 'Language',
          theme: 'Theme',
          privacy: 'Privacy',
          security: 'Security',
          assistant: 'Virtual Assistant',
          about: 'About'
        },
        'ja': { 
          title: '瑷瀹',
          language: '瑷瑾',
          theme: '笺',
          privacy: '┿ゃ枫',
          security: '汇ャ',
          assistant: '笺ｃ枫广裤炽',
          about: 'ゃ'
        },
        'ko': { 
          title: 'れ',
          language: '胳',
          theme: '毵',
          privacy: '臧胳氤',
          security: '氤挫',
          assistant: '臧 挫ろ错',
          about: '氤'
        },
        'vi': { 
          title: 'Ci 岷t',
          language: 'Ng么n ng峄',
          theme: 'Ch峄 峄',
          privacy: 'Ri锚ng t瓢',
          security: 'B岷o m岷t',
          assistant: 'Tr峄 l媒 岷o',
          about: 'Gi峄i thi峄u'
        },
        'zh': { 
          title: '璁剧疆',
          language: '璇瑷',
          theme: '涓婚',
          privacy: '绉',
          security: '瀹',
          assistant: '╂',
          about: '充'
        }
      };
      
      const texts = settingsTexts[currentLang] || settingsTexts['es'];
      
      // Actualizar t铆tulo de ajustes
      const settingsTitle = document.querySelector('.settings-header h2');
      if (settingsTitle) settingsTitle.textContent = texts.title;
      
      // Actualizar elementos de ajustes
      const settingsItems = document.querySelectorAll('.settings-item-title');
      if (settingsItems[0]) settingsItems[0].textContent = texts.language;
      if (settingsItems[1]) settingsItems[1].textContent = texts.theme;
      if (settingsItems[2]) settingsItems[2].textContent = texts.privacy;
      if (settingsItems[3]) settingsItems[3].textContent = texts.security;
      if (settingsItems[4]) settingsItems[4].textContent = texts.assistant;
      if (settingsItems[5]) settingsItems[5].textContent = texts.about;
    }
    
    function updateProjectsTexts(t) {
      // Actualizar textos de proyectos seg煤n idioma
      const projectsTexts = {
        'es': { 
          title: 'Mis Proyectos',
          newProject: 'Nuevo Proyecto',
          save: 'Guardar',
          duplicate: 'Duplicar',
          export: 'Exportar',
          close: 'Cerrar'
        },
        'en': { 
          title: 'My Projects',
          newProject: 'New Project',
          save: 'Save',
          duplicate: 'Duplicate',
          export: 'Export',
          close: 'Close'
        },
        'ja': { 
          title: 'ゃ搞с',
          newProject: '般搞с',
          save: '淇瀛',
          duplicate: '瑜瑁',
          export: 'ㄣ广笺',
          close: ''
        },
        'ko': { 
          title: ' 搿',
          newProject: ' 搿',
          save: '',
          duplicate: '氤奠',
          export: '措炒搓赴',
          close: '旮'
        },
        'vi': { 
          title: 'D峄 谩n c峄a t么i',
          newProject: 'D峄 谩n m峄i',
          save: 'L瓢u',
          duplicate: 'Sao ch茅p',
          export: 'Xu岷t',
          close: '贸ng'
        },
        'zh': { 
          title: '椤圭',
          newProject: '伴」',
          save: '淇瀛',
          duplicate: '澶',
          export: '瀵煎',
          close: '抽'
        }
      };
      
      const texts = projectsTexts[currentLang] || projectsTexts['es'];
      
      // Actualizar t铆tulo de proyectos
      const projectsTitle = document.querySelector('#proyectos h2');
      if (projectsTitle) projectsTitle.textContent = texts.title;
      
      // Actualizar botones de proyecto (si existen)
      const newProjectBtn = document.querySelector('.new-project-btn');
      if (newProjectBtn) {
        const icon = newProjectBtn.querySelector('i');
        newProjectBtn.innerHTML = '';
        if (icon) newProjectBtn.appendChild(icon);
        newProjectBtn.append(' ' + texts.newProject);
      }
    }

    function runLangTransitionAnimation() {
      const overlay = document.getElementById('langTransitionOverlay');
      overlay.style.display = 'block';
      const ballLeft = overlay.querySelector('.ball-left');
      const ballRight = overlay.querySelector('.ball-right');
      ballLeft.classList.add('animate-left');
      ballRight.classList.add('animate-right');
      setTimeout(() => {
        overlay.style.display = 'none';
        ballLeft.classList.remove('animate-left');
        ballRight.classList.remove('animate-right');
      }, 2000);
    }

    function setupSwipeDetection() {
      let touchstartX = 0, touchendX = 0;
      const settingsOverlay = document.getElementById('settingsOverlay');
      settingsOverlay.addEventListener('touchstart', e => { touchstartX = e.changedTouches[0].screenX; });
      settingsOverlay.addEventListener('touchend', e => {
        touchendX = e.changedTouches[0].screenX;
        if (touchstartX - touchendX > 100) settingsOverlay.style.display = 'none';
      });
    }

    

    /* ========================
       Funciones de Sesi贸n
       ======================== */
    function checkSession() { 
      if(localStorage.getItem('loggedIn') === 'true') {
        document.getElementById('loginModal').style.display = 'none';
      }
    }
    function loginSimulated() {
      localStorage.setItem('loggedIn', 'true');
      
      // Solo mostrar animaci贸n de carga si es la primera vez
      const hasSeenLoadingAnimation = localStorage.getItem('hasSeenLoadingAnimation');
      if (!hasSeenLoadingAnimation) {
        localStorage.setItem('hasSeenLoadingAnimation', 'true');
        showDataLoadingAnimation();
      } else {
        // Si ya vio la animaci贸n, solo cerrar el modal directamente
        document.getElementById('loginModal').style.display = 'none';
        showWelcomeNotification();
      }
    }

    function showDataLoadingAnimation() {
      // Crear overlay de carga de datos
      const loadingOverlay = document.createElement('div');
      loadingOverlay.id = 'dataLoadingOverlay';
      loadingOverlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #1877f2 0%, #42a5f5 100%);
        z-index: 15000;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      `;

      loadingOverlay.innerHTML = `
        <div style="text-align: center; max-width: 400px; padding: 0 20px;">
          <!-- Logo y t铆tulo -->
          <div style="margin-bottom: 40px;">
            <div style="width: 80px; height: 80px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; backdrop-filter: blur(10px);">
              <i class="fa-solid fa-code" style="font-size: 36px; color: white;"></i>
            </div>
            <h1 style="margin: 0; font-size: 28px; font-weight: 700;">Clack</h1>
            <p style="margin: 10px 0 0 0; font-size: 16px; opacity: 0.9;">Cargando tu plataforma de desarrollo</p>
          </div>

          <!-- Progreso general -->
          <div style="margin-bottom: 40px; width: 100%;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
              <span style="font-size: 14px; font-weight: 600;" id="loadingMainText">Inicializando...</span>
              <span style="font-size: 14px; font-weight: 600;" id="loadingPercentage">0%</span>
            </div>
            <div style="width: 100%; height: 6px; background: rgba(255,255,255,0.2); border-radius: 3px; overflow: hidden;">
              <div id="loadingMainProgress" style="width: 0%; height: 100%; background: linear-gradient(90deg, #ffffff, rgba(255,255,255,0.8)); border-radius: 3px; transition: width 0.3s ease;"></div>
            </div>
          </div>

          <!-- Detalles de carga de datos -->
          <div style="width: 100%; max-width: 350px;">
            <h3 style="margin: 0 0 20px 0; font-size: 16px; font-weight: 600; opacity: 0.9;">Cargando componentes del sistema</h3>
            
            <!-- Editor de c贸digo -->
            <div class="data-item" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <div style="display: flex; align-items: center; gap: 12px;">
                <i class="fas fa-code" style="font-size: 16px; opacity: 0.8;"></i>
                <span style="font-size: 14px;">Editor de c贸digo</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span class="data-size" style="font-size: 12px; opacity: 0.7;">2.3 MB</span>
                <div class="loading-dot" style="width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; opacity: 0;"></div>
              </div>
            </div>

            <!-- Sistema de proyectos -->
            <div class="data-item" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <div style="display: flex; align-items: center; gap: 12px;">
                <i class="fas fa-folder" style="font-size: 16px; opacity: 0.8;"></i>
                <span style="font-size: 14px;">Sistema de proyectos</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span class="data-size" style="font-size: 12px; opacity: 0.7;">1.8 MB</span>
                <div class="loading-dot" style="width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; opacity: 0;"></div>
              </div>
            </div>

            <!-- Vista previa -->
            <div class="data-item" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <div style="display: flex; align-items: center; gap: 12px;">
                <i class="fas fa-eye" style="font-size: 16px; opacity: 0.8;"></i>
                <span style="font-size: 14px;">Motor de vista previa</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span class="data-size" style="font-size: 12px; opacity: 0.7;">3.1 MB</span>
                <div class="loading-dot" style="width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; opacity: 0;"></div>
              </div>
            </div>

            <!-- An谩lisis de seguridad -->
            <div class="data-item" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <div style="display: flex; align-items: center; gap: 12px;">
                <i class="fas fa-shield-alt" style="font-size: 16px; opacity: 0.8;"></i>
                <span style="font-size: 14px;">M贸dulo de seguridad</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span class="data-size" style="font-size: 12px; opacity: 0.7;">1.5 MB</span>
                <div class="loading-dot" style="width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; opacity: 0;"></div>
              </div>
            </div>

            <!-- Sistema de b煤squeda -->
            <div class="data-item" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <div style="display: flex; align-items: center; gap: 12px;">
                <i class="fas fa-search" style="font-size: 16px; opacity: 0.8;"></i>
                <span style="font-size: 14px;">Motor de b煤squeda</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span class="data-size" style="font-size: 12px; opacity: 0.7;">2.7 MB</span>
                <div class="loading-dot" style="width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; opacity: 0;"></div>
              </div>
            </div>

            <!-- Generador APK -->
            <div class="data-item" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <div style="display: flex; align-items: center; gap: 12px;">
                <i class="fas fa-mobile-alt" style="font-size: 16px; opacity: 0.8;"></i>
                <span style="font-size: 14px;">Generador de APK</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span class="data-size" style="font-size: 12px; opacity: 0.7;">4.2 MB</span>
                <div class="loading-dot" style="width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; opacity: 0;"></div>
              </div>
            </div>

            <!-- Asistente virtual -->
            <div class="data-item" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <div style="display: flex; align-items: center; gap: 12px;">
                <i class="fas fa-robot" style="font-size: 16px; opacity: 0.8;"></i>
                <span style="font-size: 14px;">Asistente virtual</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span class="data-size" style="font-size: 12px; opacity: 0.7;">3.9 MB</span>
                <div class="loading-dot" style="width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; opacity: 0;"></div>
              </div>
            </div>

            <!-- Configuraciones -->
            <div class="data-item" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0;">
              <div style="display: flex; align-items: center; gap: 12px;">
                <i class="fas fa-cog" style="font-size: 16px; opacity: 0.8;"></i>
                <span style="font-size: 14px;">Configuraciones</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span class="data-size" style="font-size: 12px; opacity: 0.7;">0.8 MB</span>
                <div class="loading-dot" style="width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; opacity: 0;"></div>
              </div>
            </div>
          </div>

          <!-- Informaci贸n adicional -->
          <div style="margin-top: 30px; text-align: center;">
            <p style="margin: 0; font-size: 12px; opacity: 0.7;" id="loadingStatus">Preparando tu experiencia de desarrollo...</p>
            <p style="margin: 5px 0 0 0; font-size: 11px; opacity: 0.5;">Total estimado: <span id="totalSize">20.3 MB</span></p>
          </div>
        </div>
      `;

      document.body.appendChild(loadingOverlay);
      startDataLoadingAnimation();
    }

    function startDataLoadingAnimation() {
      const items = document.querySelectorAll('.data-item');
      const loadingDots = document.querySelectorAll('.loading-dot');
      const mainProgress = document.getElementById('loadingMainProgress');
      const mainText = document.getElementById('loadingMainText');
      const percentage = document.getElementById('loadingPercentage');
      const status = document.getElementById('loadingStatus');
      
      const loadingSteps = [
        { text: 'Conectando con GitHub...', status: 'Verificando credenciales de usuario' },
        { text: 'Inicializando entorno...', status: 'Configurando espacio de trabajo' },
        { text: 'Cargando editores...', status: 'Preparando herramientas de desarrollo' },
        { text: 'Configurando proyectos...', status: 'Sincronizando datos del usuario' },
        { text: 'Preparando vista previa...', status: 'Optimizando renderizado en tiempo real' },
        { text: 'Activando seguridad...', status: 'Implementando an谩lisis de c贸digo' },
        { text: 'Indexando b煤squeda...', status: 'Construyendo 铆ndices de contenido' },
        { text: 'Compilando herramientas...', status: 'Preparando generadores de aplicaciones' },
        { text: 'Cargando IA...', status: 'Inicializando asistente inteligente' },
        { text: 'Finalizando...', status: 'Aplicando configuraciones personales' }
      ];

      let currentStep = 0;
      let currentItem = 0;
      let totalProgress = 0;

      const stepInterval = setInterval(() => {
        if (currentStep < loadingSteps.length) {
          const step = loadingSteps[currentStep];
          mainText.textContent = step.text;
          status.textContent = step.status;
          
          totalProgress = Math.round((currentStep / loadingSteps.length) * 100);
          percentage.textContent = totalProgress + '%';
          mainProgress.style.width = totalProgress + '%';
          
          currentStep++;
        }
      }, 600);

      const itemInterval = setInterval(() => {
        if (currentItem < items.length) {
          const dot = loadingDots[currentItem];
          const item = items[currentItem];
          
          // Simular carga de datos con efectos visuales
          item.style.background = 'rgba(255,255,255,0.05)';
          item.style.transform = 'scale(1.02)';
          item.style.transition = 'all 0.3s ease';
          
          setTimeout(() => {
            dot.style.opacity = '1';
            dot.style.animation = 'pulse 0.5s ease';
            item.style.background = 'transparent';
            item.style.transform = 'scale(1)';
            
            // Efecto de bytes carg谩ndose
            const sizeElement = item.querySelector('.data-size');
            let currentSize = 0;
            const targetSize = parseFloat(sizeElement.textContent);
            const sizeInterval = setInterval(() => {
              currentSize += targetSize / 20;
              if (currentSize >= targetSize) {
                currentSize = targetSize;
                clearInterval(sizeInterval);
              }
              sizeElement.textContent = currentSize.toFixed(1) + ' MB';
            }, 50);
            
          }, 300);
          
          currentItem++;
        }
      }, 800);

      // Completar carga despu茅s de 8 segundos
      setTimeout(() => {
        clearInterval(stepInterval);
        clearInterval(itemInterval);
        
        mainText.textContent = '隆Listo para programar!';
        status.textContent = 'Tu plataforma de desarrollo est谩 lista';
        percentage.textContent = '100%';
        mainProgress.style.width = '100%';
        
        // Animaci贸n de finalizaci贸n
        setTimeout(() => {
          const overlay = document.getElementById('dataLoadingOverlay');
          overlay.style.animation = 'fadeOut 1s forwards';
          
          setTimeout(() => {
            overlay.remove();
            document.getElementById('loginModal').style.display = 'none';
            
            // Mostrar notificaci贸n de bienvenida
            showWelcomeNotification();
          }, 1000);
        }, 1500);
      }, 8000);
    }

    function showWelcomeNotification() {
      // Funci贸n removida - ya no muestra notificaci贸n de bienvenida
    }

    /* ========================
       Funciones de Vista Previa
       ======================== */
    function runScanAnimation() {
      const scanOverlay = document.getElementById('scanOverlay');
      scanOverlay.style.display = 'block';
      scanOverlay.style.animation = 'scanEffect 5s forwards';
      setTimeout(() => { scanOverlay.style.display = 'none'; }, 5000);
    }

    /* ========================
       Validaci贸n HTML Simple
       ======================== */

    /* ========================
       Funciones de B煤squeda (YouTube y Wikipedia)
       ======================== */
    function toggleSearchOverlay(show) { document.getElementById('searchOverlay').style.display = show ? 'block' : 'none'; }
    function toggleVideoPlayerOverlay(show, videoId = "") {
      const playerOverlay = document.getElementById('videoPlayerOverlay');
      if (show) {
        playerOverlay.style.display = 'flex';
        document.getElementById('videoPlayerFrame').src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
      } else {
        playerOverlay.style.display = 'none';
        document.getElementById('videoPlayerFrame').src = "";
      }
    }
    
    async function searchWikipedia() {
      const searchInput = document.getElementById('searchInput').value.trim();
      if (!searchInput) return;
      addRecentSearch(searchInput);
      document.getElementById('searchSpinner').style.display = 'block';
      document.getElementById('searchResults').innerHTML = "";
      const url = `https://es.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(searchInput)}&format=json&origin=*`;
      try {
        const resp = await fetch(url);
        const data = await resp.json();
        document.getElementById('searchSpinner').style.display = 'none';
        if (data.query && data.query.search && data.query.search.length > 0) {
          const resultsDiv = document.getElementById('searchResults');
          resultsDiv.innerHTML = "";
          data.query.search.forEach(item => {
            const title = item.title;
            const snippet = item.snippet;
            const card = document.createElement('div');
            card.className = 'video-card';
            card.innerHTML = `<div class="video-info">
              <h3>${title}</h3>
              <p>${snippet}</p>
              </div>
              <div class="video-actions">
                <button class="openArticleBtn" data-title="${title}">
                  <i class="fas fa-book-reader" style="margin-right: 5px;"></i>
                  Abrir Art铆culo
                </button>
              </div>`;
            resultsDiv.appendChild(card);
          });
          document.querySelectorAll('.openArticleBtn').forEach(btn => {
            btn.addEventListener('click', e => {
              e.preventDefault();
              e.stopPropagation();
              
              const button = e.currentTarget;
              const title = button.getAttribute('data-title');
              const card = button.closest('.video-card');
              const snippet = card.querySelector('p').textContent;
              
              console.log('Abriendo art铆culo:', title);
              openArticleOverlay(title, snippet);
            });
          });
        } else {
          document.getElementById('searchResults').innerHTML = `<p>${getTranslation("searchNoResults")}</p>`;
        }
      } catch (err) { console.error("Error buscando en Wikipedia:", err); document.getElementById('searchSpinner').style.display = 'none'; }
    }
    function executeSearch() {
      searchWikipedia();
    }

    /* ========================
       Funciones de B煤squedas Recientes y Tendencias
       ======================== */
    function loadRecentSearches() {
      const recent = localStorage.getItem('recentSearches');
      return recent ? JSON.parse(recent) : [];
    }
    function saveRecentSearches(searches) {
      localStorage.setItem('recentSearches', JSON.stringify(searches));
    }
    function addRecentSearch(term) {
      let recent = loadRecentSearches();
      if (!recent.includes(term)) { recent.unshift(term); if(recent.length > 10) recent = recent.slice(0,10); }
      saveRecentSearches(recent);
      renderRecentSearches();
    }
    function renderRecentSearches() {
      const recent = loadRecentSearches();
      const list = document.getElementById('recentList');
      list.innerHTML = "";
      recent.forEach(term => {
        const li = document.createElement('li');
        li.textContent = term;

        // Agregar bot贸n de eliminar
        const deleteAction = document.createElement('div');
        deleteAction.className = 'delete-action';
        deleteAction.innerHTML = '<i class="fas fa-trash"></i>';
        li.appendChild(deleteAction);

        // Variables para el deslizamiento
        let startX = 0;
        let currentX = 0;

        li.addEventListener('touchstart', (e) => {
          startX = e.touches[0].clientX;
          li.classList.add('swiping');
        });

        li.addEventListener('touchmove', (e) => {
          currentX = e.touches[0].clientX;
          const diff = currentX - startX;
          if (diff < 0) { // Solo permitir deslizar hacia la izquierda
            li.style.transform = `translateX(${diff}px)`;
            if (diff < -50) {
              li.classList.add('show-delete');
            } else {
              li.classList.remove('show-delete');
            }
          }
        });

        li.addEventListener('touchend', () => {
          li.classList.remove('swiping');
          const diff = currentX - startX;
          if (diff < -50) {
            // Eliminar la b煤squeda
            const searches = loadRecentSearches();
            const newSearches = searches.filter(s => s !== term);
            saveRecentSearches(newSearches);
            li.style.transform = 'translateX(-100%)';
            li.style.opacity = '0';
            setTimeout(() => {
              renderRecentSearches();
            }, 300);
          } else {
            li.style.transform = '';
            li.classList.remove('show-delete');
          }
        });

        li.addEventListener('click', () => { 
          if (!li.classList.contains('show-delete')) {
            document.getElementById('searchInput').value = term; 
            executeSearch(); 
          }
        });

        list.appendChild(li);
      });
    }
    // Funciones de art铆culos completos
    function openArticleOverlay(title, content) {
      console.log('Funci贸n openArticleOverlay llamada con:', { title, content });
      
      const overlay = document.getElementById('articleOverlay');
      const articleTitle = document.getElementById('articleTitle');
      const articleBody = document.getElementById('articleBody');
      const articleDate = document.getElementById('articleDate');
      
      if (!overlay || !articleTitle || !articleBody || !articleDate) {
        console.error('No se encontraron elementos del overlay de art铆culo');
        return;
      }
      
      // Detener cualquier lectura anterior
      if (isReading) {
        stopReading();
      }
      
      // Resetear bot贸n de lector
      updateReaderButton(false);
      
      articleTitle.textContent = title;
      articleDate.textContent = new Date().toLocaleDateString();
      
      // Simular contenido completo del art铆culo
      articleBody.innerHTML = `
        <p style="margin-bottom: 20px;">${content}</p>
        <p style="margin-bottom: 20px;">Este es un art铆culo completo con contenido expandido para demostrar la funcionalidad de lectura. En una implementaci贸n real, este contenido vendr铆a de la API de Wikipedia con el texto completo del art铆culo.</p>
        <p style="margin-bottom: 20px;">Los usuarios pueden navegar por el contenido completo, interactuar con funciones como seguir al autor (Wikipedia en este caso), dar like al art铆culo, guardarlo en favoritos o reportarlo si encuentran contenido inapropiado.</p>
        <p style="margin-bottom: 20px;">La interfaz est谩 dise帽ada para proporcionar una experiencia de lectura limpia y moderna, enfoc谩ndose en el contenido educativo y la facilidad de navegaci贸n.</p>
        <p>Al final del art铆culo, los usuarios pueden encontrar art铆culos relacionados generados din谩micamente para continuar su exploraci贸n del tema.</p>
      `;
      
      // Generar art铆culos relacionados
      generateRelatedArticles(title);
      
      overlay.style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closeArticleOverlay() {
      const overlay = document.getElementById('articleOverlay');
      overlay.style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    async function generateRelatedArticles(mainTitle) {
      const relatedList = document.getElementById('relatedArticlesList');
      
      // Mostrar skeleton de carga
      relatedList.innerHTML = `
        <div style="display: flex; flex-direction: column; gap: 15px;">
          <div style="height: 80px; background: #2f3336; border-radius: 12px; position: relative; overflow: hidden;">
            <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent); animation: skeletonShimmer 1.8s infinite;"></div>
          </div>
          <div style="height: 80px; background: #2f3336; border-radius: 12px; position: relative; overflow: hidden;">
            <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent); animation: skeletonShimmer 1.8s infinite;"></div>
          </div>
          <div style="height: 80px; background: #2f3336; border-radius: 12px; position: relative; overflow: hidden;">
            <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent); animation: skeletonShimmer 1.8s infinite;"></div>
          </div>
        </div>
      `;

      try {
        // Buscar art铆culos relacionados reales usando Wikipedia API
        const searchTerms = mainTitle.split(' ').slice(0, 2).join(' ');
        const url = `https://es.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(searchTerms)}&format=json&origin=*&srlimit=4`;
        
        const response = await fetch(url);
        const data = await response.json();
        
        // Esperar un poco para mostrar el skeleton
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        relatedList.innerHTML = '';
        
        if (data.query && data.query.search && data.query.search.length > 0) {
          // Excluir el art铆culo actual y tomar los primeros 3
          const relatedArticles = data.query.search
            .filter(article => article.title !== mainTitle)
            .slice(0, 3);
          
          relatedArticles.forEach((article, index) => {
            const item = document.createElement('div');
            item.className = 'related-article-item';
            
            // Iconos tem谩ticos din谩micos
            const icons = ['', '', '', '', '', '★'];
            const randomIcon = icons[index % icons.length];
            
            item.innerHTML = `
              <div style="display: flex; align-items: center; gap: 15px;">
                <div style="width: 60px; height: 60px; background: linear-gradient(45deg, #1d9bf0, #1a8cd8); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 24px;">
                  ${randomIcon}
                </div>
                <div style="flex: 1;">
                  <h4 style="color: #ffffff; font-size: 16px; font-weight: 600; margin: 0 0 5px 0;">${article.title}</h4>
                  <p style="color: #71767b; font-size: 14px; margin: 0; line-height: 1.3;">${article.snippet.substring(0, 80)}...</p>
                  <div style="margin-top: 5px;">
                    <span style="color: #1d9bf0; font-size: 12px;">
                      <i class="fas fa-clock" style="margin-right: 4px;"></i>
                      ${Math.floor(Math.random() * 8) + 3} min de lectura
                    </span>
                  </div>
                </div>
                <i class="fas fa-chevron-right" style="color: #71767b; font-size: 14px;"></i>
              </div>
            `;
            
            item.addEventListener('click', () => {
              openArticleOverlay(article.title, article.snippet);
            });
            
            relatedList.appendChild(item);
          });
        } else {
          // Fallback si no hay resultados de la API
          relatedList.innerHTML = `
            <div style="text-align: center; color: #71767b; padding: 20px;">
              <i class="fas fa-search" style="font-size: 24px; margin-bottom: 10px;"></i>
              <p>No se encontraron art铆culos relacionados en este momento.</p>
            </div>
          `;
        }
      } catch (error) {
        console.error('Error cargando art铆culos relacionados:', error);
        relatedList.innerHTML = `
          <div style="text-align: center; color: #71767b; padding: 20px;">
            <i class="fas fa-exclamation-triangle" style="font-size: 24px; margin-bottom: 10px;"></i>
            <p>Error al cargar art铆culos relacionados.</p>
          </div>
        `;
      }
    }

    function toggleArticleLike() {
      const likeBtn = document.getElementById('likeArticle');
      const likeCount = document.getElementById('likeCount');
      const icon = likeBtn.querySelector('i');
      
      if (likeBtn.classList.contains('liked')) {
        likeBtn.classList.remove('liked');
        icon.className = 'far fa-heart';
        likeCount.textContent = parseInt(likeCount.textContent) - 1;
      } else {
        likeBtn.classList.add('liked');
        icon.className = 'fas fa-heart';
        likeCount.textContent = parseInt(likeCount.textContent) + 1;
        
        // Animaci贸n de coraz贸n
        const heart = document.createElement('div');
        heart.innerHTML = 'わ';
        heart.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 60px;
          pointer-events: none;
          z-index: 18000;
          animation: likePop 0.8s forwards;
        `;
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 800);
      }
    }

    function toggleFollow() {
      const followBtn = document.getElementById('followAuthor');
      
      if (followBtn.classList.contains('following')) {
        followBtn.classList.remove('following');
        followBtn.textContent = 'Seguir';
        followBtn.style.background = '#1d9bf0';
        followBtn.style.color = 'white';
        followBtn.style.border = 'none';
      } else {
        followBtn.classList.add('following');
        followBtn.textContent = 'Siguiendo';
        followBtn.style.background = 'transparent';
        followBtn.style.color = '#1d9bf0';
        followBtn.style.border = '1px solid #1d9bf0';
      }
    }

    function toggleBookmark() {
      const bookmarkBtn = document.getElementById('bookmarkArticle');
      const icon = bookmarkBtn.querySelector('i');
      
      if (bookmarkBtn.classList.contains('bookmarked')) {
        bookmarkBtn.classList.remove('bookmarked');
        icon.className = 'far fa-bookmark';
        bookmarkBtn.querySelector('span').textContent = 'Guardar';
      } else {
        bookmarkBtn.classList.add('bookmarked');
        icon.className = 'fas fa-bookmark';
        bookmarkBtn.querySelector('span').textContent = 'Guardado';
      }
    }

    

    function openReportArticleModal() {
      const modal = document.getElementById('reportArticleModal');
      const articleTitle = document.getElementById('articleTitle');
      const reportArticleTitle = document.getElementById('reportArticleTitle');
      
      // Establecer el t铆tulo del art铆culo en el modal
      if (articleTitle && reportArticleTitle) {
        reportArticleTitle.textContent = articleTitle.textContent;
      }
      
      modal.style.display = 'block';
      document.body.style.overflow = 'hidden';
      
      // Resetear formulario
      resetReportModal();
    }

    function closeReportArticleModal() {
      const modal = document.getElementById('reportArticleModal');
      modal.style.display = 'none';
      document.body.style.overflow = 'auto';
      resetReportModal();
    }

    function resetReportModal() {
      // Resetear selecci贸n de motivos
      document.querySelectorAll('.report-reason-option').forEach(option => {
        option.style.borderColor = '#2f3336';
        option.style.background = '#000000';
        option.classList.remove('selected');
      });
      
      // Resetear textarea
      document.getElementById('reportDetails').value = '';
      document.getElementById('reportCharCount').textContent = '0';
      
      // Resetear bot贸n de env铆o
      const submitBtn = document.getElementById('submitArticleReport');
      submitBtn.style.opacity = '0.5';
      submitBtn.style.pointerEvents = 'none';
      
      selectedReportReason = null;
    }

    let selectedReportReason = null;

    function submitArticleReport() {
      if (!selectedReportReason) {
        showNotification('Por favor selecciona un motivo para el reporte', 'error');
        return;
      }
      
      const details = document.getElementById('reportDetails').value;
      const articleTitle = document.getElementById('reportArticleTitle').textContent;
      
      // Simular env铆o del reporte con animaci贸n
      const submitBtn = document.getElementById('submitArticleReport');
      const originalText = submitBtn.innerHTML;
      
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin" style="margin-right: 8px;"></i>Enviando...';
      submitBtn.style.pointerEvents = 'none';
      
      setTimeout(() => {
        closeReportArticleModal();
        showNotification(' Reporte enviado exitosamente. Nuestro equipo lo revisar谩 pronto.', 'success');
        
        // Resetear bot贸n
        submitBtn.innerHTML = originalText;
        submitBtn.style.pointerEvents = 'auto';
      }, 2000);
    }

    // Cargar voces disponibles
    function loadAvailableVoices() {
      availableVoices = speechSynthesis.getVoices();
      
      // Si las voces no est谩n cargadas, esperar el evento
      if (availableVoices.length === 0) {
        speechSynthesis.onvoiceschanged = () => {
          availableVoices = speechSynthesis.getVoices();
        };
      }
    }

    // Obtener mejor voz para el idioma
    function getBestVoiceForLanguage(lang) {
      if (availableVoices.length === 0) {
        loadAvailableVoices();
      }

      const voiceLangMap = {
        'es': ['es-ES', 'es-MX', 'es-AR', 'es'],
        'en': ['en-US', 'en-GB', 'en-AU', 'en'],
        'pt': ['pt-BR', 'pt-PT', 'pt'],
        'ko': ['ko-KR', 'ko'],
        'vi': ['vi-VN', 'vi'],
        'zh': ['zh-CN', 'zh-TW', 'zh'],
        'ja': ['ja-JP', 'ja'],
        'fr': ['fr-FR', 'fr-CA', 'fr'],
        'de': ['de-DE', 'de'],
        'it': ['it-IT', 'it'],
        'ru': ['ru-RU', 'ru']
      };

      const preferredLangs = voiceLangMap[lang] || [lang];
      
      // Buscar voz nativa preferida
      for (const prefLang of preferredLangs) {
        const voice = availableVoices.find(v => 
          v.lang.toLowerCase().startsWith(prefLang.toLowerCase()) && 
          v.localService
        );
        if (voice) return voice;
      }
      
      // Buscar cualquier voz del idioma
      for (const prefLang of preferredLangs) {
        const voice = availableVoices.find(v => 
          v.lang.toLowerCase().startsWith(prefLang.toLowerCase())
        );
        if (voice) return voice;
      }
      
      // Fallback a voz por defecto
      return availableVoices.find(v => v.default) || availableVoices[0] || null;
    }

    // Traducir texto usando Google Translate API gratuita
    async function translateArticleText(text, targetLang) {
      if (targetLang === 'es') return text;
      
      try {
        const chunks = text.match(/.{1,4500}/g) || [text]; // Dividir en chunks para evitar l铆mites
        let translatedText = '';
        
        for (const chunk of chunks) {
          const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=es&tl=${targetLang}&dt=t&q=${encodeURIComponent(chunk)}`;
          
          const response = await fetch(url);
          if (!response.ok) throw new Error(`Error HTTP: ${response.status}`);
          
          const result = await response.json();
          
          if (result && result[0] && Array.isArray(result[0])) {
            result[0].forEach(item => {
              if (item && item[0]) {
                translatedText += item[0];
              }
            });
          }
          
          // Peque帽a pausa entre requests para no sobrecargar la API
          await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        return translatedText || text;
      } catch (error) {
        console.error('Error de traducci贸n:', error);
        return text; // Retornar texto original si falla
      }
    }

    // Funci贸n para leer art铆culo con voz mejorada y traducci贸n
    async function toggleArticleReader() {
      const readerBtn = document.getElementById('readerArticle');
      const readerIcon = document.getElementById('readerIcon');
      const readerText = document.getElementById('readerText');
      
      if (!speechSynthesis) {
        showNotification('La s铆ntesis de voz no est谩 disponible en este navegador', 'error');
        return;
      }
      
      if (isReading) {
        stopReading();
      } else {
        await startReading();
      }
    }

    async function startReading() {
      // Obtener texto del art铆culo
      const articleTitle = document.getElementById('articleTitle').textContent;
      const articleBody = document.getElementById('articleBody').textContent;
      
      // Crear texto completo
      let fullText = `${articleTitle}. ${articleBody}`;
      
      if (fullText.trim() === '') {
        showNotification('No hay contenido para leer', 'info');
        return;
      }
      
      // Detener cualquier lectura anterior
      speechSynthesis.cancel();
      
      // Cargar voces si no est谩n disponibles
      if (availableVoices.length === 0) {
        loadAvailableVoices();
        await new Promise(resolve => setTimeout(resolve, 500)); // Esperar a que se carguen
      }
      
      // Determinar idioma objetivo
      const targetLang = currentLang === 'es' ? 'es' : currentLang;
      
      // Mostrar indicador de procesamiento
      updateReaderButton(true, 'Procesando...');
      
      try {
        // Traducir si es necesario
        if (targetLang !== 'es') {
          isTranslating = true;
          showNotification(` Traduciendo art铆culo a ${getLanguageName(targetLang)}...`, 'info');
          
          fullText = await translateArticleText(fullText, targetLang);
          
          isTranslating = false;
          showNotification(` Art铆culo traducido a ${getLanguageName(targetLang)}`, 'success');
        }
        
        // Obtener mejor voz para el idioma
        const selectedVoice = getBestVoiceForLanguage(targetLang);
        
        // Crear nueva s铆ntesis de voz
        currentUtterance = new SpeechSynthesisUtterance(fullText);
        
        // Configurar voz y par谩metros mejorados
        if (selectedVoice) {
          currentUtterance.voice = selectedVoice;
          currentUtterance.lang = selectedVoice.lang;
          console.log(`Usando voz: ${selectedVoice.name} (${selectedVoice.lang})`);
        } else {
          const voiceLangs = {
            'es': 'es-ES',
            'en': 'en-US',
            'pt': 'pt-BR',
            'ko': 'ko-KR',
            'vi': 'vi-VN',
            'zh': 'zh-CN',
            'ja': 'ja-JP',
            'fr': 'fr-FR',
            'de': 'de-DE',
            'it': 'it-IT',
            'ru': 'ru-RU'
          };
          currentUtterance.lang = voiceLangs[targetLang] || 'es-ES';
        }
        
        // Configurar par谩metros de voz optimizados
        currentUtterance.rate = 0.85; // Velocidad m谩s natural
        currentUtterance.pitch = 1.1; // Tono ligeramente m谩s alto
        currentUtterance.volume = 0.9; // Volumen 贸ptimo
        
        // Eventos de la s铆ntesis de voz
        currentUtterance.onstart = function() {
          isReading = true;
          updateReaderButton(true, 'Leyendo...');
          const voiceName = selectedVoice ? selectedVoice.name : 'Voz del sistema';
          showNotification(` Iniciando lectura con ${voiceName}`, 'info');
        };
        
        currentUtterance.onend = function() {
          isReading = false;
          updateReaderButton(false);
          showNotification(' Lectura completada', 'success');
        };
        
        currentUtterance.onerror = function(event) {
          isReading = false;
          updateReaderButton(false);
          showNotification(' Error durante la lectura: ' + event.error, 'error');
          console.error('Error de s铆ntesis de voz:', event.error);
        };
        
        currentUtterance.onpause = function() {
          isReading = false;
          updateReaderButton(false);
        };
        
        currentUtterance.onresume = function() {
          isReading = true;
          updateReaderButton(true, 'Leyendo...');
        };
        
        // Iniciar lectura
        speechSynthesis.speak(currentUtterance);
        
      } catch (error) {
        console.error('Error al procesar art铆culo para lectura:', error);
        showNotification(' Error al procesar el art铆culo', 'error');
        isReading = false;
        isTranslating = false;
        updateReaderButton(false);
      }
    }
    
    // Funci贸n auxiliar para obtener nombre del idioma
    function getLanguageName(lang) {
      const languageNames = {
        'es': 'Espa帽ol',
        'en': 'Ingl茅s',
        'pt': 'Portugu茅s',
        'ko': '甑',
        'vi': 'Ti岷ng Vi峄t',
        'zh': '涓',
        'ja': 'ユ瑾',
        'fr': 'Fran莽ais',
        'de': 'Deutsch',
        'it': 'Italiano',
        'ru': '泻懈泄'
      };
      return languageNames[lang] || lang.toUpperCase();
    }

    function stopReading() {
      if (speechSynthesis && currentUtterance) {
        speechSynthesis.cancel();
        isReading = false;
        isTranslating = false;
        updateReaderButton(false);
        showNotification('革 Lectura detenida', 'info');
      }
    }

    function updateReaderButton(reading, customText = null) {
      const readerBtn = document.getElementById('readerArticle');
      const readerIcon = document.getElementById('readerIcon');
      const readerText = document.getElementById('readerText');
      
      if (reading) {
        readerBtn.classList.add('reading');
        if (isTranslating) {
          readerIcon.className = 'fas fa-language';
          readerText.textContent = customText || 'Traduciendo...';
        } else {
          readerIcon.className = 'fas fa-stop';
          readerText.textContent = customText || 'Detener';
        }
      } else {
        readerBtn.classList.remove('reading');
        readerIcon.className = 'fas fa-volume-up';
        readerText.textContent = 'Lector';
      }
    }

    // Funci贸n para pausar/reanudar lectura cuando se cierra el art铆culo
    function closeArticleOverlay() {
      console.log('Cerrando overlay de art铆culo');
      const overlay = document.getElementById('articleOverlay');
      
      if (!overlay) {
        console.error('No se encontr贸 el overlay de art铆culo');
        return;
      }
      
      // Detener lectura si est谩 activa
      if (isReading) {
        stopReading();
      }
      
      overlay.style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    /* ========================
       Funciones de Reporte de Video
       ======================== */
    function openReportModal() { document.getElementById('reportModal').style.display = 'flex'; }
    function closeReportModal() { document.getElementById('reportModal').style.display = 'none'; }
    function submitReport() {
      alert("Reporte enviado. Pronto se revisar谩 el reporte.");
      closeReportModal();
    }

    /*************************************************
     *    EVENTOS AL CARGAR LA PGINA
     *************************************************/
    function updateLineNumbers(editor, lineNumbersElement) {
      const lines = editor.value.split('\n').length;
      let lineNumbers = [];
      for (let i = 1; i <= lines; i++) {
        lineNumbers.push(i);
      }
      lineNumbersElement.textContent = lineNumbers.join('\n');

      // Ajustar el ancho seg煤n el n煤mero de d铆gitos
      const maxDigits = String(lines).length;
      lineNumbersElement.style.width = (maxDigits * 10 + 25) + 'px';
    }

    function updateSyntaxHighlight(editor, highlightElement, language) {
      let code = editor.value;

      // Patrones b谩sicos de resaltado
      const patterns = {
        keyword: /\b(function|return|const|let|var|if|else|for|while|class|import|export|default|async|await)\b/g,
        string: /"([^"\\]|\\.)*"|'([^'\\]|\\.)*'/g,
        number: /\b\d+(\.\d+)?\b/g,
        function: /\b\w+(?=\()/g,
        comment: /\/\/.*|\/\*[\s\S]*?\*\//g
      };

      // Aplicar resaltado
      let highlighted = code;
      for (const [type, pattern] of Object.entries(patterns)) {
        highlighted = highlighted.replace(pattern, match => 
          `<span class="${type}">${match}</span>`
        );
      }

      highlightElement.innerHTML = highlighted;
    }

    // Funciones de herramientas de vista previa
function initPreviewTools() {
  let currentZoom = 1;
  const frame = document.getElementById('previewFrame');

  document.getElementById('zoomInBtn').addEventListener('click', () => {
    currentZoom = Math.min(currentZoom + 0.1, 2);
    frame.style.transform = `scale(${currentZoom})`;
  });

  document.getElementById('zoomOutBtn').addEventListener('click', () => {
    currentZoom = Math.max(currentZoom - 0.1, 0.5);
    frame.style.transform = `scale(${currentZoom})`;
  });

  document.getElementById('scanBtn').addEventListener('click', () => {
    const scanAnimation = document.getElementById('scanAnimation');
    const scanResults = scanAnimation.querySelector('.scan-results');
    scanAnimation.style.display = 'block';

    // Create particles container
    const particles = document.createElement('div');
    particles.className = 'particles';
    scanAnimation.appendChild(particles);

    // Generate particles
    function createParticle(x, y) {
      const particle = document.createElement('div');
      particle.className = 'particle';
      particle.style.left = x + 'px';
      particle.style.top = y + 'px';
      particle.style.width = Math.random() * 4 + 2 + 'px';
      particle.style.height = particle.style.width;
      particles.appendChild(particle);

      setTimeout(() => particle.remove(), 2000);
    }

    // Analyze code sections
    const codeElements = [
      { elem: htmlEditor, type: 'HTML' },
      { elem: cssEditor, type: 'CSS' },
      { elem: jsEditor, type: 'JavaScript' }
    ];

    let currentElement = 0;
    let totalIssues = 0;
    let progress = 0;

    scanResults.style.display = 'block';
    scanResults.innerHTML = `
      <h3>An谩lisis de Seguridad en Tiempo Real</h3>
      <p>Iniciando escaneo...</p>
      <div class="progress"></div>
    `;

    const analyzeInterval = setInterval(() => {
      if (currentElement < codeElements.length) {
        const { elem, type } = codeElements[currentElement];
        const code = elem.value;

        // Create floating particles
        for (let i = 0; i < 3; i++) {
          createParticle(
            Math.random() * scanAnimation.offsetWidth,
            Math.random() * scanAnimation.offsetHeight
          );
        }

        // Simulate code analysis
        let issues = [];
        if (type === 'HTML') {
          if (code.includes('<script>')) issues.push('Script inline detectado');
          if (!code.includes('<!DOCTYPE html>')) issues.push('Falta DOCTYPE');
        } else if (type === 'CSS') {
          if (code.includes('!important')) issues.push('Uso de !important');
        } else if (type === 'JavaScript') {
          if (code.includes('eval(')) issues.push('Uso de eval()');
        }

        totalIssues += issues.length;
        progress = Math.min(100, ((currentElement + 1) / codeElements.length) * 100);

        scanResults.innerHTML = `
          <h3>An谩lisis de Seguridad en Tiempo Real</h3>
          <p>Analizando ${type}...</p>
          <div class="progress">Progreso: ${Math.floor(progress)}%</div>
          <div class="issues">Problemas encontrados: ${totalIssues}</div>
          ${issues.length ? '<ul>' + issues.map(i => `<li>${i}</li>`).join('') + '</ul>' : ''}
        `;

        currentElement++;
      } else {
        clearInterval(analyzeInterval);

        scanResults.innerHTML = `
          <h3>An谩lisis Completado </h3>
          <p>${totalIssues > 0 ? `Se encontraron ${totalIssues} problemas` : 'No se encontraron amenazas'}</p>
          <p>Archivos analizados: ${codeElements.length}</p>
          <p>Seguridad general: ${totalIssues === 0 ? '100%' : Math.max(0, 100 - totalIssues * 10) + '%'}</p>
        `;

        setTimeout(() => {
          particles.remove();
          scanAnimation.style.display = 'none';
          scanResults.style.display = 'none';
        }, 3000);
      }
    }, 1000);
  });
}
    /* ========================
       Funciones de Navegaci贸n entre Secciones
       ======================== */
    function showSection(sectionName) {
      // Ocultar todas las secciones
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });

      // Mostrar la secci贸n seleccionada
      document.getElementById(sectionName).classList.add('active');

      // Actualizar navegaci贸n activa
      document.querySelectorAll('nav a').forEach(link => {
        link.classList.remove('active');
      });
      event.target.classList.add('active');
    }

    /* ========================
       Funciones de Proyectos
       ======================== */
    let currentProjectId = null;
    let projectHistory = {};
    let autoSaveInterval = null;

    function createNewProject() {
      const projectName = prompt('Nombre del nuevo proyecto:');
      if (!projectName || projectName.trim() === '') return;

      // Validar nombre 煤nico
      const projects = loadProjects();
      const existingProject = projects.find(p => p.name.toLowerCase() === projectName.toLowerCase());
      if (existingProject) {
        const shouldContinue = confirm(`Ya existe un proyecto llamado "${projectName}". 驴Crear de todas formas con un sufijo num茅rico?`);
        if (!shouldContinue) return;
      }

      const finalName = existingProject ? `${projectName} (${projects.length + 1})` : projectName;

      const newProject = {
        id: Date.now(),
        name: finalName,
        html: '<!DOCTYPE html>\n<html lang="es">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>' + finalName + '</title>\n</head>\n<body>\n    <h1>隆Hola Mundo!</h1>\n    <p>Este es tu nuevo proyecto en Clack.</p>\n</body>\n</html>',
        css: '/* Estilos para ' + finalName + ' */\nbody {\n    font-family: Arial, sans-serif;\n    margin: 0;\n    padding: 20px;\n    background-color: #f0f2f5;\n}\n\nh1 {\n    color: #1877f2;\n    text-align: center;\n}\n\np {\n    color: #333;\n    line-height: 1.6;\n}',
        js: '// JavaScript para ' + finalName + '\nconsole.log("隆Proyecto ' + finalName + ' cargado!");\n\n// Agregar interactividad aqu铆\ndocument.addEventListener("DOMContentLoaded", function() {\n    console.log("DOM completamente cargado");\n});',
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString(),
        description: '',
        tags: [],
        favorite: false
      };

      projects.push(newProject);
      saveProjects(projects);
      
      loadProject(newProject.id);
      renderProjectsList();
      document.getElementById('projectEditor').style.display = 'block';
      
      // Inicializar historial para el nuevo proyecto
      projectHistory[newProject.id] = [];
      
      showNotification(`Proyecto "${finalName}" creado exitosamente`, 'success');
      startAutoSave();
    }

    function saveProject(silent = false) {
      if (!currentProjectId) {
        if (!silent) alert('No hay proyecto activo para guardar');
        return;
      }

      if (!silent) showProjectActionSkeleton('save');

      const projectName = document.getElementById('projectName').value;
      const htmlCode = document.getElementById('htmlEditor').value;
      const cssCode = document.getElementById('cssEditor').value;
      const jsCode = document.getElementById('jsEditor').value;

      // Simular delay de guardado solo si no es silencioso
      const delay = silent ? 0 : 800;
      
      setTimeout(() => {
        let projects = loadProjects();
        const projectIndex = projects.findIndex(p => p.id === currentProjectId);
        
        if (projectIndex !== -1) {
          const oldProject = {...projects[projectIndex]};
          
          projects[projectIndex] = {
            ...projects[projectIndex],
            name: projectName,
            html: htmlCode,
            css: cssCode,
            js: jsCode,
            updatedAt: new Date().toISOString()
          };
          
          // Guardar en historial si hay cambios significativos
          if (!silent && hasSignificantChanges(oldProject, projects[projectIndex])) {
            saveToHistory(currentProjectId, oldProject);
          }
          
          saveProjects(projects);
          renderProjectsList();
          
          if (!silent) {
            hideProjectActionSkeleton();
            showNotification(`Proyecto "${projectName}" guardado exitosamente`, 'success');
          }
        }
      }, delay);
    }

    function hasSignificantChanges(oldProject, newProject) {
      const threshold = 10; // M铆nimo de caracteres cambiados
      const htmlDiff = Math.abs(oldProject.html.length - newProject.html.length);
      const cssDiff = Math.abs(oldProject.css.length - newProject.css.length);
      const jsDiff = Math.abs(oldProject.js.length - newProject.js.length);
      
      return htmlDiff > threshold || cssDiff > threshold || jsDiff > threshold;
    }

    function saveToHistory(projectId, projectState) {
      if (!projectHistory[projectId]) {
        projectHistory[projectId] = [];
      }
      
      projectHistory[projectId].push({
        ...projectState,
        savedAt: new Date().toISOString()
      });
      
      // Mantener solo las 煤ltimas 10 versiones
      if (projectHistory[projectId].length > 10) {
        projectHistory[projectId] = projectHistory[projectId].slice(-10);
      }
      
      localStorage.setItem('projectHistory', JSON.stringify(projectHistory));
    }

    function startAutoSave() {
      if (autoSaveInterval) clearInterval(autoSaveInterval);
      
      autoSaveInterval = setInterval(() => {
        if (currentProjectId) {
          saveProject(true); // Guardado silencioso
        }
      }, 30000); // Auto-guardar cada 30 segundos
    }

    function stopAutoSave() {
      if (autoSaveInterval) {
        clearInterval(autoSaveInterval);
        autoSaveInterval = null;
      }
    }

    function loadProject(projectId) {
      // Guardar proyecto actual antes de cambiar
      if (currentProjectId && currentProjectId !== projectId) {
        saveProject(true);
      }

      const projects = loadProjects();
      const project = projects.find(p => p.id === projectId);
      
      if (project) {
        currentProjectId = projectId;
        document.getElementById('projectName').value = project.name;
        document.getElementById('htmlEditor').value = project.html || '';
        document.getElementById('cssEditor').value = project.css || '';
        document.getElementById('jsEditor').value = project.js || '';
        
        // Actualizar n煤meros de l铆nea y resaltado
        updateLineNumbers(document.getElementById('htmlEditor'), document.getElementById('htmlLineNumbers'));
        updateLineNumbers(document.getElementById('cssEditor'), document.getElementById('cssLineNumbers'));
        updateLineNumbers(document.getElementById('jsEditor'), document.getElementById('jsLineNumbers'));
        
        updateSyntaxHighlight(document.getElementById('htmlEditor'), document.getElementById('htmlHighlight'), 'html');
        updateSyntaxHighlight(document.getElementById('cssEditor'), document.getElementById('cssHighlight'), 'css');
        updateSyntaxHighlight(document.getElementById('jsEditor'), document.getElementById('jsHighlight'), 'js');
        
        document.getElementById('projectEditor').style.display = 'block';
        
        // Cargar historial del proyecto
        if (!projectHistory[projectId]) {
          projectHistory[projectId] = [];
        }
        
        // Limpiar stack de undo/redo para el nuevo proyecto
        undoStack = [];
        redoStack = [];
        saveState();
        
        renderProjectsList(); // Actualizar lista para mostrar proyecto activo
        showNotification(`Proyecto "${project.name}" cargado`, 'info');
      }
    }

    function importProject() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      
      input.onchange = function(e) {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const importData = JSON.parse(e.target.result);
            
            // Validar estructura del archivo
            if (!importData.name || typeof importData.html === 'undefined') {
              throw new Error('Archivo de proyecto inv谩lido');
            }
            
            // Crear nuevo proyecto con datos importados
            const projects = loadProjects();
            let projectName = importData.name;
            
            // Verificar si el nombre ya existe
            const existingNames = projects.map(p => p.name.toLowerCase());
            let counter = 1;
            while (existingNames.includes(projectName.toLowerCase())) {
              projectName = `${importData.name} (${counter})`;
              counter++;
            }
            
            const newProject = {
              id: Date.now(),
              name: projectName,
              html: importData.html || '',
              css: importData.css || '',
              js: importData.js || '',
              createdAt: new Date().toISOString(),
              updatedAt: new Date().toISOString(),
              description: importData.description || '',
              tags: importData.tags || [],
              favorite: false
            };
            
            projects.push(newProject);
            saveProjects(projects);
            renderProjectsList();
            
            showNotification(`Proyecto "${projectName}" importado exitosamente`, 'success');
            
            // Preguntar si quiere abrir el proyecto importado
            if (confirm('驴Quieres abrir el proyecto importado ahora?')) {
              loadProject(newProject.id);
            }
            
          } catch (error) {
            console.error('Error importando proyecto:', error);
            showNotification('Error al importar proyecto: ' + error.message, 'error');
          }
        };
        
        reader.readAsText(file);
      };
      
      input.click();
    }

    function duplicateProject() {
      if (!currentProjectId) {
        alert('No hay proyecto activo para duplicar');
        return;
      }
      
      // Mostrar skeleton de duplicado
      showProjectActionSkeleton('duplicate');
      
      const projects = loadProjects();
      const project = projects.find(p => p.id === currentProjectId);
      
      if (project) {
        // Simular delay de duplicado
        setTimeout(() => {
          const newProject = {
            ...project,
            id: Date.now(),
            name: project.name + ' - Copia',
            createdAt: new Date().toISOString()
          };
          
          projects.push(newProject);
          saveProjects(projects);
          renderProjectsList();
          hideProjectActionSkeleton();
          showNotification('Proyecto duplicado exitosamente', 'success');
        }, 1200);
      }
    }

    function exportProject() {
      if (!currentProjectId) {
        alert('No hay proyecto activo para exportar');
        return;
      }
      
      // Mostrar skeleton de exportaci贸n
      showProjectActionSkeleton('export');
      
      const projects = loadProjects();
      const project = projects.find(p => p.id === currentProjectId);
      
      if (project) {
        // Simular delay de exportaci贸n
        setTimeout(() => {
          const exportData = {
            name: project.name,
            html: project.html || '',
            css: project.css || '',
            js: project.js || '',
            exportDate: new Date().toISOString()
          };
          
          const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `${project.name}.json`;
          a.click();
          URL.revokeObjectURL(url);
          
          hideProjectActionSkeleton();
          showNotification('Proyecto exportado exitosamente', 'success');
        }, 1000);
      }
    }

    function formatAllCode() {
      try {
        // Obtener el editor activo dependiendo de la secci贸n
        const currentSection = document.querySelector('.section.active').id;
        let htmlEditor, cssEditor, jsEditor;
        
        if (currentSection === 'proyectos') {
          htmlEditor = document.getElementById('htmlEditor');
          cssEditor = document.getElementById('cssEditor');
          jsEditor = document.getElementById('jsEditor');
        } else {
          htmlEditor = document.getElementById('htmlEditorMain');
          cssEditor = document.getElementById('cssEditorMain');
          jsEditor = document.getElementById('jsEditorMain');
        }
        
        let formatted = false;
        
        if (htmlEditor && htmlEditor.value.trim()) {
          const originalValue = htmlEditor.value;
          htmlEditor.value = formatHTML(htmlEditor.value);
          if (originalValue !== htmlEditor.value) formatted = true;
          updateLineNumbers(htmlEditor, document.getElementById(htmlEditor.id.replace('Editor', 'LineNumbers')));
        }
        
        if (cssEditor && cssEditor.value.trim()) {
          const originalValue = cssEditor.value;
          cssEditor.value = formatCSS(cssEditor.value);
          if (originalValue !== cssEditor.value) formatted = true;
          updateLineNumbers(cssEditor, document.getElementById(cssEditor.id.replace('Editor', 'LineNumbers')));
        }
        
        if (jsEditor && jsEditor.value.trim()) {
          const originalValue = jsEditor.value;
          jsEditor.value = formatJS(jsEditor.value);
          if (originalValue !== jsEditor.value) formatted = true;
          updateLineNumbers(jsEditor, document.getElementById(jsEditor.id.replace('Editor', 'LineNumbers')));
        }
        
        if (formatted) {
          showNotification('C贸digo formateado exitosamente', 'success');
        } else {
          showNotification('No hay c贸digo para formatear', 'info');
        }
      } catch (error) {
        console.error('Error al formatear:', error);
        showNotification('Error al formatear el c贸digo', 'error');
      }
    }

    function formatHTML(html) {
      if (!html || html.trim() === '') return html;
      
      // Formatear HTML b谩sico
      let formatted = html.trim();
      
      // A帽adir DOCTYPE si no existe
      if (!formatted.toLowerCase().includes('<!doctype')) {
        formatted = '<!DOCTYPE html>\n' + formatted;
      }
      
      // Formatear tags
      formatted = formatted
        .replace(/></g, '>\n<')
        .replace(/(<\/[^>]+>)/g, '$1\n')
        .replace(/(<[^/>]+>)/g, '$1\n')
        .replace(/\n\s*\n/g, '\n')
        .trim();
      
      // Indentar
      const lines = formatted.split('\n');
      let indentLevel = 0;
      const indentedLines = lines.map(line => {
        const trimmed = line.trim();
        if (trimmed === '') return '';
        
        if (trimmed.startsWith('</')) {
          indentLevel = Math.max(0, indentLevel - 1);
        }
        
        const indented = '  '.repeat(indentLevel) + trimmed;
        
        if (trimmed.startsWith('<') && !trimmed.startsWith('</') && !trimmed.endsWith('/>') && !['<br>', '<hr>', '<img', '<input', '<meta', '<link'].some(tag => trimmed.toLowerCase().startsWith(tag))) {
          indentLevel++;
        }
        
        return indented;
      });
      
      return indentedLines.join('\n');
    }

    function formatCSS(css) {
      if (!css || css.trim() === '') return css;
      
      let formatted = css.trim();
      
      // Formatear CSS
      formatted = formatted
        .replace(/\s*{\s*/g, ' {\n  ')
        .replace(/;\s*/g, ';\n  ')
        .replace(/\s*}\s*/g, '\n}\n\n')
        .replace(/,\s*/g, ',\n')
        .replace(/\n\s*\n\s*\n/g, '\n\n')
        .trim();
      
      return formatted;
    }

    function formatJS(js) {
      if (!js || js.trim() === '') return js;
      
      let formatted = js.trim();
      
      // Formatear JavaScript b谩sico
      formatted = formatted
        .replace(/\s*{\s*/g, ' {\n  ')
        .replace(/;\s*/g, ';\n  ')
        .replace(/\s*}\s*/g, '\n}\n\n')
        .replace(/,\s*/g, ', ')
        .replace(/\)\s*{/g, ') {\n  ')
        .replace(/\n\s*\n\s*\n/g, '\n\n')
        .trim();
      
      return formatted;
    }

    function findAndReplace() {
      const searchTerm = prompt('驴Qu茅 quieres buscar?');
      if (!searchTerm || searchTerm.trim() === '') {
        showNotification('B煤squeda cancelada', 'info');
        return;
      }
      
      const replaceTerm = prompt('驴Con qu茅 lo quieres reemplazar?');
      if (replaceTerm === null) {
        showNotification('Reemplazo cancelado', 'info');
        return;
      }
      
      // Determinar qu茅 editores usar
      const currentSection = document.querySelector('.section.active').id;
      let editors;
      
      if (currentSection === 'proyectos') {
        editors = ['htmlEditor', 'cssEditor', 'jsEditor'];
      } else {
        editors = ['htmlEditorMain', 'cssEditorMain', 'jsEditorMain'];
      }
      
      let totalReplacements = 0;
      let editorsModified = [];
      
      editors.forEach(editorId => {
        const editor = document.getElementById(editorId);
        if (editor && editor.value) {
          const originalValue = editor.value;
          const regex = new RegExp(searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
          const replacements = (originalValue.match(regex) || []).length;
          
          if (replacements > 0) {
            editor.value = originalValue.replace(regex, replaceTerm);
            totalReplacements += replacements;
            editorsModified.push(editorId.replace('Editor', '').replace('Main', '').toUpperCase());
            
            // Actualizar n煤meros de l铆nea
            const lineNumbersId = editorId.replace('Editor', 'LineNumbers');
            const lineNumbersElement = document.getElementById(lineNumbersId);
            if (lineNumbersElement) {
              updateLineNumbers(editor, lineNumbersElement);
            }
          }
        }
      });
      
      if (totalReplacements > 0) {
        showNotification(`${totalReplacements} reemplazos en ${editorsModified.join(', ')}`, 'success');
      } else {
        showNotification(`No se encontr贸 "${searchTerm}"`, 'info');
      }
    }

    function validateCode() {
      const currentSection = document.querySelector('.section.active').id;
      let htmlEditor, cssEditor, jsEditor;
      
      if (currentSection === 'proyectos') {
        htmlEditor = document.getElementById('htmlEditor');
        cssEditor = document.getElementById('cssEditor');
        jsEditor = document.getElementById('jsEditor');
      } else {
        htmlEditor = document.getElementById('htmlEditorMain');
        cssEditor = document.getElementById('cssEditorMain');
        jsEditor = document.getElementById('jsEditorMain');
      }
      
      let issues = [];
      let warnings = [];
      
      // Validaci贸n HTML
      if (htmlEditor && htmlEditor.value.trim()) {
        const htmlContent = htmlEditor.value;
        
        if (!htmlContent.toLowerCase().includes('<!doctype')) {
          issues.push('HTML: Falta declaraci贸n DOCTYPE');
        }
        
        if (!htmlContent.includes('<html')) {
          warnings.push('HTML: Se recomienda usar tag <html>');
        }
        
        if (!htmlContent.includes('<head>')) {
          warnings.push('HTML: Se recomienda usar tag <head>');
        }
        
        if (!htmlContent.includes('<body>')) {
          warnings.push('HTML: Se recomienda usar tag <body>');
        }
        
        // Verificar tags sin cerrar
        const openTags = (htmlContent.match(/<[a-zA-Z][^/>]*[^/]>/g) || []).length;
        const closeTags = (htmlContent.match(/<\/[a-zA-Z][^>]*>/g) || []).length;
        const selfClosing = (htmlContent.match(/<[^>]*\/>/g) || []).length;
        
        if (openTags - selfClosing !== closeTags) {
          issues.push('HTML: Tags HTML desbalanceados');
        }
      }
      
      // Validaci贸n CSS
      if (cssEditor && cssEditor.value.trim()) {
        const cssContent = cssEditor.value;
        const openBraces = (cssContent.match(/{/g) || []).length;
        const closeBraces = (cssContent.match(/}/g) || []).length;
        
        if (openBraces !== closeBraces) {
          issues.push('CSS: Llaves desbalanceadas');
        }
        
        if (cssContent.includes('!important')) {
          warnings.push('CSS: Uso excesivo de !important');
        }
      }
      
      // Validaci贸n JavaScript
      if (jsEditor && jsEditor.value.trim()) {
        const jsContent = jsEditor.value;
        
        const openParens = (jsContent.match(/\(/g) || []).length;
        const closeParens = (jsContent.match(/\)/g) || []).length;
        if (openParens !== closeParens) {
          issues.push('JS: Par茅ntesis desbalanceados');
        }
        
        const openBrackets = (jsContent.match(/\[/g) || []).length;
        const closeBrackets = (jsContent.match(/\]/g) || []).length;
        if (openBrackets !== closeBrackets) {
          issues.push('JS: Corchetes desbalanceados');
        }
        
        const openBraces = (jsContent.match(/{/g) || []).length;
        const closeBraces = (jsContent.match(/}/g) || []).length;
        if (openBraces !== closeBraces) {
          issues.push('JS: Llaves desbalanceadas');
        }
        
        if (jsContent.includes('eval(')) {
          warnings.push('JS: Uso de eval() puede ser peligroso');
        }
      }
      
      // Mostrar resultados
      let message = '';
      if (issues.length === 0 && warnings.length === 0) {
        showNotification(' C贸digo validado - Sin errores detectados', 'success');
      } else {
        if (issues.length > 0) {
          message += ' ERRORES:\n' + issues.join('\n') + '\n\n';
        }
        if (warnings.length > 0) {
          message += '锔 ADVERTENCIAS:\n' + warnings.join('\n');
        }
        
        // Crear modal personalizado para mostrar resultados
        const modal = document.createElement('div');
        modal.style.cssText = `
          position: fixed; top: 0; left: 0; width: 100%; height: 100%;
          background: rgba(0,0,0,0.8); z-index: 10000; display: flex;
          align-items: center; justify-content: center; padding: 20px;
        `;
        
        const content = document.createElement('div');
        content.style.cssText = `
          background: white; padding: 30px; border-radius: 10px;
          max-width: 500px; max-height: 70vh; overflow-y: auto;
          color: #333; text-align: left;
        `;
        
        content.innerHTML = `
          <h3 style="margin-bottom: 20px; color: #1877f2;">Resultados de Validaci贸n</h3>
          <pre style="white-space: pre-wrap; font-family: Arial, sans-serif;">${message}</pre>
          <button style="background: #1877f2; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 20px;" onclick="this.parentElement.parentElement.remove()">Cerrar</button>
        `;
        
        modal.appendChild(content);
        document.body.appendChild(modal);
      }
    }

    function clearAllEditors() {
      const currentSection = document.querySelector('.section.active').id;
      let htmlEditor, cssEditor, jsEditor;
      
      if (currentSection === 'proyectos') {
        htmlEditor = document.getElementById('htmlEditor');
        cssEditor = document.getElementById('cssEditor');
        jsEditor = document.getElementById('jsEditor');
      } else {
        htmlEditor = document.getElementById('htmlEditorMain');
        cssEditor = document.getElementById('cssEditorMain');
        jsEditor = document.getElementById('jsEditorMain');
      }
      
      if (confirm('驴Est谩s seguro de que quieres limpiar todo el c贸digo?')) {
        let cleared = false;
        
        if (htmlEditor) {
          htmlEditor.value = '';
          updateLineNumbers(htmlEditor, document.getElementById(htmlEditor.id.replace('Editor', 'LineNumbers')));
          cleared = true;
        }
        if (cssEditor) {
          cssEditor.value = '';
          updateLineNumbers(cssEditor, document.getElementById(cssEditor.id.replace('Editor', 'LineNumbers')));
          cleared = true;
        }
        if (jsEditor) {
          jsEditor.value = '';
          updateLineNumbers(jsEditor, document.getElementById(jsEditor.id.replace('Editor', 'LineNumbers')));
          cleared = true;
        }
        
        if (cleared) {
          showNotification('Editores limpiados exitosamente', 'success');
        }
      }
    }

    function shareProject() {
      if (!currentProjectId) {
        alert('No hay proyecto activo para compartir');
        return;
      }
      
      const shareUrl = `${window.location.origin}${window.location.pathname}?project=${currentProjectId}`;
      navigator.clipboard.writeText(shareUrl).then(() => {
        showNotification('Enlace copiado al portapapeles', 'success');
      }).catch(() => {
        prompt('Copia este enlace para compartir:', shareUrl);
      });
    }

    function showProjectSettings() {
      alert('Configuraciones del proyecto - Funci贸n en desarrollo');
    }

    function toggleFullscreen() {
      const editor = document.getElementById('projectEditor');
      if (editor.classList.contains('fullscreen')) {
        editor.classList.remove('fullscreen');
        document.querySelector('.fullscreen-btn i').className = 'fas fa-expand';
      } else {
        editor.classList.add('fullscreen');
        document.querySelector('.fullscreen-btn i').className = 'fas fa-compress';
      }
    }

    let undoStack = [];
    let redoStack = [];
    let maxUndoSteps = 20;

    function saveState() {
      const currentSection = document.querySelector('.section.active').id;
      const state = getCurrentState();
      
      // Solo guardar si hay cambios
      if (undoStack.length === 0 || JSON.stringify(state) !== JSON.stringify(undoStack[undoStack.length - 1])) {
        undoStack.push(state);
        if (undoStack.length > maxUndoSteps) {
          undoStack.shift();
        }
        redoStack = []; // Limpiar redo stack cuando se hace un nuevo cambio
      }
    }

    function undoChanges() {
      if (undoStack.length > 1) {
        const currentState = getCurrentState();
        redoStack.push(currentState);
        undoStack.pop(); // Remover estado actual
        const previousState = undoStack[undoStack.length - 1];
        restoreState(previousState);
        showNotification('Cambio deshecho ', 'info');
      } else {
        showNotification('No hay m谩s cambios para deshacer', 'info');
      }
    }

    function redoChanges() {
      if (redoStack.length > 0) {
        const state = redoStack.pop();
        undoStack.push(getCurrentState());
        restoreState(state);
        showNotification('Cambio rehecho ', 'info');
      } else {
        showNotification('No hay m谩s cambios para rehacer', 'info');
      }
    }

    function getCurrentState() {
      const currentSection = document.querySelector('.section.active').id;
      let htmlEditor, cssEditor, jsEditor;
      
      if (currentSection === 'proyectos') {
        htmlEditor = document.getElementById('htmlEditor');
        cssEditor = document.getElementById('cssEditor');
        jsEditor = document.getElementById('jsEditor');
      } else {
        htmlEditor = document.getElementById('htmlEditorMain');
        cssEditor = document.getElementById('cssEditorMain');
        jsEditor = document.getElementById('jsEditorMain');
      }
      
      return {
        html: htmlEditor ? htmlEditor.value : '',
        css: cssEditor ? cssEditor.value : '',
        js: jsEditor ? jsEditor.value : '',
        section: currentSection
      };
    }

    function restoreState(state) {
      let htmlEditor, cssEditor, jsEditor;
      
      if (state.section === 'proyectos') {
        htmlEditor = document.getElementById('htmlEditor');
        cssEditor = document.getElementById('cssEditor');
        jsEditor = document.getElementById('jsEditor');
      } else {
        htmlEditor = document.getElementById('htmlEditorMain');
        cssEditor = document.getElementById('cssEditorMain');
        jsEditor = document.getElementById('jsEditorMain');
      }
      
      if (htmlEditor) {
        htmlEditor.value = state.html;
        updateLineNumbers(htmlEditor, document.getElementById(htmlEditor.id.replace('Editor', 'LineNumbers')));
      }
      if (cssEditor) {
        cssEditor.value = state.css;
        updateLineNumbers(cssEditor, document.getElementById(cssEditor.id.replace('Editor', 'LineNumbers')));
      }
      if (jsEditor) {
        jsEditor.value = state.js;
        updateLineNumbers(jsEditor, document.getElementById(jsEditor.id.replace('Editor', 'LineNumbers')));
      }
    }

    function showProjectActionSkeleton(action) {
      // Crear overlay de skeleton para acciones
      let skeleton = document.getElementById('projectActionSkeleton');
      
      if (!skeleton) {
        skeleton = document.createElement('div');
        skeleton.id = 'projectActionSkeleton';
        skeleton.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: rgba(255,255,255,0.95);
          border-radius: 15px;
          padding: 30px;
          z-index: 11000;
          text-align: center;
          box-shadow: 0 10px 30px rgba(0,0,0,0.2);
          backdrop-filter: blur(10px);
          min-width: 200px;
        `;
        document.body.appendChild(skeleton);
      }
      
      const actionTexts = {
        'save': { icon: '', text: 'Guardando proyecto...' },
        'duplicate': { icon: '', text: 'Duplicando proyecto...' },
        'export': { icon: '', text: 'Exportando proyecto...' }
      };
      
      const actionData = actionTexts[action] || { icon: '锔', text: 'Procesando...' };
      
      skeleton.innerHTML = `
        <div style="font-size: 40px; margin-bottom: 15px; animation: pulse 2s infinite;">${actionData.icon}</div>
        <div style="color: #333; font-weight: 600; margin-bottom: 20px;">${actionData.text}</div>
        <div style="display: flex; gap: 5px; justify-content: center;">
          <div style="width: 8px; height: 8px; background: var(--primary-color); border-radius: 50%; animation: translatingPulse 1.4s infinite;"></div>
          <div style="width: 8px; height: 8px; background: var(--primary-color); border-radius: 50%; animation: translatingPulse 1.4s infinite; animation-delay: 0.2s;"></div>
          <div style="width: 8px; height: 8px; background: var(--primary-color); border-radius: 50%; animation: translatingPulse 1.4s infinite; animation-delay: 0.4s;"></div>
        </div>
      `;
      
      skeleton.style.display = 'block';
    }
    
    function hideProjectActionSkeleton() {
      const skeleton = document.getElementById('projectActionSkeleton');
      if (skeleton) {
        skeleton.style.display = 'none';
      }
    }

    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        border-radius: 5px;
        z-index: 10000;
        font-weight: 600;
        color: white;
        background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
      `;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    function deleteProject(projectId) {
      // Convertir projectId a n煤mero si es string
      const id = typeof projectId === 'string' ? parseInt(projectId) : projectId;
      
      if (confirm('驴Est谩s seguro de que quieres eliminar este proyecto?')) {
        let projects = loadProjects();
        const projectToDelete = projects.find(p => p.id === id);
        
        if (projectToDelete) {
          projects = projects.filter(p => p.id !== id);
          saveProjects(projects);
          renderProjectsList();
          
          if (currentProjectId === id) {
            closeProject();
          }
          
          showNotification(`Proyecto "${projectToDelete.name}" eliminado`, 'success');
          
          // Cerrar cualquier men煤 abierto
          const existingMenus = document.querySelectorAll('div[style*="position: fixed"][style*="background: white"]');
          existingMenus.forEach(menu => menu.remove());
        } else {
          showNotification('Error: Proyecto no encontrado', 'error');
        }
      }
    }

    function closeProject() {
      currentProjectId = null;
      document.getElementById('projectEditor').style.display = 'none';
      document.getElementById('projectName').value = '';
      document.getElementById('htmlEditor').value = '';
      document.getElementById('cssEditor').value = '';
      document.getElementById('jsEditor').value = '';
    }
    function loadProjects() {
      const storedProjects = localStorage.getItem('projects');
      return storedProjects ? JSON.parse(storedProjects) : [];
    }
    function saveProjects(projects) {
      localStorage.setItem('projects', JSON.stringify(projects));
    }
    function renderProjectsList() {
      const projects = loadProjects();
      const projectsList = document.getElementById('projectsList');
      projectsList.innerHTML = "";

      if (projects.length === 0) {
        projectsList.innerHTML = `
          <div style="text-align: center; padding: 40px 20px; color: #71767b;">
            <i class="fas fa-folder-open" style="font-size: 64px; margin-bottom: 16px; opacity: 0.3;"></i>
            <h3 style="color: #ffffff; margin-bottom: 8px; font-size: 20px;">No hay proyectos</h3>
            <p style="font-size: 15px; line-height: 1.4;">Crea tu primer proyecto para comenzar a programar</p>
          </div>
        `;
        return;
      }

      // Ordenar proyectos: favoritos primero, luego por fecha de actualizaci贸n
      projects.sort((a, b) => {
        if (a.favorite && !b.favorite) return -1;
        if (!a.favorite && b.favorite) return 1;
        return new Date(b.updatedAt || b.createdAt) - new Date(a.updatedAt || a.createdAt);
      });

      projects.forEach(project => {
        const projectDiv = document.createElement('div');
        projectDiv.className = `project-item ${currentProjectId === project.id ? 'active' : ''}`;

        const technologies = [];
        if (project.html) technologies.push({ name: 'HTML', color: '#e34c26' });
        if (project.css) technologies.push({ name: 'CSS', color: '#1572b6' });
        if (project.js) technologies.push({ name: 'JS', color: '#f7df1e' });

        projectDiv.innerHTML = `
          <div class="project-item-header">
            <h3 class="project-name">${project.name}</h3>
            <button class="project-favorite ${project.favorite ? 'favorited' : ''}" data-id="${project.id}">
              <i class="fas fa-star"></i>
            </button>
          </div>
          
          <div class="project-meta">
            <span class="project-date">${formatDate(project.updatedAt || project.createdAt)}</span>
            <div class="project-tags">
              ${technologies.map(tech => `<span class="project-tag" style="color: ${tech.color}; background: ${tech.color}15;">${tech.name}</span>`).join('')}
            </div>
          </div>
          
          <div class="project-actions">
            <button class="project-action-btn primary open-project-btn" data-id="${project.id}">
              <i class="fas fa-code"></i>
              Abrir
            </button>
            <button class="project-action-btn project-menu-btn" data-id="${project.id}">
              <i class="fas fa-ellipsis-h"></i>
            </button>
          </div>
        `;

        // Event listeners
        const openBtn = projectDiv.querySelector('.open-project-btn');
        const favoriteBtn = projectDiv.querySelector('.project-favorite');
        const menuBtn = projectDiv.querySelector('.project-menu-btn');

        openBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          loadProject(project.id);
          startAutoSave();
        });

        favoriteBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          toggleProjectFavorite(project.id);
        });

        menuBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          showProjectMenu(project.id, e.target);
        });

        // Click en el item para abrir proyecto
        projectDiv.addEventListener('click', () => {
          loadProject(project.id);
          startAutoSave();
        });

        projectsList.appendChild(projectDiv);
      });
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      const now = new Date();
      const diff = now - date;
      const minutes = Math.floor(diff / 60000);
      const hours = Math.floor(diff / 3600000);
      const days = Math.floor(diff / 86400000);

      if (minutes < 1) return 'Ahora';
      if (minutes < 60) return `${minutes}m`;
      if (hours < 24) return `${hours}h`;
      if (days < 7) return `${days}d`;
      return date.toLocaleDateString();
    }

    function toggleProjectFavorite(projectId) {
      let projects = loadProjects();
      const projectIndex = projects.findIndex(p => p.id === projectId);
      
      if (projectIndex !== -1) {
        projects[projectIndex].favorite = !projects[projectIndex].favorite;
        saveProjects(projects);
        renderProjectsList();
        
        const action = projects[projectIndex].favorite ? 'agregado a' : 'removido de';
        showNotification(`Proyecto ${action} favoritos`, 'success');
      }
    }

    function showProjectMenu(projectId, button) {
      const projects = loadProjects();
      const project = projects.find(p => p.id === projectId);
      if (!project) return;

      // Crear men煤 contextual
      const menu = document.createElement('div');
      menu.style.cssText = `
        position: fixed;
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 10000;
        min-width: 150px;
        padding: 4px 0;
      `;

      const rect = button.getBoundingClientRect();
      menu.style.top = (rect.bottom + 5) + 'px';
      menu.style.left = (rect.left - 100) + 'px';

      menu.innerHTML = `
        <button onclick="duplicateProjectById('${projectId}')" style="width: 100%; text-align: left; background: none; border: none; padding: 8px 16px; cursor: pointer; font-size: 14px;">
          <i class="fas fa-copy" style="margin-right: 8px; color: #666;"></i>
          Duplicar
        </button>
        <button onclick="renameProject('${projectId}')" style="width: 100%; text-align: left; background: none; border: none; padding: 8px 16px; cursor: pointer; font-size: 14px;">
          <i class="fas fa-edit" style="margin-right: 8px; color: #666;"></i>
          Renombrar
        </button>
        <button onclick="exportProjectById('${projectId}')" style="width: 100%; text-align: left; background: none; border: none; padding: 8px 16px; cursor: pointer; font-size: 14px;">
          <i class="fas fa-download" style="margin-right: 8px; color: #666;"></i>
          Exportar
        </button>
        <hr style="margin: 4px 0; border: none; border-top: 1px solid #eee;">
        <button onclick="deleteProject(${projectId}); this.closest('div').remove();" style="width: 100%; text-align: left; background: none; border: none; padding: 8px 16px; cursor: pointer; font-size: 14px; color: #d32f2f;">
          <i class="fas fa-trash" style="margin-right: 8px;"></i>
          Eliminar
        </button>
      `;

      document.body.appendChild(menu);

      // Cerrar men煤 al hacer clic fuera
      setTimeout(() => {
        document.addEventListener('click', function closeMenu(e) {
          if (!menu.contains(e.target)) {
            menu.remove();
            document.removeEventListener('click', closeMenu);
          }
        });
      }, 100);
    }

    function duplicateProjectById(projectId) {
      const projects = loadProjects();
      const project = projects.find(p => p.id === parseInt(projectId));
      
      if (project) {
        const newProject = {
          ...project,
          id: Date.now(),
          name: project.name + ' - Copia',
          createdAt: new Date().toISOString(),
          updatedAt: new Date().toISOString(),
          favorite: false
        };
        
        projects.push(newProject);
        saveProjects(projects);
        renderProjectsList();
        showNotification('Proyecto duplicado exitosamente', 'success');
      }
    }

    function renameProject(projectId) {
      const projects = loadProjects();
      const project = projects.find(p => p.id === parseInt(projectId));
      
      if (project) {
        const newName = prompt('Nuevo nombre del proyecto:', project.name);
        if (newName && newName.trim() !== '' && newName !== project.name) {
          project.name = newName.trim();
          project.updatedAt = new Date().toISOString();
          saveProjects(projects);
          renderProjectsList();
          
          // Actualizar nombre en el editor si est谩 abierto
          if (currentProjectId === project.id) {
            document.getElementById('projectName').value = newName;
          }
          
          showNotification('Proyecto renombrado exitosamente', 'success');
        }
      }
    }

    function exportProjectById(projectId) {
      const projects = loadProjects();
      const project = projects.find(p => p.id === parseInt(projectId));
      
      if (project) {
        showProjectActionSkeleton('export');
        
        setTimeout(() => {
          const exportData = {
            name: project.name,
            html: project.html || '',
            css: project.css || '',
            js: project.js || '',
            createdAt: project.createdAt,
            updatedAt: project.updatedAt,
            exportDate: new Date().toISOString()
          };
          
          const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `${project.name.replace(/[^a-z0-9]/gi, '_')}.json`;
          a.click();
          URL.revokeObjectURL(url);
          
          hideProjectActionSkeleton();
          showNotification('Proyecto exportado exitosamente', 'success');
        }, 1000);
      }
    }

document.addEventListener('DOMContentLoaded', () => {
      // Cargar idioma guardado desde localStorage
      const savedLang = localStorage.getItem('currentLang');
      if (savedLang) {
        currentLang = savedLang;
        console.log(`Idioma cargado desde localStorage: ${currentLang}`);
      }
      
      // Cargar voces disponibles
      loadAvailableVoices();
      
      // Aplicar idioma sin animaci贸n al cargar
      const t = translations[currentLang] || translations["es"];
      updateAllTexts(t);
      
      checkSession();
      setupSwipeDetection();
      renderRecentSearches();
      renderProjectsList();
      updateThemeDisplay();
      
      // Inicializar eventos del overlay de art铆culos
      const closeArticleBtn = document.getElementById('closeArticle');
      const followAuthorBtn = document.getElementById('followAuthor');
      const reportArticleBtn = document.getElementById('reportArticle');
      
      if (closeArticleBtn) {
        closeArticleBtn.addEventListener('click', closeArticleOverlay);
      }
      if (followAuthorBtn) {
        followAuthorBtn.addEventListener('click', toggleFollow);
      }
      if (reportArticleBtn) {
        reportArticleBtn.addEventListener('click', openReportArticleModal);
      }
      
      // Navegaci贸n mejorada del asistente
      document.getElementById('closeHelpBot').addEventListener('click', () => {
        document.getElementById('helpBotOverlay').classList.remove('show');
        setTimeout(() => {
          document.getElementById('helpBotOverlay').style.display = 'none';
        }, 300);
      });
      
      document.getElementById('backToSettingsFromHelp').addEventListener('click', () => {
        document.getElementById('helpSection').classList.remove('show');
        document.getElementById('settingsOverlay').style.display = 'block';
      });
      
      // Eventos del modal de reporte
      document.getElementById('closeReportModal').addEventListener('click', closeReportArticleModal);
      document.getElementById('cancelReport').addEventListener('click', closeReportArticleModal);
      document.getElementById('submitArticleReport').addEventListener('click', submitArticleReport);
      
      // Event listeners para selecci贸n de motivos de reporte
      document.querySelectorAll('.report-reason-option').forEach(option => {
        option.addEventListener('click', function() {
          // Resetear todas las opciones
          document.querySelectorAll('.report-reason-option').forEach(opt => {
            opt.style.borderColor = '#2f3336';
            opt.style.background = '#000000';
            opt.classList.remove('selected');
          });
          
          // Seleccionar la opci贸n clickeada
          this.style.borderColor = '#f91880';
          this.style.background = 'rgba(249, 24, 128, 0.1)';
          this.classList.add('selected');
          
          selectedReportReason = this.dataset.value;
          validateReportForm();
        });
        
        // Efectos hover
        option.addEventListener('mouseenter', function() {
          if (!this.classList.contains('selected')) {
            this.style.borderColor = '#71767b';
            this.style.transform = 'translateY(-2px)';
          }
        });
        
        option.addEventListener('mouseleave', function() {
          if (!this.classList.contains('selected')) {
            this.style.borderColor = '#2f3336';
            this.style.transform = 'translateY(0)';
          }
        });
      });
      
      // Contador de caracteres y validaci贸n
      const reportDetails = document.getElementById('reportDetails');
      const reportCharCount = document.getElementById('reportCharCount');
      
      reportDetails.addEventListener('input', function() {
        const count = this.value.length;
        reportCharCount.textContent = count;
        
        if (count > 500) {
          this.value = this.value.substring(0, 500);
          reportCharCount.textContent = '500';
        }
        
        validateReportForm();
      });
      
      reportDetails.addEventListener('focus', function() {
        this.style.borderColor = '#f91880';
      });
      
      reportDetails.addEventListener('blur', function() {
        this.style.borderColor = '#2f3336';
      });
      
      function validateReportForm() {
        const submitBtn = document.getElementById('submitArticleReport');
        const isValid = selectedReportReason !== null;
        
        if (isValid) {
          submitBtn.style.opacity = '1';
          submitBtn.style.pointerEvents = 'auto';
          submitBtn.style.transform = 'translateY(0)';
        } else {
          submitBtn.style.opacity = '0.5';
          submitBtn.style.pointerEvents = 'none';
        }
      }
      
      // Sistema de Chat de Soporte
      let supportChatSession = null;
      let queueInterval = null;
      let currentQueuePosition = 1;
      let agentTypingTimeout = null;
      
      // Navegaci贸n del contacto de soporte
      document.getElementById('contactSupportOption').addEventListener('click', () => {
        document.getElementById('contactSupportSection').classList.add('show');
        document.getElementById('settingsOverlay').style.display = 'none';
        resetSupportForm();
      });
      
      document.getElementById('backToSettingsFromSupport').addEventListener('click', () => {
        document.getElementById('contactSupportSection').classList.remove('show');
        document.getElementById('settingsOverlay').style.display = 'block';
      });
      
      // Validaci贸n del formulario de soporte
      function setupSupportFormValidation() {
        const email = document.getElementById('supportEmail');
        const category = document.getElementById('supportCategory');
        const description = document.getElementById('supportDescription');
        const startChatBtn = document.getElementById('startChatBtn');
        const charCount = document.getElementById('supportCharCount');
        
        function validateForm() {
          const isValid = email.value.trim() !== '' && 
                          category.value !== '' && 
                          description.value.trim() !== '' &&
                          description.value.length <= 500 &&
                          /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value);
          
          startChatBtn.disabled = !isValid;
          startChatBtn.style.opacity = isValid ? '1' : '0.5';
          startChatBtn.style.pointerEvents = isValid ? 'auto' : 'none';
          startChatBtn.style.background = isValid ? 'linear-gradient(45deg, #6f42c1, #5a2d91)' : '#71767b';
        }
        
        description.addEventListener('input', () => {
          charCount.textContent = description.value.length;
          if (description.value.length > 500) {
            description.value = description.value.substring(0, 500);
            charCount.textContent = '500';
          }
          validateForm();
        });
        
        email.addEventListener('input', validateForm);
        category.addEventListener('change', validateForm);
        
        startChatBtn.addEventListener('click', startSupportChat);
      }
      
      function selectPriority(priority) {
        document.querySelectorAll('input[name="priority"]').forEach(radio => {
          const label = radio.closest('label');
          label.style.borderColor = '#2f3336';
          label.style.background = '#16181c';
        });
        
        const selectedRadio = document.getElementById('priority' + priority.charAt(0).toUpperCase() + priority.slice(1));
        selectedRadio.checked = true;
        const selectedLabel = selectedRadio.closest('label');
        selectedLabel.style.borderColor = '#6f42c1';
        selectedLabel.style.background = 'rgba(111, 66, 193, 0.1)';
      }
      
      function resetSupportForm() {
        document.getElementById('supportEmail').value = '';
        document.getElementById('supportCategory').value = '';
        document.getElementById('supportDescription').value = '';
        document.getElementById('supportCharCount').textContent = '0';
        document.querySelectorAll('input[name="priority"]').forEach(radio => {
          radio.checked = false;
          const label = radio.closest('label');
          label.style.borderColor = '#2f3336';
          label.style.background = '#16181c';
        });
        document.getElementById('startChatBtn').disabled = true;
        document.getElementById('supportContactForm').style.display = 'block';
        document.getElementById('supportQueue').style.display = 'none';
      }
      
      function startSupportChat() {
        const email = document.getElementById('supportEmail').value;
        const category = document.getElementById('supportCategory');
        const categoryText = category.options[category.selectedIndex].text;
        const description = document.getElementById('supportDescription').value;
        const priority = document.querySelector('input[name="priority"]:checked')?.value || 'medium';
        
        // Generar ID de ticket
        const ticketId = 'SUP-' + Math.floor(Math.random() * 9000 + 1000);
        
        // Crear sesi贸n de chat
        supportChatSession = {
          ticketId: ticketId,
          email: email,
          category: category.value,
          categoryText: categoryText,
          description: description,
          priority: priority,
          startTime: new Date().toISOString(),
          messages: []
        };
        
        // Mostrar cola de espera
        showSupportQueue(ticketId);
      }
      
      function showSupportQueue(ticketId) {
        document.getElementById('supportContactForm').style.display = 'none';
        document.getElementById('supportQueue').style.display = 'block';
        document.getElementById('ticketId').textContent = '#' + ticketId;
        
        // Simular cola de espera con actualizaci贸n en tiempo real
        currentQueuePosition = Math.floor(Math.random() * 5) + 1;
        updateQueueStatus();
        
        queueInterval = setInterval(() => {
          if (currentQueuePosition > 0) {
            currentQueuePosition--;
            updateQueueStatus();
            
            if (currentQueuePosition === 0) {
              clearInterval(queueInterval);
              setTimeout(() => {
                connectToAgent();
              }, 2000);
            }
          }
        }, 3000 + Math.random() * 4000); // Tiempo variable entre 3-7 segundos
        
        // Bot贸n para salir de la cola
        document.getElementById('cancelQueueBtn').addEventListener('click', () => {
          clearInterval(queueInterval);
          resetSupportForm();
          showNotification('Has salido de la cola de soporte', 'info');
        });
      }
      
      function updateQueueStatus() {
        const queuePositionEl = document.getElementById('queuePosition');
        const estimatedWaitEl = document.getElementById('estimatedWait');
        
        if (currentQueuePosition === 0) {
          queuePositionEl.textContent = 'Conectando...';
          estimatedWaitEl.textContent = 'Ahora';
        } else {
          queuePositionEl.textContent = '#' + currentQueuePosition;
          const estimatedMinutes = Math.max(1, currentQueuePosition * 2 - 1);
          estimatedWaitEl.textContent = '~' + estimatedMinutes + ' min';
        }
      }
      
      function connectToAgent() {
        // Cerrar cola y abrir chat
        document.getElementById('contactSupportSection').classList.remove('show');
        document.getElementById('supportChatOverlay').style.display = 'flex';
        document.getElementById('supportChatOverlay').style.flexDirection = 'column';
        document.getElementById('supportChatOverlay').style.position = 'fixed';
        document.getElementById('supportChatOverlay').style.top = '0';
        document.getElementById('supportChatOverlay').style.left = '0';
        document.getElementById('supportChatOverlay').style.width = '100%';
        document.getElementById('supportChatOverlay').style.height = '100%';
        document.getElementById('supportChatOverlay').style.zIndex = '11000';
        document.getElementById('supportChatOverlay').style.background = '#f8f9fa';
        
        // Configurar informaci贸n del chat
        document.getElementById('chatTicketId').textContent = '#' + supportChatSession.ticketId;
        document.getElementById('chatCategory').textContent = supportChatSession.categoryText;
        document.getElementById('chatDescription').textContent = supportChatSession.description;
        
        // Configurar agente aleatorio
        const agents = [
          { name: 'Carlos Rodr铆guez', avatar: 'ㄢ' },
          { name: 'Ana Garc铆a', avatar: '┾' },
          { name: 'Miguel Torres', avatar: 'ㄢ' },
          { name: 'Laura Mart铆nez', avatar: '┾' }
        ];
        const randomAgent = agents[Math.floor(Math.random() * agents.length)];
        
        document.getElementById('agentName').textContent = randomAgent.name;
        document.querySelector('.agent-avatar').textContent = randomAgent.avatar;
        
        // Establecer tiempo de bienvenida
        document.getElementById('welcomeSupportTime').textContent = getCurrentTime();
        
        // Configurar eventos del chat
        setupSupportChatEvents();
        
        // Notificaci贸n de conexi贸n exitosa
        showNotification(' 隆Conectado con ' + randomAgent.name + '!', 'success');
        
        // Simular primer mensaje del agente despu茅s de unos segundos
        setTimeout(() => {
          simulateAgentResponse('Perfecto, he revisado tu consulta sobre "' + supportChatSession.categoryText + '". Para poder ayudarte mejor, 驴podr铆as proporcionarme algunos detalles adicionales sobre cu谩ndo comenz贸 este problema?');
        }, 3000);
      }
      
      function setupSupportChatEvents() {
        const chatInput = document.getElementById('supportChatInput');
        const sendButton = document.getElementById('supportSendButton');
        const closeButton = document.getElementById('closeSupportChat');
        
        // Enviar mensaje
        function sendSupportMessage() {
          const message = chatInput.value.trim();
          if (message) {
            addSupportMessage(message, 'user');
            chatInput.value = '';
            
            // Simular respuesta del agente
            setTimeout(() => {
              showAgentTyping();
              setTimeout(() => {
                hideAgentTyping();
                simulateAgentResponse();
              }, 2000 + Math.random() * 3000);
            }, 500);
          }
        }
        
        sendButton.addEventListener('click', sendSupportMessage);
        
        chatInput.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendSupportMessage();
          }
        });
        
        // Auto-resize del textarea
        chatInput.addEventListener('input', () => {
          chatInput.style.height = 'auto';
          chatInput.style.height = Math.min(chatInput.scrollHeight, 100) + 'px';
        });
        
        // Cerrar chat
        closeButton.addEventListener('click', () => {
          if (confirm('驴Est谩s seguro de que quieres cerrar el chat de soporte? Tu sesi贸n se guardar谩.')) {
            document.getElementById('supportChatOverlay').style.display = 'none';
            showNotification('Chat cerrado. Tu ticket #' + supportChatSession.ticketId + ' sigue activo', 'info');
            resetSupportForm();
          }
        });
      }
      
      function addSupportMessage(text, sender) {
        const messagesContainer = document.getElementById('supportChatMessages');
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${sender}`;
        messageDiv.style.cssText = 'margin-bottom: 15px; display: flex; animation: messageSlideIn 0.3s ease;';
        
        if (sender === 'user') {
          messageDiv.style.justifyContent = 'flex-end';
        } else {
          messageDiv.style.justifyContent = 'flex-start';
        }
        
        const messageContent = document.createElement('div');
        messageContent.className = 'message-content';
        messageContent.style.cssText = `
          max-width: 70%;
          padding: 12px 16px;
          border-radius: 18px;
          word-wrap: break-word;
          position: relative;
        `;
        
        if (sender === 'user') {
          messageContent.style.background = '#6f42c1';
          messageContent.style.color = 'white';
          messageContent.style.borderBottomRightRadius = '5px';
        } else {
          messageContent.style.background = 'white';
          messageContent.style.color = '#333';
          messageContent.style.border = '1px solid #e0e0e0';
          messageContent.style.borderBottomLeftRadius = '5px';
          messageContent.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
        }
        
        messageContent.innerHTML = `
          ${text}
          <div class="message-time" style="font-size: 11px; opacity: 0.7; margin-top: 5px; text-align: ${sender === 'user' ? 'right' : 'left'};">
            ${getCurrentTime()}
          </div>
        `;
        
        messageDiv.appendChild(messageContent);
        messagesContainer.appendChild(messageDiv);
        
        // Scroll autom谩tico
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
        
        // Guardar en sesi贸n
        supportChatSession.messages.push({
          text: text,
          sender: sender,
          timestamp: new Date().toISOString()
        });
      }
      
      function showAgentTyping() {
        document.getElementById('supportTypingIndicator').style.display = 'flex';
        const container = document.querySelector('.chat-messages-container');
        container.scrollTop = container.scrollHeight;
      }
      
      function hideAgentTyping() {
        document.getElementById('supportTypingIndicator').style.display = 'none';
      }
      
      function simulateAgentResponse(customMessage = null) {
        const responses = [
          'Entiendo tu situaci贸n. D茅jame revisar esto m谩s a fondo.',
          '驴Podr铆as proporcionarme m谩s detalles sobre cu谩ndo ocurri贸 esto por primera vez?',
          'Gracias por la informaci贸n. Voy a verificar esto en nuestro sistema.',
          'Perfecto, creo que puedo ayudarte con esto. Te gu铆o paso a paso.',
          '驴Has intentado refrescar la p谩gina o cerrar sesi贸n y volver a entrar?',
          'Esto es un problema conocido que ya hemos solucionado. Te ayudo a aplicar la soluci贸n.',
          'Veo que esto puede estar relacionado con tu configuraci贸n. 驴Puedes verificar...?',
          'Excelente pregunta. La soluci贸n es la siguiente...',
          '驴Podr铆as enviarme una captura de pantalla de lo que est谩s viendo?',
          'Perfecto, eso deber铆a resolver el problema. 驴Podr铆as intentarlo y confirmarme?'
        ];
        
        const message = customMessage || responses[Math.floor(Math.random() * responses.length)];
        addSupportMessage(message, 'bot');
      }
      
      function sendQuickMessage(message) {
        addSupportMessage(message, 'user');
        setTimeout(() => {
          showAgentTyping();
          setTimeout(() => {
            hideAgentTyping();
            simulateAgentResponse();
          }, 1500);
        }, 300);
      }
      
      function getCurrentTime() {
        return new Date().toLocaleTimeString('es-ES', { 
          hour: '2-digit', 
          minute: '2-digit' 
        });
      }
      
      // Configurar validaci贸n del formulario al cargar
      setupSupportFormValidation();
      
      // Funciones para el reporte de problemas
      function showReportStep(stepNumber) {
        // Ocultar todos los pasos
        document.querySelectorAll('.report-step').forEach(step => {
          step.style.display = 'none';
        });
        
        // Mostrar el paso actual
        document.getElementById(`reportStep${stepNumber}`).style.display = 'block';
        
        // Actualizar indicador de progreso
        document.getElementById('reportProgressIndicator').textContent = `${stepNumber}/3`;
      }
      
      function resetReportForm() {
        document.getElementById('problemDescription').value = '';
        document.getElementById('problemType').value = '';
        document.getElementById('characterCount').textContent = '0';
        uploadedImages = [];
        imagePreviewContainer.innerHTML = '';
        showReportStep(1);
        
        const nextBtn = document.getElementById('nextToImages');
        nextBtn.style.opacity = '0.5';
        nextBtn.style.pointerEvents = 'none';
        nextBtn.style.background = '#71767b';
      }
      
      function renderImagePreview() {
        imagePreviewContainer.innerHTML = '';
        
        uploadedImages.forEach((imageData, index) => {
          const imageDiv = document.createElement('div');
          imageDiv.style.cssText = `
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            background: #2f3336;
            aspect-ratio: 1;
          `;
          
          imageDiv.innerHTML = `
            <img src="${imageData.data}" style="width: 100%; height: 100%; object-fit: cover;" />
            <button onclick="removeImage(${index})" style="position: absolute; top: 8px; right: 8px; background: rgba(0,0,0,0.7); border: none; color: white; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; transition: all 0.2s ease;">
              <i class="fas fa-times"></i>
            </button>
          `;
          
          imagePreviewContainer.appendChild(imageDiv);
        });
      }
      
      function removeImage(index) {
        uploadedImages.splice(index, 1);
        renderImagePreview();
      }
      
      function updateReviewSection() {
        const description = document.getElementById('problemDescription').value;
        const typeSelect = document.getElementById('problemType');
        const selectedType = typeSelect.options[typeSelect.selectedIndex].text;
        
        document.getElementById('reviewDescription').textContent = description;
        document.getElementById('reviewType').textContent = selectedType;
        
        const reviewImagesSection = document.getElementById('reviewImagesSection');
        const reviewImages = document.getElementById('reviewImages');
        
        if (uploadedImages.length > 0) {
          reviewImagesSection.style.display = 'block';
          reviewImages.innerHTML = '';
          
          uploadedImages.forEach(imageData => {
            const img = document.createElement('img');
            img.src = imageData.data;
            img.style.cssText = 'width: 60px; height: 60px; object-fit: cover; border-radius: 8px; border: 1px solid #2f3336;';
            reviewImages.appendChild(img);
          });
        } else {
          reviewImagesSection.style.display = 'none';
        }
      }
      
      function submitProblemReport() {
        // Mostrar overlay de carga
        const submitBtn = document.getElementById('submitProblemReport');
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin" style="margin-right: 8px;"></i>Enviando...';
        submitBtn.disabled = true;
        
        // Simular env铆o del reporte
        setTimeout(() => {
          // Generar ID 煤nico de reporte
          const reportId = 'REP-' + Math.floor(Math.random() * 9000 + 1000);
          document.getElementById('reportId').textContent = '#' + reportId;
          
          // Mostrar overlay de 茅xito
          document.getElementById('reportProblemModal').style.display = 'none';
          document.getElementById('reportSentOverlay').style.display = 'flex';
          
          // Resetear bot贸n
          submitBtn.innerHTML = '<i class="fas fa-paper-plane" style="margin-right: 8px;"></i>Enviar reporte';
          submitBtn.disabled = false;
          
          // Mostrar notificaci贸n
          showNotification(' Reporte enviado exitosamente', 'success');
          
        }, 2000);
      }

      // Elementos de Clack
      const codeEffect = document.querySelector('.code-effect');
      const settingsBtn = document.getElementById('settingsBtn');
      const previewBtn = document.getElementById('previewBtn');
      const closePreview = document.getElementById('closePreview');
      const previewFrame = document.getElementById('previewFrame');
      const htmlEditor = document.getElementById('htmlEditor');
      const cssEditor = document.getElementById('cssEditor');
      const jsEditor = document.getElementById('jsEditor');
      const searchBtn = document.getElementById('searchBtn');
      const closeSearchOverlay = document.getElementById('closeSearchOverlay');
      const searchExecuteBtn = document.getElementById('searchExecuteBtn');
      const toggleVideos = document.getElementById('toggleVideos');
      const toggleArticles = document.getElementById('toggleArticles');
      // Elementos de video (solo si existen)
      const likeVideoBtn = document.getElementById('likeVideoBtn');
      const reportVideoBtn = document.getElementById('reportVideoBtn');
      const closeVideoBtn = document.getElementById('closeVideoBtn');
      const likeAnimation = document.getElementById('likeAnimation');
      const submitReportBtn = document.getElementById('submitReport');

      const introSound = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAFhpbmcAAAAPAAAAAwAAA/wAVlZWVlZWVlZWVlZWVlZWVlZWVlZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2v7+/v7+/v7+/v7+/v7+/v7+/v7//////////////////////////////////////////////////////////////////////////////////MAAAAxpMRFNBAAAAGgAAAAEAAAMYAAQGAkNhAAAQJAADBhgAABUWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV');
      const typeSound = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAFhpbmcAAAAPAAAAAwAAA+UAVlZWVlZWVlZWVlZWVlZWVlZWVlZ8fHx8fHx8fHx8fHx8fHx8fHx8fHx8zMzMzMzMzMzMzMzMzMzMzMzMzMzM////////////////////////////////////////////////////////////////////////////////////////////////////////////MAAAAxpMRFNBAAAAHQAAAAEAAAN4AAQIBAMDAAAABQ4AAAMGGAAAFhYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV');
      const executeSound = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAFhpbmcAAAAPAAAAAwAAA/MAVlZWVlZWVlZWVlZWVlZWVlZWVlZ7e3t7e3t7e3t7e3t7e3t7e3t7e3t7ysrKysrKysrKysrKysrKysrKysrK////////////////////////////////////////////////////////////////////////////////////////////////////////////MAAAAxpMRFNBAAAAHQAAAAEAAANyAAQGAwIAAAAACw4AAAMGGAAAFRYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV');

      introSound.volume = 0.5;
      introSound.play().catch(e => console.log('Error playing sound:', e));
      setTimeout(() => {
        document.querySelector('.intro').style.animation = 'fadeOut 1s forwards';
        document.getElementById('loginModal').style.display = 'block';
      }, 2500);
      // Configurar editores principales y de proyectos
      const editors = [
        {editor: document.getElementById('htmlEditorMain'), lineNumbers: 'htmlLineNumbersMain', highlight: 'htmlHighlightMain'},
        {editor: document.getElementById('cssEditorMain'), lineNumbers: 'cssLineNumbersMain', highlight: 'cssHighlightMain'},
        {editor: document.getElementById('jsEditorMain'), lineNumbers: 'jsLineNumbersMain', highlight: 'jsHighlightMain'},
        {editor: document.getElementById('htmlEditor'), lineNumbers: 'htmlLineNumbers', highlight: 'htmlHighlight'},
        {editor: document.getElementById('cssEditor'), lineNumbers: 'cssLineNumbers', highlight: 'cssHighlight'},
        {editor: document.getElementById('jsEditor'), lineNumbers: 'jsLineNumbers', highlight: 'jsHighlight'}
      ];

      editors.forEach(({editor, lineNumbers, highlight}) => {
        if (editor) {
          const lineNumbersElement = document.getElementById(lineNumbers);
          const highlightElement = document.getElementById(highlight);

          // Guardar estado inicial
          setTimeout(() => saveState(), 100);

          editor.addEventListener('input', () => {
            updateLineNumbers(editor, lineNumbersElement);
            if (highlightElement) {
              updateSyntaxHighlight(editor, highlightElement, editor.id.includes('html') ? 'html' : editor.id.includes('css') ? 'css' : 'js');
            }
            
            // Guardar estado despu茅s de cambios (con debounce)
            clearTimeout(editor.saveStateTimeout);
            editor.saveStateTimeout = setTimeout(() => {
              saveState();
            }, 1000);
          });

          editor.addEventListener('scroll', () => {
            if (lineNumbersElement) lineNumbersElement.scrollTop = editor.scrollTop;
            if (highlightElement) highlightElement.scrollTop = editor.scrollTop;
          });

          editor.addEventListener('keydown', (e) => {
            const newTypeSound = typeSound.cloneNode();
            newTypeSound.volume = 0.3;
            newTypeSound.play().catch(e => console.log('Error playing sound:', e));
            
            // Atajos de teclado
            if (e.ctrlKey || e.metaKey) {
              switch(e.key.toLowerCase()) {
                case 'z':
                  if (e.shiftKey) {
                    e.preventDefault();
                    redoChanges();
                  } else {
                    e.preventDefault();
                    undoChanges();
                  }
                  break;
                case 'y':
                  e.preventDefault();
                  redoChanges();
                  break;
                case 'f':
                  e.preventDefault();
                  findAndReplace();
                  break;
                case 's':
                  e.preventDefault();
                  if (currentProjectId) {
                    saveProject();
                  } else {
                    showNotification('Proyecto guardado autom谩ticamente', 'info');
                  }
                  break;
              }
            }
            
            // Auto-completar brackets
            const cursor = editor.selectionStart;
            const value = editor.value;
            
            switch(e.key) {
              case '(':
                e.preventDefault();
                editor.value = value.slice(0, cursor) + '()' + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
              case '[':
                e.preventDefault();
                editor.value = value.slice(0, cursor) + '[]' + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
              case '{':
                e.preventDefault();
                editor.value = value.slice(0, cursor) + '{}' + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
              case '"':
                e.preventDefault();
                editor.value = value.slice(0, cursor) + '""' + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
              case "'":
                e.preventDefault();
                editor.value = value.slice(0, cursor) + "''" + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
            }
          });

          // Inicializar n煤meros de l铆nea
          updateLineNumbers(editor, lineNumbersElement);
        }
      });

      // Inicializar selector de idiomas del chat
      function initChatLanguageSelector() {
        const chatLanguageBtn = document.getElementById('chatLanguageBtn');
        const chatLanguageDropdown = document.getElementById('chatLanguageDropdown');
        const currentChatLangSpan = document.getElementById('currentChatLang');
        
        if (chatLanguageBtn && chatLanguageDropdown) {
          // Mostrar/ocultar dropdown
          chatLanguageBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            chatLanguageDropdown.classList.toggle('show');
          });
          
          // Cerrar dropdown al hacer clic fuera
          document.addEventListener('click', () => {
            chatLanguageDropdown.classList.remove('show');
          });
          
          // Manejar selecci贸n de idioma
          chatLanguageDropdown.addEventListener('click', async (e) => {
            const option = e.target.closest('.chat-lang-option');
            if (option) {
              const selectedLang = option.dataset.lang;
              currentChatLang = selectedLang;
              
              // Actualizar UI
              currentChatLangSpan.textContent = selectedLang.toUpperCase();
              
              // Marcar opci贸n seleccionada
              document.querySelectorAll('.chat-lang-option').forEach(opt => {
                opt.classList.remove('selected');
              });
              option.classList.add('selected');
              
              chatLanguageDropdown.classList.remove('show');
              
              // Mostrar notificaci贸n de cambio de idioma
              const notification = document.createElement('div');
              notification.style.cssText = `
                position: fixed;
                bottom: 100px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--primary-color);
                color: white;
                padding: 10px 20px;
                border-radius: 20px;
                z-index: 10000;
                font-size: 14px;
                animation: slideUp 0.3s ease;
              `;
              notification.innerHTML = `
                ${chatLanguages[selectedLang].flag} Idioma cambiado a ${chatLanguages[selectedLang].name}
              `;
              document.body.appendChild(notification);
              
              setTimeout(() => {
                notification.remove();
              }, 3000);
              
              // Traducir mensaje de bienvenida si es necesario
              if (selectedLang !== 'es') {
                const welcomeMessage = document.querySelector('.message.bot .message-content');
                if (welcomeMessage) {
                  const originalText = `隆Hola!  Soy tu asistente virtual de Clack. Puedo ayudarte con:

  Funciones del editor de c贸digo
  Personalizaci贸n y temas
  Gesti贸n de proyectos
  Vista previa y deployment
 ★ An谩lisis de seguridad

驴En qu茅 puedo ayudarte hoy?`;
                  
                  try {
                    const translatedText = await translateText(originalText, selectedLang);
                    welcomeMessage.innerHTML = `
                      ${translatedText}
                      <div class="message-time">${getCurrentTime()}</div>
                    `;
                  } catch (error) {
                    console.error('Error traduciendo mensaje de bienvenida:', error);
                  }
                }
              }
            }
          });
          
          // Inicializar idioma por defecto
          currentChatLangSpan.textContent = currentChatLang.toUpperCase();
          document.querySelector(`[data-lang="${currentChatLang}"]`)?.classList.add('selected');
        }
      }
      
      // Funci贸n para abrir generador de APK
      function openAPKGenerator() {
        document.getElementById('apkGeneratorModal').style.display = 'block';
      }

      // Agregar evento para cerrar generador de APK
      document.getElementById('closeAPKGenerator').addEventListener('click', () => {
        document.getElementById('apkGeneratorModal').style.display = 'none';
      });

      // Configurar botones de vista previa y esc谩ner en proyectos
      const previewBtnProject = document.getElementById('previewBtnProject');
      const scanBtnProject = document.getElementById('scanBtnProject');

      if (previewBtnProject) {
        previewBtnProject.addEventListener('click', () => {
          executeSound.play();
          document.getElementById('previewOverlay').style.display = 'block';
          showPreviewSkeleton();
          runScanAnimation();
          setTimeout(() => {
            hidePreviewSkeleton();
            const htmlCode = document.getElementById('htmlEditor').value;
            const cssCode = document.getElementById('cssEditor').value;
            const jsCode = document.getElementById('jsEditor').value;
            
            const combinedCode = `
              <!DOCTYPE html>
              <html>
                <head>
                  <meta charset="UTF-8">
                  <style>${cssCode}</style>
                </head>
                <body>
                  ${htmlCode}
                  <script>${jsCode}<\/script>
                </body>
              </html>
            `;
            previewFrame.srcdoc = combinedCode;
          }, 3000);
        });
      }

      if (scanBtnProject) {
        scanBtnProject.addEventListener('click', () => {
          const scanAnimation = document.getElementById('scanAnimation');
          const scanResults = scanAnimation.querySelector('.scan-results');
          scanAnimation.style.display = 'block';

          // Create particles container
          const particles = document.createElement('div');
          particles.className = 'particles';
          scanAnimation.appendChild(particles);

          // Generate particles
          function createParticle(x, y) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.width = Math.random() * 4 + 2 + 'px';
            particle.style.height = particle.style.width;
            particles.appendChild(particle);

            setTimeout(() => particle.remove(), 2000);
          }

          // Analyze code sections from project editors
          const codeElements = [
            { elem: document.getElementById('htmlEditor'), type: 'HTML' },
            { elem: document.getElementById('cssEditor'), type: 'CSS' },
            { elem: document.getElementById('jsEditor'), type: 'JavaScript' }
          ];

          let currentElement = 0;
          let totalIssues = 0;
          let progress = 0;

          scanResults.style.display = 'block';
          scanResults.innerHTML = `
            <h3>An谩lisis de Seguridad en Tiempo Real</h3>
            <p>Iniciando escaneo...</p>
            <div class="progress"></div>
          `;

          const analyzeInterval = setInterval(() => {
            if (currentElement < codeElements.length) {
              const { elem, type } = codeElements[currentElement];
              const code = elem.value;

              // Create floating particles
              for (let i = 0; i < 3; i++) {
                createParticle(
                  Math.random() * scanAnimation.offsetWidth,
                  Math.random() * scanAnimation.offsetHeight
                );
              }

              // Simulate code analysis
              let issues = [];
              if (type === 'HTML') {
                if (code.includes('<script>')) issues.push('Script inline detectado');
                if (!code.includes('<!DOCTYPE html>')) issues.push('Falta DOCTYPE');
              } else if (type === 'CSS') {
                if (code.includes('!important')) issues.push('Uso de !important');
              } else if (type === 'JavaScript') {
                if (code.includes('eval(')) issues.push('Uso de eval()');
              }

              totalIssues += issues.length;
              progress = Math.min(100, ((currentElement + 1) / codeElements.length) * 100);

              scanResults.innerHTML = `
                <h3>An谩lisis de Seguridad en Tiempo Real</h3>
                <p>Analizando ${type}...</p>
                <div class="progress">Progreso: ${Math.floor(progress)}%</div>
                <div class="issues">Problemas encontrados: ${totalIssues}</div>
                ${issues.length ? '<ul>' + issues.map(i => `<li>${i}</li>`).join('') + '</ul>' : ''}
              `;

              currentElement++;
            } else {
              clearInterval(analyzeInterval);

              scanResults.innerHTML = `
                <h3>An谩lisis Completado </h3>
                <p>${totalIssues > 0 ? `Se encontraron ${totalIssues} problemas` : 'No se encontraron amenazas'}</p>
                <p>Archivos analizados: ${codeElements.length}</p>
                <p>Seguridad general: ${totalIssues === 0 ? '100%' : Math.max(0, 100 - totalIssues * 10) + '%'}</p>
              `;

              setTimeout(() => {
                particles.remove();
                scanAnimation.style.display = 'none';
                scanResults.style.display = 'none';
              }, 3000);
            }
          }, 1000);
        });
      }
      // Funci贸n de tema movida a ajustes
      initPreviewTools();
      previewBtn.addEventListener('click', () => {
        executeSound.play();
        document.getElementById('previewOverlay').style.display = 'block';
        showPreviewSkeleton();
        runScanAnimation();
        setTimeout(() => {
          hidePreviewSkeleton();
          const htmlCode = document.getElementById('htmlEditorMain').value;
          const cssCode = document.getElementById('cssEditorMain').value;
          const jsCode = document.getElementById('jsEditorMain').value;
          
          const combinedCode = `
            <!DOCTYPE html>
            <html>
              <head>
                <meta charset="UTF-8">
                <style>${cssCode}</style>
              </head>
              <body>
                ${htmlCode}
                <script>${jsCode}<\/script>
              </body>
            </html>
          `;
          previewFrame.srcdoc = combinedCode;
        }, 3000);
      });
      closePreview.addEventListener('click', () => {
        document.getElementById('previewOverlay').style.display = 'none';
      });
      settingsBtn.addEventListener('click', () => {
        const overlay = document.getElementById('settingsOverlay');
        overlay.style.display = 'block';
        overlay.classList.add('show');
        updateCurrentLanguageDisplay();
      });
      
      // Cerrar ajustes
      document.getElementById('closeSettings').addEventListener('click', () => {
        const overlay = document.getElementById('settingsOverlay');
        overlay.style.display = 'none';
        overlay.classList.remove('show');
      });
      
      // Abrir submenu de idiomas
      document.getElementById('languageSettingsItem').addEventListener('click', () => {
        document.getElementById('languageSubmenu').classList.add('show');
        updateLanguageSelection();
      });
      
      // Volver a ajustes desde idiomas
      document.getElementById('backToSettings').addEventListener('click', () => {
        document.getElementById('languageSubmenu').classList.remove('show');
      });
      
      // Manejar selecci贸n de idioma
      document.querySelectorAll('.language-option').forEach(option => {
        option.addEventListener('click', (e) => {
          const lang = e.currentTarget.getAttribute('data-lang');
          updateLanguage(lang);
          updateLanguageSelection();
          updateCurrentLanguageDisplay();
          
          // Volver a ajustes despu茅s de 500ms
          setTimeout(() => {
            document.getElementById('languageSubmenu').classList.remove('show');
          }, 500);
        });
      });
      
      // Manejar cambio de tema desde ajustes
      document.getElementById('themeSettingsItem').addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        updateThemeDisplay();
      });
      
      // Abrir bot de ayuda (DESBLOQUEADO - FUNCIONAL)
      document.getElementById('helpBotItem').addEventListener('click', () => {
        const overlay = document.getElementById('helpBotOverlay');
        overlay.style.display = 'flex';
        overlay.classList.add('show');
        
        // Inicializar chat si no est谩 inicializado
        if (!window.chatInitialized) {
          initHelpBot();
          initChatLanguageSelector();
          window.chatInitialized = true;
        }
        
        // Mostrar notificaci贸n de activaci贸n
        showNotification(' Asistente virtual activado - 隆Preg煤ntame lo que necesites!', 'success');
      });
      
      // Abrir secci贸n de ayuda
      document.getElementById('helpSectionItem').addEventListener('click', () => {
        document.getElementById('helpSection').classList.add('show');
      });
      
      // Volver a ajustes desde ayuda
      document.getElementById('backToSettingsFromHelp').addEventListener('click', () => {
        document.getElementById('helpSection').classList.remove('show');
      });
      
      // Abrir modal de reporte de problemas
      document.getElementById('reportProblemOption').addEventListener('click', () => {
        document.getElementById('helpSection').classList.remove('show');
        document.getElementById('settingsOverlay').style.display = 'none';
        document.getElementById('reportProblemModal').style.display = 'block';
        resetReportForm();
      });
      
      // Cerrar modal de reporte
      document.getElementById('closeReportProblemModal').addEventListener('click', () => {
        document.getElementById('reportProblemModal').style.display = 'none';
      });
      
      // Navegaci贸n entre pasos del reporte
      document.getElementById('nextToImages').addEventListener('click', () => {
        showReportStep(2);
      });
      
      document.getElementById('backToDescription').addEventListener('click', () => {
        showReportStep(1);
      });
      
      document.getElementById('nextToReview').addEventListener('click', () => {
        updateReviewSection();
        showReportStep(3);
      });
      
      document.getElementById('backToImages').addEventListener('click', () => {
        showReportStep(2);
      });
      
      // Enviar reporte
      document.getElementById('submitProblemReport').addEventListener('click', () => {
        submitProblemReport();
      });
      
      // Cerrar overlay de reporte enviado
      document.getElementById('closeReportSent').addEventListener('click', () => {
        document.getElementById('reportSentOverlay').style.display = 'none';
        document.getElementById('reportProblemModal').style.display = 'none';
      });
      
      // Funcionalidad del textarea con contador
      document.getElementById('problemDescription').addEventListener('input', function() {
        const text = this.value;
        const count = text.length;
        document.getElementById('characterCount').textContent = count;
        
        const nextBtn = document.getElementById('nextToImages');
        const problemType = document.getElementById('problemType').value;
        
        if (count > 0 && count <= 200 && problemType) {
          nextBtn.style.opacity = '1';
          nextBtn.style.pointerEvents = 'auto';
          nextBtn.style.background = 'linear-gradient(45deg, #1d9bf0, #1a8cd8)';
        } else {
          nextBtn.style.opacity = '0.5';
          nextBtn.style.pointerEvents = 'none';
          nextBtn.style.background = '#71767b';
        }
        
        // Cambiar color del borde seg煤n el l铆mite
        if (count > 200) {
          this.style.borderColor = '#dc3545';
        } else if (count > 0) {
          this.style.borderColor = '#1d9bf0';
        } else {
          this.style.borderColor = '#2f3336';
        }
      });
      
      // Validaci贸n del tipo de problema
      document.getElementById('problemType').addEventListener('change', function() {
        const description = document.getElementById('problemDescription').value;
        const nextBtn = document.getElementById('nextToImages');
        
        if (description.length > 0 && description.length <= 200 && this.value) {
          nextBtn.style.opacity = '1';
          nextBtn.style.pointerEvents = 'auto';
          nextBtn.style.background = 'linear-gradient(45deg, #1d9bf0, #1a8cd8)';
        } else {
          nextBtn.style.opacity = '0.5';
          nextBtn.style.pointerEvents = 'none';
          nextBtn.style.background = '#71767b';
        }
      });
      
      // Funcionalidad de subida de im谩genes
      const imageInput = document.getElementById('imageInput');
      const imagePreviewContainer = document.getElementById('imagePreviewContainer');
      let uploadedImages = [];
      
      imageInput.addEventListener('change', function(e) {
        const files = Array.from(e.target.files);
        
        files.forEach(file => {
          if (uploadedImages.length >= 3) {
            showNotification('M谩ximo 3 im谩genes permitidas', 'warning');
            return;
          }
          
          if (file.size > 5 * 1024 * 1024) {
            showNotification('Imagen muy grande. M谩ximo 5MB', 'error');
            return;
          }
          
          if (!file.type.startsWith('image/')) {
            showNotification('Solo se permiten im谩genes', 'error');
            return;
          }
          
          const reader = new FileReader();
          reader.onload = function(e) {
            const imageData = {
              file: file,
              data: e.target.result,
              id: Date.now() + Math.random()
            };
            
            uploadedImages.push(imageData);
            renderImagePreview();
          };
          reader.readAsDataURL(file);
        });
        
        // Limpiar input
        this.value = '';
      });
      
      // Drag and drop para im谩genes
      const uploadArea = document.getElementById('imageUploadArea');
      
      uploadArea.addEventListener('dragover', function(e) {
        e.preventDefault();
        this.style.borderColor = '#1d9bf0';
        this.style.background = 'rgba(29, 155, 240, 0.1)';
      });
      
      uploadArea.addEventListener('dragleave', function(e) {
        e.preventDefault();
        this.style.borderColor = '#2f3336';
        this.style.background = '#16181c';
      });
      
      uploadArea.addEventListener('drop', function(e) {
        e.preventDefault();
        this.style.borderColor = '#2f3336';
        this.style.background = '#16181c';
        
        const files = Array.from(e.dataTransfer.files);
        const event = { target: { files: files } };
        imageInput.dispatchEvent(new Event('change'));
        
        // Simular files en input
        const dt = new DataTransfer();
        files.forEach(file => dt.items.add(file));
        imageInput.files = dt.files;
        imageInput.dispatchEvent(new Event('change'));
      });
      
      // Cerrar bot de ayuda
      document.getElementById('closeHelpBot').addEventListener('click', () => {
        document.getElementById('helpBotOverlay').classList.remove('show');
      });
      
      
      
      
      
      // Funci贸n para actualizar la visualizaci贸n del idioma actual
      function updateCurrentLanguageDisplay() {
        const languageNames = {
          'es': 'Espa帽ol',
          'en': 'English', 
          'ja': 'ユ瑾',
          'ko': '甑',
          'vi': 'Ti岷ng Vi峄t',
          'zh': '涓'
        };
        document.getElementById('currentLanguageText').textContent = languageNames[currentLang] || 'Espa帽ol';
      }
      
      // Funci贸n para actualizar la selecci贸n visual en el submenu de idiomas
      function updateLanguageSelection() {
        document.querySelectorAll('.language-option').forEach(option => {
          const check = option.querySelector('.check');
          if (option.getAttribute('data-lang') === currentLang) {
            option.classList.add('selected');
            check.style.display = 'block';
          } else {
            option.classList.remove('selected');
            check.style.display = 'none';
          }
        });
      }
      
      // Funci贸n para actualizar la visualizaci贸n del tema
      function updateThemeDisplay() {
        const isDark = document.body.classList.contains('dark-mode');
        document.getElementById('currentThemeText').textContent = isDark ? 'Oscuro' : 'Claro';
        document.getElementById('themeIcon').className = isDark ? 'fas fa-sun' : 'fas fa-moon';
      }
      
      // Bot de Ayuda - Base de conocimientos
      const botKnowledge = {
        'crear proyecto': 'Para crear un nuevo proyecto: 1锔 Ve a la secci贸n "Proyectos", 2锔 Haz clic en "Nuevo Proyecto", 3锔 Escribe el nombre y 隆listo! ',
        'cambiar tema': 'Para cambiar el tema: 1锔 Abre Ajustes 锔, 2锔 Selecciona "Tema", 3锔 El tema cambiar谩 autom谩ticamente entre claro y oscuro. 锔',
        'esc谩ner': 'El esc谩ner de seguridad ★ analiza tu c贸digo buscando vulnerabilidades. Solo haz clic en el bot贸n "Escanear" en la vista previa.',
        'exportar': 'Para exportar: 1锔 Abre tu proyecto, 2锔 Haz clic en "Exportar" , 3锔 Se descargar谩 un archivo JSON con tu c贸digo.',
        'atajos': 'Atajos 煤tiles: Ctrl+S (guardar), Ctrl+Z (deshacer), Ctrl+Y (rehacer), Ctrl+F (buscar y reemplazar). 锔',
        'vista previa': 'La vista previa 锔 muestra c贸mo se ve tu c贸digo en tiempo real. Incluye zoom y an谩lisis de seguridad.',
        'proyectos': 'En la secci贸n Proyectos puedes crear, editar, duplicar y exportar tus c贸digos. Todo se guarda autom谩ticamente. ',
        'idioma': 'Puedes cambiar el idioma en Ajustes > Idioma. Soportamos Espa帽ol, Ingl茅s, Japon茅s, Coreano, Vietnamita y Chino. '
      };
      
      function initHelpBot() {
        // Establecer tiempo de bienvenida
        document.getElementById('welcomeTime').textContent = getCurrentTime();
        
        // Configurar 谩rea de chat
        const chatInput = document.getElementById('chatInput');
        const sendButton = document.getElementById('sendButton');
        
        // Auto-resize del textarea
        chatInput.addEventListener('input', () => {
          chatInput.style.height = 'auto';
          chatInput.style.height = (chatInput.scrollHeight) + 'px';
          
          // Habilitar/deshabilitar bot贸n de env铆o
          sendButton.disabled = chatInput.value.trim() === '';
        });
        
        // Enviar mensaje
        const sendMessage = () => {
          const message = chatInput.value.trim();
          if (message) {
            addUserMessage(message);
            chatInput.value = '';
            chatInput.style.height = 'auto';
            sendButton.disabled = true;
            
            // Simular respuesta del bot
            setTimeout(() => {
              showTypingIndicator();
              setTimeout(() => {
                hideTypingIndicator();
                addBotMessage(getBotResponse(message));
              }, 1500);
            }, 500);
          }
        };
        
        sendButton.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendMessage();
          }
        });
      }
      
      function getCurrentTime() {
        return new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      }
      
      function addUserMessage(message) {
        const chatMessages = document.getElementById('chatMessages');
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message user';
        messageDiv.innerHTML = `
          <div class="message-content">
            ${message}
            <div class="message-time">${getCurrentTime()}</div>
          </div>
        `;
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
      
      async function addBotMessage(message) {
        const chatMessages = document.getElementById('chatMessages');
        
        console.log(`Idioma actual del chat: ${currentChatLang}`);
        console.log(`Mensaje original: ${message}`);
        
        // Si no es espa帽ol, mostrar skeleton y traducir
        if (currentChatLang !== 'es') {
          // Mostrar skeleton mientras se traduce
          const skeletonDiv = document.createElement('div');
          skeletonDiv.className = 'message bot';
          skeletonDiv.innerHTML = `
            <div class="message-skeleton">
              <div class="skeleton-line"></div>
              <div class="skeleton-line"></div>
              <div class="skeleton-line"></div>
              <div class="translating-indicator">
                <i class="fas fa-language"></i>
                <span>Traduciendo a ${chatLanguages[currentChatLang] ? chatLanguages[currentChatLang].name : currentChatLang}...</span>
                <div class="translating-dots">
                  <div class="translating-dot"></div>
                  <div class="translating-dot"></div>
                  <div class="translating-dot"></div>
                </div>
              </div>
            </div>
          `;
          chatMessages.appendChild(skeletonDiv);
          chatMessages.scrollTop = chatMessages.scrollHeight;
          
          try {
            console.log('Iniciando traducci贸n...');
            
            // Simular delay m铆nimo para mostrar la animaci贸n
            await new Promise(resolve => setTimeout(resolve, 800));
            
            // Traducir el mensaje
            const translatedMessage = await translateText(message, currentChatLang);
            console.log(`Mensaje traducido: ${translatedMessage}`);
            
            // Remover skeleton y mostrar mensaje traducido
            skeletonDiv.remove();
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.innerHTML = `
              <div class="message-content">
                ${translatedMessage}
                <div class="message-time">${getCurrentTime()}</div>
              </div>
            `;
            chatMessages.appendChild(messageDiv);
            
            // Mostrar notificaci贸n de 茅xito
            if (translatedMessage !== message) {
              console.log(' Traducci贸n exitosa');
            }
            
          } catch (error) {
            console.error('Error en traducci贸n:', error);
            // Si falla la traducci贸n, mostrar mensaje original
            skeletonDiv.remove();
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.innerHTML = `
              <div class="message-content">
                ${message}
                <div class="message-time">${getCurrentTime()}</div>
                <small style="color: #999; font-style: italic; display: block; margin-top: 5px;">
                   Mensaje en espa帽ol (Error de traducci贸n)
                </small>
              </div>
            `;
            chatMessages.appendChild(messageDiv);
          }
        } else {
          // Mostrar directamente en espa帽ol
          const messageDiv = document.createElement('div');
          messageDiv.className = 'message bot';
          messageDiv.innerHTML = `
            <div class="message-content">
              ${message}
              <div class="message-time">${getCurrentTime()}</div>
            </div>
          `;
          chatMessages.appendChild(messageDiv);
        }
        
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
      
      function showTypingIndicator() {
        const chatMessages = document.getElementById('chatMessages');
        const typingDiv = document.createElement('div');
        typingDiv.id = 'typingIndicator';
        typingDiv.className = 'message bot';
        typingDiv.innerHTML = `
          <div class="typing-indicator">
            <div class="typing-dots">
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
            </div>
            <span style="margin-left: 8px; color: #666; font-size: 12px;">Escribiendo...</span>
          </div>
        `;
        chatMessages.appendChild(typingDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
      
      function hideTypingIndicator() {
        const typingIndicator = document.getElementById('typingIndicator');
        if (typingIndicator) {
          typingIndicator.remove();
        }
      }
      
      // Sistema de traducci贸n mejorado usando Google Translate API gratuita
      async function translateText(text, targetLang) {
        // Si el idioma objetivo es espa帽ol, no traducir
        if (targetLang === 'es') {
          return text;
        }
        
        try {
          console.log(`Traduciendo: "${text}" a idioma: ${targetLang}`);
          
          // Usar Google Translate API gratuita
          const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=es&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`;
          
          const response = await fetch(url);
          
          if (!response.ok) {
            throw new Error(`Error HTTP: ${response.status}`);
          }
          
          const result = await response.json();
          console.log('Resultado de traducci贸n:', result);
          
          // Extraer texto traducido
          if (result && result[0] && Array.isArray(result[0])) {
            let translatedText = '';
            result[0].forEach(item => {
              if (item && item[0]) {
                translatedText += item[0];
              }
            });
            
            if (translatedText) {
              console.log(`Texto traducido: "${translatedText}"`);
              return translatedText;
            }
          }
          
          // Si no se pudo traducir, usar traducciones predefinidas
          return getPredefnedTranslation(text, targetLang);
          
        } catch (error) {
          console.error('Error de traducci贸n:', error);
          // Fallback a traducciones predefinidas
          return getPredefnedTranslation(text, targetLang);
        }
      }
      
      // Traducciones predefinidas para mensajes comunes
      function getPredefnedTranslation(text, targetLang) {
        const translations = {
          en: {
            'crear proyecto': 'create project',
            'cambiar tema': 'change theme',
            'esc谩ner': 'scanner',
            'exportar': 'export',
            'atajos': 'shortcuts',
            'vista previa': 'preview',
            'proyectos': 'projects',
            'idioma': 'language',
            '隆Hola!  Soy tu asistente virtual de Clack.': 'Hello!  I am your Clack virtual assistant.',
            'Puedo ayudarte con:': 'I can help you with:',
            '  Funciones del editor de c贸digo': '  Code editor functions',
            '  Personalizaci贸n y temas': '  Customization and themes',
            '  Gesti贸n de proyectos': '  Project management',
            '  Vista previa y deployment': '  Preview and deployment',
            ' ★ An谩lisis de seguridad': ' ★ Security analysis',
            '驴En qu茅 puedo ayudarte hoy?': 'How can I help you today?'
          },
          pt: {
            'crear proyecto': 'criar projeto',
            'cambiar tema': 'mudar tema',
            'esc谩ner': 'scanner',
            'exportar': 'exportar',
            'atajos': 'atalhos',
            'vista previa': 'visualiza莽茫o',
            'proyectos': 'projetos',
            'idioma': 'idioma',
            '隆Hola!  Soy tu asistente virtual de Clack.': 'Ol谩!  Eu sou seu assistente virtual do Clack.',
            'Puedo ayudarte con:': 'Posso ajud谩-lo com:',
            '  Funciones del editor de c贸digo': '  Fun莽玫es do editor de c贸digo',
            '  Personalizaci贸n y temas': '  Personaliza莽茫o e temas',
            '  Gesti贸n de proyectos': '  Gest茫o de projetos',
            '  Vista previa y deployment': '  Visualiza莽茫o e implementa莽茫o',
            ' ★ An谩lisis de seguridad': ' ★ An谩lise de seguran莽a',
            '驴En qu茅 puedo ayudarte hoy?': 'Como posso ajud谩-lo hoje?'
          },
          ko: {
            'crear proyecto': '搿 ',
            'cambiar tema': '毵 氤瓴',
            'esc谩ner': 'れ',
            'exportar': '措炒搓赴',
            'atajos': '於',
            'vista previa': '氙鸽Μ氤搓赴',
            'proyectos': '搿',
            'idioma': '胳',
            '隆Hola!  Soy tu asistente virtual de Clack.': '胳!   Clack 臧 挫ろ错胳.',
            'Puedo ayudarte con:': 'れ 茧  毽  惦:',
            '  Funciones del editor de c贸digo': '  旖 胳旮 旮半',
            '  Personalizaci贸n y temas': '  ╈  氚 毵',
            '  Gesti贸n de proyectos': '  搿 甏毽',
            '  Vista previa y deployment': '  氙鸽Μ氤搓赴 氚 氚绊',
            ' ★ An谩lisis de seguridad': ' ★ 氤挫 攵',
            '驴En qu茅 puedo ayudarte hoy?': 'る 措魂 毽搓?'
          },
          vi: {
            'crear proyecto': 't岷o d峄 谩n',
            'cambiar tema': 'thay 峄i ch峄 峄',
            'esc谩ner': 'm谩y qu茅t',
            'exportar': 'xu岷t',
            'atajos': 'ph铆m t岷t',
            'vista previa': 'xem tr瓢峄c',
            'proyectos': 'd峄 谩n',
            'idioma': 'ng么n ng峄',
            '隆Hola!  Soy tu asistente virtual de Clack.': 'Xin cho!  T么i l tr峄 l媒 岷o Clack c峄a b岷n.',
            'Puedo ayudarte con:': 'T么i c贸 th峄 gi煤p b岷n v峄i:',
            '  Funciones del editor de c贸digo': '  C谩c ch峄c nng c峄a tr矛nh so岷n th岷o m茫',
            '  Personalizaci贸n y temas': '  T霉y ch峄nh v ch峄 峄',
            '  Gesti贸n de proyectos': '  Qu岷n l媒 d峄 谩n',
            '  Vista previa y deployment': '  Xem tr瓢峄c v tri峄n khai',
            ' ★ An谩lisis de seguridad': ' ★ Ph芒n t铆ch b岷o m岷t',
            '驴En qu茅 puedo ayudarte hoy?': 'H么m nay t么i c贸 th峄 gi煤p b岷n i峄u g矛?'
          }
        };
        
        const langTranslations = translations[targetLang];
        if (langTranslations) {
          // Buscar traducci贸n exacta
          if (langTranslations[text]) {
            return langTranslations[text];
          }
          
          // Buscar traducciones parciales
          for (const [original, translated] of Object.entries(langTranslations)) {
            if (text.includes(original)) {
              return text.replace(original, translated);
            }
          }
        }
        
        // Si no hay traducci贸n disponible, retornar texto original
        return text;
      }
      
      function getBotResponse(userMessage) {
        const message = userMessage.toLowerCase();
        
        // Buscar en la base de conocimientos
        for (const [keyword, response] of Object.entries(botKnowledge)) {
          if (message.includes(keyword)) {
            return response;
          }
        }
        
        // Respuestas contextuales
        if (message.includes('hola') || message.includes('hi')) {
          return '隆Hola!  驴En qu茅 puedo ayudarte con Clack hoy?';
        }
        
        if (message.includes('gracias') || message.includes('thank')) {
          return '隆De nada!  Estoy aqu铆 para ayudarte cuando lo necesites.';
        }
        
        if (message.includes('error') || message.includes('problema')) {
          return '驴Puedes contarme m谩s sobre el error?  Puedo ayudarte a identificar problemas comunes en el c贸digo o con las funciones de la app.';
        }
        
        if (message.includes('c贸digo') || message.includes('programar')) {
          return '隆Excelente!  Clack tiene editores para HTML, CSS y JavaScript con resaltado de sintaxis, numeraci贸n de l铆neas y validaci贸n autom谩tica. 驴Necesitas ayuda con algo espec铆fico?';
        }
        
        // Respuesta por defecto
        return ` Hmm, no estoy seguro de c贸mo ayudarte con eso espec铆ficamente. Pero puedo asistirte con:
        
         Crear y gestionar proyectos
         Usar las herramientas del editor
         Configurar ajustes y temas
         Vista previa y an谩lisis de c贸digo
        
        驴Hay algo espec铆fico que te gustar铆a saber?`;
      }
      
      async function askQuickQuestion(question) {
        // Mostrar indicador de carga si es necesario traducir
        if (currentChatLang !== 'es') {
          const chatInput = document.getElementById('chatInput');
          chatInput.value = ' Traduciendo pregunta...';
          chatInput.disabled = true;
          
          try {
            const translatedQuestion = await translateText(question, currentChatLang);
            chatInput.value = translatedQuestion;
            chatInput.disabled = false;
            document.getElementById('sendButton').disabled = false;
            console.log(`Pregunta traducida: ${question} -> ${translatedQuestion}`);
          } catch (error) {
            console.error('Error traduciendo pregunta r谩pida:', error);
            chatInput.value = question; // Usar pregunta original si falla la traducci贸n
            chatInput.disabled = false;
            document.getElementById('sendButton').disabled = false;
          }
        } else {
          document.getElementById('chatInput').value = question;
          document.getElementById('sendButton').disabled = false;
        }
      }
      
      // B煤squeda en ajustes
      document.getElementById('settingsSearch').addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        const items = document.querySelectorAll('.settings-item');
        
        items.forEach(item => {
          const title = item.querySelector('.settings-item-title')?.textContent.toLowerCase() || '';
          const subtitle = item.querySelector('.settings-item-subtitle')?.textContent.toLowerCase() || '';
          
          if (title.includes(searchTerm) || subtitle.includes(searchTerm)) {
            item.style.display = 'flex';
          } else {
            item.style.display = 'none';
          }
        });
      });
      document.getElementById('changeLangBtn').addEventListener('click', () => {
        document.getElementById('settingsOverlay').style.display = 'block';
      });
      
      document.getElementById("githubLoginBtn").addEventListener("click", loginSimulated);

      searchBtn.addEventListener('click', () => { 
        showSearchSkeleton();
        setTimeout(() => {
          hideSearchSkeleton();
        }, 1000);
        toggleSearchOverlay(true); 
      });
      closeSearchOverlay.addEventListener('click', () => { toggleSearchOverlay(false); });
      searchExecuteBtn.addEventListener('click', () => {
        showSearchSkeleton();
        setTimeout(() => {
          executeSearch();
          hideSearchSkeleton();
        }, 800);
      });

      // Mostrar/ocultar bot贸n de limpiar seg煤n el contenido del input
      const searchInput = document.getElementById('searchInput');
      const clearSearch = document.getElementById('clearSearch');

      searchInput.addEventListener('input', () => {
        clearSearch.style.display = searchInput.value ? 'block' : 'none';
      });

      clearSearch.addEventListener('click', () => {
        searchInput.value = '';
        clearSearch.style.display = 'none';
      });
      toggleArticles.addEventListener('click', () => {
        toggleArticles.classList.add('active');
        executeSearch();
      });
      // Event listeners para video solo si los elementos existen
      if (likeVideoBtn) {
        likeVideoBtn.addEventListener('click', () => {
          likeAnimation.style.opacity = "1";
          likeAnimation.style.animation = "likePop 0.8s forwards";
          setTimeout(() => {
            likeAnimation.style.opacity = "0";
            likeAnimation.style.animation = "none";
          }, 900);
        });
      }
      
      if (reportVideoBtn) {
        reportVideoBtn.addEventListener('click', openReportModal);
      }
      
      if (closeVideoBtn) {
        closeVideoBtn.addEventListener('click', () => { toggleVideoPlayerOverlay(false); });
      }
      
      if (submitReportBtn) {
        submitReportBtn.addEventListener('click', submitReport);
      }


    });
  </script>
</body>
</html>
